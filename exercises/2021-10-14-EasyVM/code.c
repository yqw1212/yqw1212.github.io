// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_80487AF@<eax>(int a1@<ebp>)
{
  int v1; // ebx

  *(_DWORD *)(a1 - 0x2C) = *(_DWORD *)(a1 + 8);
  *(_DWORD *)(a1 - 0xC) = __readgsdword(0x14u);
  while ( 1 )
  {
    if ( *a1[8] == 0x71 )
    {
      a1[6] -= 4;
      *a1[6] = *(a1[8] + 1);
      a1[8] += 5;
    }
    if ( *a1[8] == 0x41 )
    {
      a1[1] += a1[2];
      ++a1[8];
    }
    if ( *a1[8] == 0x42 )
    {
      a1[1] -= a1[4];
      ++a1[8];
    }
    if ( *a1[8] == 0x43 )
    {
      a1[1] *= a1[3];
      ++a1[8];
    }
    if ( *a1[8] == 0x37 )
    {
      a1[1] = a1[5];
      ++a1[8];
    }
    if ( *a1[8] == 0x38 )
    {
      a1[1] ^= a1[4];
      ++a1[8];
    }
    if ( *a1[8] == 0x39 )
    {
      a1[1] ^= a1[5];
      ++a1[8];
    }
    if ( *a1[8] == 0x35 )
    {
      a1[5] = a1[1];
      ++a1[8];
    }
    if ( *a1[8] == 0xF7 )
    {
      a1[9] += a1[1];
      ++a1[8];
    }
    if ( *a1[8] == 0x44 )
    {
      a1[1] /= a1[5];
      ++a1[8];
    }
    if ( *a1[8] == 0x80 )
    {
      a1[sub_804875F(a1, 1) = *(a1[8] + 2);
      a1[8] += 6;
    }
    if ( *a1[8] == 0x77 )
    {
      a1[1] ^= a1[9];
      ++a1[8];
    }
    if ( *a1[8] == 0x53 )
    {
      putchar(*a1[3]);
      a1[8] += 2;
    }
    if ( *a1[8] == 0x22 )
    {
      a1[1] >>= a1[2];
      ++a1[8];
    }
    if ( *a1[8] == 0x23 )
    {
      a1[1] <<= a1[2];
      ++a1[8];
    }
    if ( a1[8] == 0x99 )
      break;
    if ( a1[8] == 0x76 )
    {
      a1[3] = *a1[6];
      a1[6] = 0;
      a1[6] += 4;
      a1[8] += 5;
    }
    if ( *a1[8] == 0x54 )
    {
      v2 = a1[3];
      *v2 = getchar();
      a1[8] += 2;
    }
    if ( *a1[8] == 0x30 )
    {
      a1[1] |= a1[2];
      ++a1[8];
    }
    if ( *a1[8] == 0x31 )
    {
      a1[1] &= a1[2];
      ++a1[8];
    }
    if ( *a1[8] == 0x32 )
    {
      a1[3] = *(a1[8] + 1);
      a1[8] += 2;
    }
    if ( *a1[8] == 9 )
    {
      a1[1] = 0x6FEBF967;
      ++a1[8];
    }
    if ( *a1[8] == 0x10 )
    {
      a1[9] = a1[1];
      ++a1[8];
    }
    if ( *a1[8] == 0x33 )
    {
      a1[4] = a1[1];
      ++a1[8];
    }
    if ( *a1[8] == 0x34 )
    {
      a1[2] = *(a1[8] + 1);
      a1[8] += 2;
    }
    if ( *a1[8] == 0xFE )
    {
      a1[1] = a1[9];
      ++a1[8];
    }
    if ( *a1[8] == 0x11 )
    {
      printf("%x\n", a1[1]);
      ++a1[8];
    }
    if ( *a1[8] == 0xA0 )
    {
      if ( a1[1] != 0x6FEBF967 )
        exit(0);
      ++a1[8];
    }
    if ( *a1[8] == 0xA1 )
    {
      read(0, s, 0x2Cu);
      if ( strlen(s) != 0x2C )
        exit(0);
      ++a1[8];
    }
    if ( *a1[8] == 0xB1 )
    {
      a1[9] = dword_804B080[0];
      ++a1[8];
    }
    if ( *a1[8] == 0xB2 )
    {
      a1[9] = dword_804B084;
      ++a1[8];
    }
    if ( *a1[8] == 0xA4 )
    {
      dword_804B084[*(a1[8] + 1)] = a1[1];
      a1[8] += 4;
    }
    if ( *a1[8] == 0xB3 )
    {
      a1[9] = dword_804B088;
      ++a1[8];
    }
    if ( *a1[8] == 0xB4 )
    {
      a1[9] = dword_804B08C;
      ++a1[8];
    }
    if ( *a1[8] == 0xC1 )
    {
      a1[1] = s[*(a1[8] + 1)];
      a1[8] += 2;
    }
    if ( *a1[8] == 0xC7 )
    {
      if ( dword_804B060 != a1[1] )
        exit(0);
      ++a1[8];
    }
    if ( *a1[8] == 0xC8 )
    {
      if ( dword_804B064 != a1[1] )
        exit(0);
      ++a1[8];
    }
    if ( *a1[8] == 0xC2 )
    {
      if ( *(a1[8] + 1) != a1[1] )
        exit(0);
      a1[8] += 5;
    }
  }
  return __readgsdword(0x14u) ^ *(_DWORD *)(a1 - 0xC);
}