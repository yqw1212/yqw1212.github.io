---
layout: post
title:  uniapp
date:   2021-09-26 00:01:01 +0300
image:  2021-09-26-woman.jpg
tags:   [ctf,reverse,第五空间,chacha20,js,mobile]
---

jeb打开apk文件，查看MainActivity活动

```assembly
package uni.UNI14D1880;

import java.security.cert.CertificateException;
import java.security.cert.X509Certificate;
import javax.net.ssl.X509TrustManager;

public class CustomTrustMgr implements X509TrustManager {
    public CustomTrustMgr() {
        super();
    }

    public void checkClientTrusted(X509Certificate[] arg1, String arg2) throws CertificateException {
    }

    public void checkServerTrusted(X509Certificate[] arg1, String arg2) throws CertificateException {
    }

    public X509Certificate[] getAcceptedIssuers() {
        return new X509Certificate[0];
    }
}
```

Java并没有任何有用代码。结合题目信息，后端逻辑实现应该是用Javascript实现，解压apk文件。

findstr.exe /s /i "encrypt" \*.\*  

上面的命令表示，当前目录以及当前目录的所有子目录下的所有文件中查找"encrypt"这个字符串。

*.*表示所有类型的文件。

/s 表示当前目录以及所有子目录

/i 表示不区分大小写

```assembly
assets\apps\__UNI__14D1880\www\app-service.js:
(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([["app-service"],{"074d":function(t,e,n){"use strict";n.r(e);var r=n("600a");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);var i,a,s,u,c=n("f0c5"),f=Object(c["a"])(r["default"],i,a,!1,null,null,null,!1,s,u);e["default"]=f.exports},"0de9":function(t,e,n){"use strict";function r(t){var e=Object.prototype.toString.call(t);return e.substring(8,e.length-1)}function o(){return"string"===typeof __channelId__&&__channelId__}function i(t,e){switch(r(e)){case"Function":return"function() { [native code] }";default:return e}}function a(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];console[t].apply(console,n)}function s(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=e.shift();if(o())return e.push(e.pop().replace("at ","uni-app:///")),console[a].apply(console,e);var s=e.map((function(t){var e=Object.prototype.toString.call(t).toLowerCase();if("[object object]"===e||"[object array]"===e)try{t="---BEGIN:JSON---"+JSON.stringify(t,i)+"---END:JSON---"}catch(o){t=e}else if(null===t)t="---NULL---";else if(void 0===t)t="---UNDEFINED---";else{var n=r(t).toUpperCase();t="NUMBER"===n||"BOOLEAN"===n?"---BEGIN:"+n+"---"+t+"---END:"+n+"---":String(t)}return t})),u="";if(s.length>1){var c=s.pop();u=s.join("---COMMA---"),0===c.indexOf(" at ")?u+=c:u+="---COMMA---"+c}else u=s[0];console[a](u)}n.r(e),n.d(e,"log",(function(){return a})),n.d(e,"default",(function(){return s}))},"44be":function(t,e,n){"use strict";n.r(e);var r=n("63a7"),o=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},"600a":function(t,e,n){"use strict";n.r(e);var r=n("a820"),o=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},"63a7":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n("7420"));function o(t){return t&&t.__esModule?t:{default:t}}var i="",a="";for(var s in[22,10,3,7,21,3,70,15,8,22,19,18,70,31,9,19,20,70,0,10,7,1])i+=String.fromCharCode(102^[22,10,3,7,21,3,70,15,8,22,19,18,70,31,9,19,20,70,0,10,7,1][s]);for(var s in[5,14,3,5,13])a+=String.fromCharCode(102^[5,14,3,5,13][s]);var u={data:function(){return{title:i,ipt:a,input:""}},onLoad:function(){},methods:{chk:function(t){for(var e={alert:function(t){uni.showToast({title:t,duration:2e3})}},n=[],o=0;o<=31;o++)n[o]=o;var i=new Uint8Array(n),a=new Uint8Array([0,0,0,0,0,0,0,74,0,0,0,0]),s=1,u=[];for(var o in this["input"])u[o]=102^this["input"]["charCodeAt"](o);var c=new Uint8Array(u),f=new r.default(i,a,s),l=f["encrypt"](c),p=[34,69,86,242,93,72,134,226,42,138,112,56,189,53,77,178,223,76,78,221,63,40,86,231,121,29,154,189,204,243,205,44,141,100,13,164,35,123];if(p["length"]==l["length"])for(var h in l){if(p[h]!=l[h]){e["alert"]("Try again");break}37==h&&e["alert"]("correct")}else e["alert"]("Try again")}}};e.default=u},7420:function(t,e,n){"use strict";var r=function(t,e,n){if("undefined"===typeof n&&(n=0),!(t instanceof Uint8Array)||32!==t.length)throw new Error("Key should be 32 byte array!");if(!(e instanceof Uint8Array)||12!==e.length)throw new Error("Nonce should be 12 byte array!");this._rounds=20,this._sigma=[1634760805,857760878,2036477234,1797285236],this._param=[this._sigma[0],this._sigma[1],this._sigma[2],this._sigma[3],this._get32(t,0),this._get32(t,4),this._get32(t,8),this._get32(t,12),this._get32(t,16),this._get32(t,20),this._get32(t,24),this._get32(t,28),n,this._get32(e,0),this._get32(e,4),this._get32(e,8)],this._keystream=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._byteCounter=0};r.prototype._chacha=function(){var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0,n=0;for(e=0;e<16;e++)t[e]=this._param[e];for(e=0;e<this._rounds;e+=2)this._quarterround(t,0,4,8,12),this._quarterround(t,1,5,9,13),this._quarterround(t,2,6,10,14),this._quarterround(t,3,7,11,15),this._quarterround(t,0,5,10,15),this._quarterround(t,1,6,11,12),this._quarterround(t,2,7,8,13),this._quarterround(t,3,4,9,14);for(e=0;e<16;e++)t[e]+=this._param[e],this._keystream[n++]=255&t[e],this._keystream[n++]=t[e]>>>8&255,this._keystream[n++]=t[e]>>>16&255,this._keystream[n++]=t[e]>>>24&255},r.prototype._quarterround=function(t,e,n,r,o){t[o]=this._rotl(t[o]^(t[e]+=t[n]),16),t[n]=this._rotl(t[n]^(t[r]+=t[o]),12),t[o]=this._rotl(t[o]^(t[e]+=t[n]),8),t[n]=this._rotl(t[n]^(t[r]+=t[o]),7),t[e]>>>=0,t[n]>>>=0,t[r]>>>=0,t[o]>>>=0},r.prototype._get32=function(t,e){return t[e++]^t[e++]<<8^t[e++]<<16^t[e]<<24},r.prototype._rotl=function(t,e){return t<<e|t>>>32-e},r.prototype.encrypt=function(t){return this._update(t)},r.prototype.decrypt=function(t){return this._update(t)},r.prototype._update=function(t){if(!(t instanceof Uint8Array)||0===t.length)throw new Error("Data should be type of bytes (Uint8Array) and not empty!");for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)0!==this._byteCounter&&64!==this._byteCounter||(this._chacha(),this._param[12]++,this._byteCounter=0),e[n]=t[n]^this._keystream[this._byteCounter++];return e},t.exports&&(t.exports=r)},7724:function(t,e,n){"use strict";n("e587");var r=i(n("8bbf")),o=i(n("074d"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}r.default.config.productionTip=!1,o.default.mpType="app";var c=new r.default(s({},o.default));c.$mount()},"8bbf":function(t,e){t.exports=Vue},a820:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={onLaunch:function(){t("log","App Launch"," at App.vue:4")},onShow:function(){t("log","App Show"," at App.vue:7")},onHide:function(){t("log","App Hide"," at App.vue:10")}};e.default=n}).call(this,n("0de9")["default"])},b0c6:function(t,e,n){"use strict";n.r(e);var r=n("f2ea"),o=n("44be");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var a,s=n("f0c5"),u=Object(s["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);e["default"]=u.exports},e587:function(t,e,n){"undefined"===typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))}))}),uni.restoreGlobal&&uni.restoreGlobal(weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),__definePage("pages/index/index",(function(){return Vue.extend(n("b0c6").default)}))},f0c5:function(t,e,n){"use strict";function r(t,e,n,r,o,i,a,s,u,c){var f,l="function"===typeof t?t.options:t;if(u){l.components||(l.components={});var p=Object.prototype.hasOwnProperty;for(var h in u)p.call(u,h)&&!p.call(l.components,h)&&(l.components[h]=u[h])}if(c&&((c.beforeCreate||(c.beforeCreate=[])).unshift((function(){this[c.__module]=this})),(l.mixins||(l.mixins=[])).push(c)),e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),a?(f=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=f):o&&(f=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),f)if(l.functional){l._injectStyles=f;var d=l.render;l.render=function(t,e){return f.call(e),d(t,e)}}else{var _=l.beforeCreate;l.beforeCreate=_?[].concat(_,f):[f]}return{exports:t,options:l}}n.d(e,"a",(function(){return r}))},f2ea:function(t,e,n){"use strict";var r;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:t._$s(0,"sc","content"),attrs:{_i:0}},[n("view",{staticClass:t._$s(1,"sc","text-area"),attrs:{_i:1}},[n("text",{staticClass:t._$s(2,"sc","title"),attrs:{_i:2}},[t._v(t._$s(2,"t0-0",t._s(t.title)))])]),n("view",{staticClass:t._$s(3,"sc","text-box"),attrs:{_i:3}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:t._$s(4,"sc","uni-input"),attrs:{_i:4},domProps:{value:t._$s(4,"v-model",t.input)},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}})]),n("view",{staticClass:t._$s(5,"sc","uni-btn-v"),attrs:{_i:5}},[n("button",{attrs:{_i:6},on:{click:t.chk}},[t._v(t._$s(6CONFIG_TARGET CONFIG_TIMEOUT CONFIG_TITLE_N_VIEW CONFIG_UI_MODE CONFIG_UNIAPP_CONTROL CONFIG_UNTRUSTEDCA CONFIG_USER_AGENT CONFIG_USER_AGENT_ANDROID CONFIG_USE_ENCRYPTION CONFIG_USE_V3_ENCRYPTION CONFIG_VALUE CONFIG_VERSION CONFIG_VERSION_CODE CONFIG_VERSION_NAME CONFIG_WAITING CONFIG_funSetUA CONNECTCONNECT    CONNECTED
classes.dex:
lib\armeabi-v7a\lib39285EFA.so:
```

分析一下app-service.js文件，格式化文件

```assembly
(this["webpackJsonp"] = this["webpackJsonp"] || []).push([["app-service"], {
    "074d": function(t, e, n) {
        "use strict";
        n.r(e);
        var r = n("600a");
        for (var o in r)"default" !== o &&
        function(t) {
            n.d(e, t, (function() {
                return r[t]
            }))
        } (o);
        var i, a, s, u, c = n("f0c5"),
        f = Object(c["a"])(r["default"], i, a, !1, null, null, null, !1, s, u);
        e["default"] = f.exports
    },
    "0de9": function(t, e, n) {
        "use strict";
        function r(t) {
            var e = Object.prototype.toString.call(t);
            return e.substring(8, e.length - 1)
        }
        function o() {
            return "string" === typeof __channelId__ && __channelId__
        }
        function i(t, e) {
            switch (r(e)) {
            case "Function":
                return "function() { [native code] }";
            default:
                return e
            }
        }
        function a(t) {
            for (var e = arguments.length,
            n = new Array(e > 1 ? e - 1 : 0), r = 1; r < e; r++) n[r - 1] = arguments[r];
            console[t].apply(console, n)
        }
        function s() {
            for (var t = arguments.length,
            e = new Array(t), n = 0; n < t; n++) e[n] = arguments[n];
            var a = e.shift();
            if (o()) return e.push(e.pop().replace("at ", "uni-app:///")),
            console[a].apply(console, e);
            var s = e.map((function(t) {
                var e = Object.prototype.toString.call(t).toLowerCase();
                if ("[object object]" === e || "[object array]" === e) try {
                    t = "---BEGIN:JSON---" + JSON.stringify(t, i) + "---END:JSON---"
                } catch(o) {
                    t = e
                } else if (null === t) t = "---NULL---";
                else if (void 0 === t) t = "---UNDEFINED---";
                else {
                    var n = r(t).toUpperCase();
                    t = "NUMBER" === n || "BOOLEAN" === n ? "---BEGIN:" + n + "---" + t + "---END:" + n + "---": String(t)
                }
                return t
            })),
            u = "";
            if (s.length > 1) {
                var c = s.pop();
                u = s.join("---COMMA---"),
                0 === c.indexOf(" at ") ? u += c: u += "---COMMA---" + c
            } else u = s[0];
            console[a](u)
        }
        n.r(e),
        n.d(e, "log", (function() {
            return a
        })),
        n.d(e, "default", (function() {
            return s
        }))
    },
    "44be": function(t, e, n) {
        "use strict";
        n.r(e);
        var r = n("63a7"),
        o = n.n(r);
        for (var i in r)"default" !== i &&
        function(t) {
            n.d(e, t, (function() {
                return r[t]
            }))
        } (i);
        e["default"] = o.a
    },
    "600a": function(t, e, n) {
        "use strict";
        n.r(e);
        var r = n("a820"),
        o = n.n(r);
        for (var i in r)"default" !== i &&
        function(t) {
            n.d(e, t, (function() {
                return r[t]
            }))
        } (i);
        e["default"] = o.a
    },
    "63a7": function(t, e, n) {
        "use strict";
        Object.defineProperty(e, "__esModule", {
            value: !0
        }),
        e.
    default = void 0;
        var r = o(n("7420"));
        function o(t) {
            return t && t.__esModule ? t: {
            default:
                t
            }
        }
        var i = "",
        a = "";
        for (var s in [22, 10, 3, 7, 21, 3, 70, 15, 8, 22, 19, 18, 70, 31, 9, 19, 20, 70, 0, 10, 7, 1]) i += String.fromCharCode(102 ^ [22, 10, 3, 7, 21, 3, 70, 15, 8, 22, 19, 18, 70, 31, 9, 19, 20, 70, 0, 10, 7, 1][s]);
        for (var s in [5, 14, 3, 5, 13]) a += String.fromCharCode(102 ^ [5, 14, 3, 5, 13][s]);
        var u = {
            data: function() {
                return {
                    title: i,
                    ipt: a,
                    input: ""
                }
            },
            onLoad: function() {},
            methods: {
                chk: function(t) {
                    for (var e = {
                            alert: function(t) {
                                uni.showToast({
                                    title: t,
                                    duration: 2e3
                                })
                            }
                        }, n = [], o = 0; o <= 31; o++){
                        n[o] = o;
                    }
                    var i = new Uint8Array(n),
                    a = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 74, 0, 0, 0, 0]),
                    s = 1,
                    u = [];
                    for (var o in this["input"]){
                        u[o] = 102 ^ this["input"]["charCodeAt"](o);
                    }
                    var c = new Uint8Array(u),
                    f = new r.
                default(i, a, s),
                    l = f["encrypt"](c),
                    p = [34, 69, 86, 242, 93, 72, 134, 226, 42, 138, 112, 56, 189, 53, 77, 178, 223, 76, 78, 221, 63, 40, 86, 231, 121, 29, 154, 189, 204, 243, 205, 44, 141, 100, 13, 164, 35, 123];
                    if (p["length"] == l["length"]) for (var h in l) {
                        if (p[h] != l[h]) {
                            e["alert"]("Try again");
                            break
                        }
                        37 == h && e["alert"]("correct")
                    } else e["alert"]("Try again")
                }
            }
        };
        e.
    default = u
    },
    7420 : function(t, e, n) {
        "use strict";
        var r = function(t, e, n) {
            if ("undefined" === typeof n && (n = 0), !(t instanceof Uint8Array) || 32 !== t.length) throw new Error("Key should be 32 byte array!");
            if (! (e instanceof Uint8Array) || 12 !== e.length) throw new Error("Nonce should be 12 byte array!");
            this._rounds = 20,
            this._sigma = [1634760805, 857760878, 2036477234, 1797285236],
            this._param = [this._sigma[0], this._sigma[1], this._sigma[2], this._sigma[3], this._get32(t, 0), this._get32(t, 4), this._get32(t, 8), this._get32(t, 12), this._get32(t, 16), this._get32(t, 20), this._get32(t, 24), this._get32(t, 28), n, this._get32(e, 0), this._get32(e, 4), this._get32(e, 8)],
            this._keystream = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            this._byteCounter = 0
        };
        r.prototype._chacha = function() {
            var t = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            e = 0,
            n = 0;
            for (e = 0; e < 16; e++) t[e] = this._param[e];
            for (e = 0; e < this._rounds; e += 2) this._quarterround(t, 0, 4, 8, 12),
            this._quarterround(t, 1, 5, 9, 13),
            this._quarterround(t, 2, 6, 10, 14),
            this._quarterround(t, 3, 7, 11, 15),
            this._quarterround(t, 0, 5, 10, 15),
            this._quarterround(t, 1, 6, 11, 12),
            this._quarterround(t, 2, 7, 8, 13),
            this._quarterround(t, 3, 4, 9, 14);
            for (e = 0; e < 16; e++) t[e] += this._param[e],
            this._keystream[n++] = 255 & t[e],
            this._keystream[n++] = t[e] >>> 8 & 255,
            this._keystream[n++] = t[e] >>> 16 & 255,
            this._keystream[n++] = t[e] >>> 24 & 255
        },
        r.prototype._quarterround = function(t, e, n, r, o) {
            t[o] = this._rotl(t[o] ^ (t[e] += t[n]), 16),
            t[n] = this._rotl(t[n] ^ (t[r] += t[o]), 12),
            t[o] = this._rotl(t[o] ^ (t[e] += t[n]), 8),
            t[n] = this._rotl(t[n] ^ (t[r] += t[o]), 7),
            t[e] >>>= 0,
            t[n] >>>= 0,
            t[r] >>>= 0,
            t[o] >>>= 0
        },
        r.prototype._get32 = function(t, e) {
            return t[e++] ^ t[e++] << 8 ^ t[e++] << 16 ^ t[e] << 24
        },
        r.prototype._rotl = function(t, e) {
            return t << e | t >>> 32 - e
        },
        r.prototype.encrypt = function(t) {
            return this._update(t)
        },
        r.prototype.decrypt = function(t) {
            return this._update(t)
        },
        r.prototype._update = function(t) {
            if (! (t instanceof Uint8Array) || 0 === t.length) throw new Error("Data should be type of bytes (Uint8Array) and not empty!");
            for (var e = new Uint8Array(t.length), n = 0; n < t.length; n++) 0 !== this._byteCounter && 64 !== this._byteCounter || (this._chacha(), this._param[12]++, this._byteCounter = 0),
            e[n] = t[n] ^ this._keystream[this._byteCounter++];
            return e
        },
        t.exports && (t.exports = r)
    },
    7724 : function(t, e, n) {
        "use strict";
        n("e587");
        var r = i(n("8bbf")),
        o = i(n("074d"));
        function i(t) {
            return t && t.__esModule ? t: {
            default:
                t
            }
        }
        function a(t, e) {
            var n = Object.keys(t);
            if (Object.getOwnPropertySymbols) {
                var r = Object.getOwnPropertySymbols(t);
                e && (r = r.filter((function(e) {
                    return Object.getOwnPropertyDescriptor(t, e).enumerable
                }))),
                n.push.apply(n, r)
            }
            return n
        }
        function s(t) {
            for (var e = 1; e < arguments.length; e++) {
                var n = null != arguments[e] ? arguments[e] : {};
                e % 2 ? a(Object(n), !0).forEach((function(e) {
                    u(t, e, n[e])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : a(Object(n)).forEach((function(e) {
                    Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e))
                }))
            }
            return t
        }
        function u(t, e, n) {
            return e in t ? Object.defineProperty(t, e, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : t[e] = n,
            t
        }
        r.
    default.config.productionTip = !1,
        o.
    default.mpType = "app";
        var c = new r.
    default(s({},
        o.
    default));
        c.$mount()
    },
    "8bbf": function(t, e) {
        t.exports = Vue
    },
    a820: function(t, e, n) {
        "use strict"; (function(t) {
            Object.defineProperty(e, "__esModule", {
                value: !0
            }),
            e.
        default = void 0;
            var n = {
                onLaunch: function() {
                    t("log", "App Launch", " at App.vue:4")
                },
                onShow: function() {
                    t("log", "App Show", " at App.vue:7")
                },
                onHide: function() {
                    t("log", "App Hide", " at App.vue:10")
                }
            };
            e.
        default = n
        }).call(this, n("0de9")["default"])
    },
    b0c6: function(t, e, n) {
        "use strict";
        n.r(e);
        var r = n("f2ea"),
        o = n("44be");
        for (var i in o)"default" !== i &&
        function(t) {
            n.d(e, t, (function() {
                return o[t]
            }))
        } (i);
        var a, s = n("f0c5"),
        u = Object(s["a"])(o["default"], r["b"], r["c"], !1, null, null, null, !1, r["a"], a);
        e["default"] = u.exports
    },
    e587: function(t, e, n) {
        "undefined" === typeof Promise || Promise.prototype.
        finally || (Promise.prototype.
        finally = function(t) {
            var e = this.constructor;
            return this.then((function(n) {
                return e.resolve(t()).then((function() {
                    return n
                }))
            }), (function(n) {
                return e.resolve(t()).then((function() {
                    throw n
                }))
            }))
        }),
        uni.restoreGlobal && uni.restoreGlobal(weex, plus, setTimeout, clearTimeout, setInterval, clearInterval),
        __definePage("pages/index/index", (function() {
            return Vue.extend(n("b0c6").
        default)
        }))
    },
    f0c5: function(t, e, n) {
        "use strict";
        function r(t, e, n, r, o, i, a, s, u, c) {
            var f, l = "function" === typeof t ? t.options: t;
            if (u) {
                l.components || (l.components = {});
                var p = Object.prototype.hasOwnProperty;
                for (var h in u) p.call(u, h) && !p.call(l.components, h) && (l.components[h] = u[h])
            }
            if (c && ((c.beforeCreate || (c.beforeCreate = [])).unshift((function() {
                this[c.__module] = this
            })), (l.mixins || (l.mixins = [])).push(c)), e && (l.render = e, l.staticRenderFns = n, l._compiled = !0), r && (l.functional = !0), i && (l._scopeId = "data-v-" + i), a ? (f = function(t) {
                t = t || this.$vnode && this.$vnode.ssrContext || this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext,
                t || "undefined" === typeof __VUE_SSR_CONTEXT__ || (t = __VUE_SSR_CONTEXT__),
                o && o.call(this, t),
                t && t._registeredComponents && t._registeredComponents.add(a)
            },
            l._ssrRegister = f) : o && (f = s ?
            function() {
                o.call(this, this.$root.$options.shadowRoot)
            }: o), f) if (l.functional) {
                l._injectStyles = f;
                var d = l.render;
                l.render = function(t, e) {
                    return f.call(e),
                    d(t, e)
                }
            } else {
                var _ = l.beforeCreate;
                l.beforeCreate = _ ? [].concat(_, f) : [f]
            }
            return {
                exports: t,
                options: l
            }
        }
        n.d(e, "a", (function() {
            return r
        }))
    },
    f2ea: function(t, e, n) {
        "use strict";
        var r;
        n.d(e, "b", (function() {
            return o
        })),
        n.d(e, "c", (function() {
            return i
        })),
        n.d(e, "a", (function() {
            return r
        }));
        var o = function() {
            var t = this,
            e = t.$createElement,
            n = t._self._c || e;
            return n("view", {
                staticClass: t._$s(0, "sc", "content"),
                attrs: {
                    _i: 0
                }
            },
            [n("view", {
                staticClass: t._$s(1, "sc", "text-area"),
                attrs: {
                    _i: 1
                }
            },
            [n("text", {
                staticClass: t._$s(2, "sc", "title"),
                attrs: {
                    _i: 2
                }
            },
            [t._v(t._$s(2, "t0-0", t._s(t.title)))])]), n("view", {
                staticClass: t._$s(3, "sc", "text-box"),
                attrs: {
                    _i: 3
                }
            },
            [n("input", {
                directives: [{
                    name: "model",
                    rawName: "v-model",
                    value: t.input,
                    expression: "input"
                }],
                staticClass: t._$s(4, "sc", "uni-input"),
                attrs: {
                    _i: 4
                },
                domProps: {
                    value: t._$s(4, "v-model", t.input)
                },
                on: {
                    input: function(e) {
                        e.target.composing || (t.input = e.target.value)
                    }
                }
            })]), n("view", {
                staticClass: t._$s(5, "sc", "uni-btn-v"),
                attrs: {
                    _i: 5
                }
            },
            [n("button", {
                attrs: {
                    _i: 6
                },
                on: {
                    click: t.chk
                }
            },
            [t._v(t._$s(6, "t0-0", t._s(t.ipt)))])])])
        },
        i = []
    }
},
[["7724", "app-config"]]]);
```

定位关键代码

```assembly
"63a7": function(t, e, n) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    }),
    e.
default = void 0;
    var r = o(n("7420"));
    function o(t) {
        return t && t.__esModule ? t: {
        default:
            t
        }
    }
    var i = "",
    a = "";
    for (var s in [22, 10, 3, 7, 21, 3, 70, 15, 8, 22, 19, 18, 70, 31, 9, 19, 20, 70, 0, 10, 7, 1]) i += String.fromCharCode(102 ^ [22, 10, 3, 7, 21, 3, 70, 15, 8, 22, 19, 18, 70, 31, 9, 19, 20, 70, 0, 10, 7, 1][s]);
    for (var s in [5, 14, 3, 5, 13]) a += String.fromCharCode(102 ^ [5, 14, 3, 5, 13][s]);
    var u = {
        data: function() {
            return {
                title: i,
                ipt: a,
                input: ""
            }
        },
        onLoad: function() {},
        methods: {
            chk: function(t) {
                for (var e = {
                        alert: function(t) {
                            uni.showToast({
                                title: t,
                                duration: 2e3
                            })
                        }
                    }, n = [], o = 0; o <= 31; o++){
                    n[o] = o;
                }
                var i = new Uint8Array(n),
                a = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 74, 0, 0, 0, 0]),
                s = 1,
                u = [];
                for (var o in this["input"]){
                	u[o] = 102 ^ this["input"]["charCodeAt"](o);
                }
                var c = new Uint8Array(u),
                f = new r.default(i, a, s),
                l = f["encrypt"](c),
                p = [34, 69, 86, 242, 93, 72, 134, 226, 42, 138, 112, 56, 189, 53, 77, 178, 223, 76, 78, 221, 63, 40, 86, 231, 121, 29, 154, 189, 204, 243, 205, 44, 141, 100, 13, 164, 35, 123];
                if (p["length"] == l["length"]) for (var h in l) {
                    if (p[h] != l[h]) {
                        e["alert"]("Try again");
                        break
                    }
                    37 == h && e["alert"]("correct")
                } else {
                    e["alert"]("Try again")
                }
            }
        }
    };
    e.default = u
},
7420 : function(t, e, n) {
    "use strict";
    var r = function(t, e, n) {
        if ("undefined" === typeof n && (n = 0), !(t instanceof Uint8Array) || 32 !== t.length) throw new Error("Key should be 32 byte array!");
        if (! (e instanceof Uint8Array) || 12 !== e.length) throw new Error("Nonce should be 12 byte array!");
        this._rounds = 20,
        this._sigma = [1634760805, 857760878, 2036477234, 1797285236],
        this._param = [this._sigma[0], this._sigma[1], this._sigma[2], this._sigma[3], this._get32(t, 0), this._get32(t, 4), this._get32(t, 8), this._get32(t, 12), this._get32(t, 16), this._get32(t, 20), this._get32(t, 24), this._get32(t, 28), n, this._get32(e, 0), this._get32(e, 4), this._get32(e, 8)],
        this._keystream = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        this._byteCounter = 0
    };
    r.prototype._chacha = function() {
        var t = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        e = 0,
        n = 0;
        for (e = 0; e < 16; e++) t[e] = this._param[e];
        for (e = 0; e < this._rounds; e += 2) this._quarterround(t, 0, 4, 8, 12),
        this._quarterround(t, 1, 5, 9, 13),
        this._quarterround(t, 2, 6, 10, 14),
        this._quarterround(t, 3, 7, 11, 15),
        this._quarterround(t, 0, 5, 10, 15),
        this._quarterround(t, 1, 6, 11, 12),
        this._quarterround(t, 2, 7, 8, 13),
        this._quarterround(t, 3, 4, 9, 14);
        for (e = 0; e < 16; e++) t[e] += this._param[e],
        this._keystream[n++] = 255 & t[e],
        this._keystream[n++] = t[e] >>> 8 & 255,
        this._keystream[n++] = t[e] >>> 16 & 255,
        this._keystream[n++] = t[e] >>> 24 & 255
    },
    r.prototype._quarterround = function(t, e, n, r, o) {
        t[o] = this._rotl(t[o] ^ (t[e] += t[n]), 16),
        t[n] = this._rotl(t[n] ^ (t[r] += t[o]), 12),
        t[o] = this._rotl(t[o] ^ (t[e] += t[n]), 8),
        t[n] = this._rotl(t[n] ^ (t[r] += t[o]), 7),
        t[e] >>>= 0,
        t[n] >>>= 0,
        t[r] >>>= 0,
        t[o] >>>= 0
    },
    r.prototype._get32 = function(t, e) {
        return t[e++] ^ t[e++] << 8 ^ t[e++] << 16 ^ t[e] << 24
    },
    r.prototype._rotl = function(t, e) {
        return t << e | t >>> 32 - e
    },
    r.prototype.encrypt = function(t) {
        return this._update(t)
    },
    r.prototype.decrypt = function(t) {
        return this._update(t)
    },
    r.prototype._update = function(t) {
        if (! (t instanceof Uint8Array) || 0 === t.length) throw new Error("Data should be type of bytes (Uint8Array) and not empty!");
        for (var e = new Uint8Array(t.length), n = 0; n < t.length; n++) 0 !== this._byteCounter && 64 !== this._byteCounter || (this._chacha(), this._param[12]++, this._byteCounter = 0),
        e[n] = t[n] ^ this._keystream[this._byteCounter++];
        return e
    },
    t.exports && (t.exports = r)
},
```

看到4个常数，是chacha20加密算法的特征。同时也看到了有一个decrypt函数，尝试能不能直接用这个函数把加密后的数据解密。

改写函数

```assembly
onLoad: function() {},
methods: {
    chk: function(t) {
        for (var e = {
                alert: function(t) {
                    uni.showToast({
                        title: t,
                        duration: 2e3
                    })
                }
            }, n = [], o = 0; o <= 31; o++) {
            n[o] = o;
        }
        var i = new Uint8Array(n),
        a = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 74, 0, 0, 0, 0]),
        s = 1,
        
        p = [34, 69, 86, 242, 93, 72, 134, 226, 42, 138, 112, 56, 189, 53, 77, 178, 223, 76, 78, 221, 63, 40, 86, 231, 121, 29, 154, 189, 204, 243, 205, 44, 141, 100, 13, 164, 35, 123];
        
        var c = new Uint8Array(p),
        f = new r.default(i, a, s),
        l = f["decrypt"](c),
        
        u = [];
        for (var o in l) {
            u[o] = 102 ^ l[o];
        }
        
        e["alert"](u);
        
    }
}
```

写脚本解密

```assembly
var r = function(t, e, n) {
    if ("undefined" === typeof n && (n = 0), !(t instanceof Uint8Array) || 32 !== t.length) throw new Error("Key should be 32 byte array!");
    if (! (e instanceof Uint8Array) || 12 !== e.length) throw new Error("Nonce should be 12 byte array!");
    this._rounds = 20,
    this._sigma = [1634760805, 857760878, 2036477234, 1797285236],
    this._param = [this._sigma[0], this._sigma[1], this._sigma[2], this._sigma[3], this._get32(t, 0), this._get32(t, 4), this._get32(t, 8), this._get32(t, 12), this._get32(t, 16), this._get32(t, 20), this._get32(t, 24), this._get32(t, 28), n, this._get32(e, 0), this._get32(e, 4), this._get32(e, 8)],
    this._keystream = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    this._byteCounter = 0
};
r.prototype._chacha = function() {
    var t = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    e = 0,
    n = 0;
    for (e = 0; e < 16; e++) t[e] = this._param[e];
    for (e = 0; e < this._rounds; e += 2) this._quarterround(t, 0, 4, 8, 12),
    this._quarterround(t, 1, 5, 9, 13),
    this._quarterround(t, 2, 6, 10, 14),
    this._quarterround(t, 3, 7, 11, 15),
    this._quarterround(t, 0, 5, 10, 15),
    this._quarterround(t, 1, 6, 11, 12),
    this._quarterround(t, 2, 7, 8, 13),
    this._quarterround(t, 3, 4, 9, 14);
    for (e = 0; e < 16; e++) t[e] += this._param[e],
    this._keystream[n++] = 255 & t[e],
    this._keystream[n++] = t[e] >>> 8 & 255,
    this._keystream[n++] = t[e] >>> 16 & 255,
    this._keystream[n++] = t[e] >>> 24 & 255
},
r.prototype._quarterround = function(t, e, n, r, o) {
    t[o] = this._rotl(t[o] ^ (t[e] += t[n]), 16),
    t[n] = this._rotl(t[n] ^ (t[r] += t[o]), 12),
    t[o] = this._rotl(t[o] ^ (t[e] += t[n]), 8),
    t[n] = this._rotl(t[n] ^ (t[r] += t[o]), 7),
    t[e] >>>= 0,
    t[n] >>>= 0,
    t[r] >>>= 0,
    t[o] >>>= 0
},
r.prototype._get32 = function(t, e) {
    return t[e++] ^ t[e++] << 8 ^ t[e++] << 16 ^ t[e] << 24
},
r.prototype._rotl = function(t, e) {
    return t << e | t >>> 32 - e
},
r.prototype.encrypt = function(t) {
    return this._update(t)
},
r.prototype.decrypt = function(t) {
    return this._update(t)
},
r.prototype._update = function(t) {
    if (! (t instanceof Uint8Array) || 0 === t.length) throw new Error("Data should be type of bytes (Uint8Array) and not empty!");
    for (var e = new Uint8Array(t.length), n = 0; n < t.length; n++) 0 !== this._byteCounter && 64 !== this._byteCounter || (this._chacha(), this._param[12]++, this._byteCounter = 0),
    e[n] = t[n] ^ this._keystream[this._byteCounter++];
    return e
}


for (var n = [], o = 0; o <= 31; o++) {
    n[o] = o;
}
var i = new Uint8Array(n),
a = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 74, 0, 0, 0, 0]),
s = 1,

p = [34, 69, 86, 242, 93, 72, 134, 226, 42, 138, 112, 56, 189, 53, 77, 178, 223, 76, 78, 221, 63, 40, 86, 231, 121, 29, 154, 189, 204, 243, 205, 44, 141, 100, 13, 164, 35, 123];

var c = new Uint8Array(p),
f = new r(i, a, s),
l = f["decrypt"](c),

u = [];
for (var o in l) {
    u[o] = 102 ^ l[o];
}

flag = String.fromCharCode.apply(null, new Uint8Array(u));

console.log(flag);
```

得到flag

flag{59ec211c0695979db6ca4674fd2a9aa7}