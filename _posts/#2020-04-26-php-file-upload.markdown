---
layout: post
title:  PHP学习(四)
date:   2020-04-26 14:02:00 +0300
image:  5-loveourplanet.jpg
tags:   [PHP]
---

php.ini

| 配置项              | 功能说明                       |
| ------------------- | ------------------------------ |
| file_uploads        | on为开启文件上传功能,off为关闭 |
| post_max_size       | 系统允许的POST传参的最大值     |
| upload_max_filesize | 系统允许的上传文件的最大值     |
| memory_limit        | 内存使用限制                   |

* 判断是否有错误码

  | 错误码 | 说明                                                         |
  | ------ | ------------------------------------------------------------ |
  | 0      | 无误,可以继续进行文件上传的后续操作                          |
  | 1      | 超出上传文件的最大限制,upload_max_filesize=2M php.ini中设置, 一般默认是2M.可根据项目中的实际需要来修改 |
  | 2      | 超出了指定的文件大小,根据项目的业务需求指定上传文件的大小限制 |
  | 3      | 只有部分文件被上传                                           |
  | 4      | 文件没有被上传                                               |
  | 6      | 找不到临时文件夹，可能目录不存在或没权限                     |
  | 7      | 文件写入失败，可能磁盘满了或没有权限                         |

* 自定义判断是否超出文件大小的范围

  在开发上传功能时。我们作为开发人员，除了php.ini中规定的上传的最大值外。

  我们通常还会设定一个值，是业务规定的上传大小限制。

  例如：
  新浪微博或者QQ空间只准单张头像图片2M。而在上传图册的时候又可以超过2M来上传。

  所以说，它的系统是支持更大文件上传的。

  此处的判断文件大小，我们用于限制实际业务中我们想要规定的上传的文件大小。

* 判断后缀名和mime类型是否符合

* 生成文件名

  我们可以采用date()、mt_rand()或者unique()生成随机的文件名。

* 判断是否是上传文件

  is_uploaded_file()传入一个参数($_FILES中的缓存文件名)，判断传入的名称是不是上传文件。

* 移动临时文件到指定位置

  我们使用：move_uploaded_file()。
  这个函数是将上传文件移动到指定位置，并命名。
  传入两个参数：
  第一个参数是指定移动的上传文件；
  第二个参数是指定的文件夹和名称拼接的字符串。

