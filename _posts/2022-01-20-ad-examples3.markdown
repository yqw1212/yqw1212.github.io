---
layout: post
title:  常见深度学习平台
date:   2022-01-20 00:08:01 +0300
image:  2022-01-20-fantastic.jpg
tags:   [note,MachineLearning,AdversarialExamples]
---

### Keras解决手写数字识别问题

```assembly
import keras
from keras.datasets import mnist
from keras.models import Sequential
from keras.layers import Dense, Dropout
from keras.optimizers import RMSprop


batch_size = 128
num_classes = 10
epochs = 20

(x_train, y_train), (x_test, y_test) = mnist.load_data()

x_train = x_train.reshape(60000, 784)
x_test = x_test.reshape(10000, 784)
x_train = x_train.astype('float32')
x_test = x_test.astype('float32')
x_train /= 255
x_test /= 255
print(x_train.shape[0], 'train samples')  # 60000 train samples
print(x_test.shape[0], 'test samples')  # 10000 test samples

y_train = keras.utils.to_categorical(y_train, num_classes)
y_test = keras.utils.to_categorical(y_test, num_classes)

# 定义网络结构
model = Sequential()
model.add(Dense(512, activation='relu', input_shape=(784,)))
model.add(Dropout(0.2))  # 为了避免过拟合
model.add(Dense(512, activation='relu'))
model.add(Dropout(0.2))  # 为了避免过拟合
model.add(Dense(num_classes, activation='softmax'))

model.summary()
'''
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 512)               401920    
_________________________________________________________________
dropout_1 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 512)               262656    
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                5130      
=================================================================
Total params: 669,706
Trainable params: 669,706
Non-trainable params: 0
'''
# 定义损失函数和优化器
model.compile(loss='categorical_crossentropy',
              optimizer=RMSprop(),
              metrics=['accuracy'])

history = model.fit(x_train, y_train,
                    batch_size=batch_size,
                    epochs=epochs,
                    verbose=1,
                    validation_data=(x_test, y_test))
score = model.evaluate(x_test, y_test, verbose=0)
print('Test loss:', score[0])
print('Test accuracy:', score[1])

model.save('models/keras-model.h5')
```

训练过程

```assembly
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
2022-01-19 16:26:03.299918: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2

  128/60000 [..............................] - ETA: 1:46 - loss: 2.3875 - acc: 0.0703
  768/60000 [..............................] - ETA: 22s - loss: 1.6018 - acc: 0.4688 
 1408/60000 [..............................] - ETA: 14s - loss: 1.2782 - acc: 0.5774
 2048/60000 [>.............................] - ETA: 11s - loss: 1.1101 - acc: 0.6392
 2688/60000 [>.............................] - ETA: 9s - loss: 0.9935 - acc: 0.6752 
 3328/60000 [>.............................] - ETA: 8s - loss: 0.8998 - acc: 0.7067
 3968/60000 [>.............................] - ETA: 8s - loss: 0.8377 - acc: 0.7283
 4608/60000 [=>............................] - ETA: 7s - loss: 0.7851 - acc: 0.7478
 5120/60000 [=>............................] - ETA: 7s - loss: 0.7573 - acc: 0.7557
 5632/60000 [=>............................] - ETA: 7s - loss: 0.7219 - acc: 0.7678
 6144/60000 [==>...........................] - ETA: 7s - loss: 0.6941 - acc: 0.7775
 6656/60000 [==>...........................] - ETA: 6s - loss: 0.6727 - acc: 0.7855
 7168/60000 [==>...........................] - ETA: 6s - loss: 0.6520 - acc: 0.7931
 7680/60000 [==>...........................] - ETA: 6s - loss: 0.6320 - acc: 0.8000
 8192/60000 [===>..........................] - ETA: 6s - loss: 0.6195 - acc: 0.8035
 8832/60000 [===>..........................] - ETA: 6s - loss: 0.6063 - acc: 0.8085
 9344/60000 [===>..........................] - ETA: 6s - loss: 0.5902 - acc: 0.8140
 9984/60000 [===>..........................] - ETA: 6s - loss: 0.5741 - acc: 0.8196
10496/60000 [====>.........................] - ETA: 5s - loss: 0.5592 - acc: 0.8245
11136/60000 [====>.........................] - ETA: 5s - loss: 0.5396 - acc: 0.8302
11776/60000 [====>.........................] - ETA: 5s - loss: 0.5212 - acc: 0.8364
12416/60000 [=====>........................] - ETA: 5s - loss: 0.5143 - acc: 0.8386
13056/60000 [=====>........................] - ETA: 5s - loss: 0.5027 - acc: 0.8424
13696/60000 [=====>........................] - ETA: 5s - loss: 0.4911 - acc: 0.8464
14336/60000 [======>.......................] - ETA: 5s - loss: 0.4797 - acc: 0.8500
14976/60000 [======>.......................] - ETA: 5s - loss: 0.4698 - acc: 0.8533
15616/60000 [======>.......................] - ETA: 4s - loss: 0.4617 - acc: 0.8553
16256/60000 [=======>......................] - ETA: 4s - loss: 0.4554 - acc: 0.8569
16768/60000 [=======>......................] - ETA: 4s - loss: 0.4481 - acc: 0.8592
17408/60000 [=======>......................] - ETA: 4s - loss: 0.4406 - acc: 0.8614
18048/60000 [========>.....................] - ETA: 4s - loss: 0.4331 - acc: 0.8638
18688/60000 [========>.....................] - ETA: 4s - loss: 0.4257 - acc: 0.8662
19200/60000 [========>.....................] - ETA: 4s - loss: 0.4210 - acc: 0.8675
19712/60000 [========>.....................] - ETA: 4s - loss: 0.4149 - acc: 0.8695
20224/60000 [=========>....................] - ETA: 4s - loss: 0.4105 - acc: 0.8711
20864/60000 [=========>....................] - ETA: 4s - loss: 0.4042 - acc: 0.8731
21504/60000 [=========>....................] - ETA: 4s - loss: 0.4001 - acc: 0.8743
22144/60000 [==========>...................] - ETA: 4s - loss: 0.3951 - acc: 0.8763
22784/60000 [==========>...................] - ETA: 3s - loss: 0.3901 - acc: 0.8780
23424/60000 [==========>...................] - ETA: 3s - loss: 0.3854 - acc: 0.8792
24064/60000 [===========>..................] - ETA: 3s - loss: 0.3784 - acc: 0.8816
24704/60000 [===========>..................] - ETA: 3s - loss: 0.3735 - acc: 0.8831
25216/60000 [===========>..................] - ETA: 3s - loss: 0.3702 - acc: 0.8840
25856/60000 [===========>..................] - ETA: 3s - loss: 0.3666 - acc: 0.8852
26496/60000 [============>.................] - ETA: 3s - loss: 0.3627 - acc: 0.8865
27136/60000 [============>.................] - ETA: 3s - loss: 0.3590 - acc: 0.8877
27776/60000 [============>.................] - ETA: 3s - loss: 0.3556 - acc: 0.8888
28416/60000 [=============>................] - ETA: 3s - loss: 0.3513 - acc: 0.8902
29056/60000 [=============>................] - ETA: 3s - loss: 0.3491 - acc: 0.8908
29696/60000 [=============>................] - ETA: 3s - loss: 0.3458 - acc: 0.8919
30336/60000 [==============>...............] - ETA: 3s - loss: 0.3421 - acc: 0.8929
30976/60000 [==============>...............] - ETA: 2s - loss: 0.3376 - acc: 0.8942
31616/60000 [==============>...............] - ETA: 2s - loss: 0.3347 - acc: 0.8951
32256/60000 [===============>..............] - ETA: 2s - loss: 0.3316 - acc: 0.8962
32896/60000 [===============>..............] - ETA: 2s - loss: 0.3285 - acc: 0.8971
33536/60000 [===============>..............] - ETA: 2s - loss: 0.3261 - acc: 0.8981
34176/60000 [================>.............] - ETA: 2s - loss: 0.3230 - acc: 0.8990
34816/60000 [================>.............] - ETA: 2s - loss: 0.3199 - acc: 0.9000
35456/60000 [================>.............] - ETA: 2s - loss: 0.3166 - acc: 0.9011
36096/60000 [=================>............] - ETA: 2s - loss: 0.3135 - acc: 0.9020
36736/60000 [=================>............] - ETA: 2s - loss: 0.3123 - acc: 0.9024
37376/60000 [=================>............] - ETA: 2s - loss: 0.3097 - acc: 0.9034
38016/60000 [==================>...........] - ETA: 2s - loss: 0.3082 - acc: 0.9038
38528/60000 [==================>...........] - ETA: 2s - loss: 0.3064 - acc: 0.9044
39168/60000 [==================>...........] - ETA: 2s - loss: 0.3035 - acc: 0.9052
39808/60000 [==================>...........] - ETA: 2s - loss: 0.3012 - acc: 0.9059
40448/60000 [===================>..........] - ETA: 1s - loss: 0.2986 - acc: 0.9067
41088/60000 [===================>..........] - ETA: 1s - loss: 0.2966 - acc: 0.9073
41728/60000 [===================>..........] - ETA: 1s - loss: 0.2944 - acc: 0.9081
42368/60000 [====================>.........] - ETA: 1s - loss: 0.2924 - acc: 0.9089
42880/60000 [====================>.........] - ETA: 1s - loss: 0.2909 - acc: 0.9093
43520/60000 [====================>.........] - ETA: 1s - loss: 0.2882 - acc: 0.9102
44032/60000 [=====================>........] - ETA: 1s - loss: 0.2876 - acc: 0.9105
44416/60000 [=====================>........] - ETA: 1s - loss: 0.2862 - acc: 0.9110
44928/60000 [=====================>........] - ETA: 1s - loss: 0.2840 - acc: 0.9116
45312/60000 [=====================>........] - ETA: 1s - loss: 0.2829 - acc: 0.9118
45824/60000 [=====================>........] - ETA: 1s - loss: 0.2821 - acc: 0.9121
46336/60000 [======================>.......] - ETA: 1s - loss: 0.2809 - acc: 0.9126
46976/60000 [======================>.......] - ETA: 1s - loss: 0.2798 - acc: 0.9130
47616/60000 [======================>.......] - ETA: 1s - loss: 0.2780 - acc: 0.9134
48256/60000 [=======================>......] - ETA: 1s - loss: 0.2764 - acc: 0.9139
48896/60000 [=======================>......] - ETA: 1s - loss: 0.2743 - acc: 0.9145
49536/60000 [=======================>......] - ETA: 1s - loss: 0.2732 - acc: 0.9149
50176/60000 [========================>.....] - ETA: 0s - loss: 0.2713 - acc: 0.9154
50816/60000 [========================>.....] - ETA: 0s - loss: 0.2703 - acc: 0.9158
51456/60000 [========================>.....] - ETA: 0s - loss: 0.2687 - acc: 0.9163
52096/60000 [=========================>....] - ETA: 0s - loss: 0.2676 - acc: 0.9167
52736/60000 [=========================>....] - ETA: 0s - loss: 0.2660 - acc: 0.9171
53376/60000 [=========================>....] - ETA: 0s - loss: 0.2645 - acc: 0.9175
54016/60000 [==========================>...] - ETA: 0s - loss: 0.2633 - acc: 0.9180
54656/60000 [==========================>...] - ETA: 0s - loss: 0.2616 - acc: 0.9186
55296/60000 [==========================>...] - ETA: 0s - loss: 0.2599 - acc: 0.9191
55936/60000 [==========================>...] - ETA: 0s - loss: 0.2589 - acc: 0.9193
56576/60000 [===========================>..] - ETA: 0s - loss: 0.2571 - acc: 0.9198
57088/60000 [===========================>..] - ETA: 0s - loss: 0.2565 - acc: 0.9200
57728/60000 [===========================>..] - ETA: 0s - loss: 0.2555 - acc: 0.9203
58368/60000 [============================>.] - ETA: 0s - loss: 0.2543 - acc: 0.9207
59008/60000 [============================>.] - ETA: 0s - loss: 0.2527 - acc: 0.9212
59648/60000 [============================>.] - ETA: 0s - loss: 0.2513 - acc: 0.9216
60000/60000 [==============================] - 6s 103us/step - loss: 0.2504 - acc: 0.9219 - val_loss: 0.1079 - val_acc: 0.9660
Epoch 2/20

  128/60000 [..............................] - ETA: 5s - loss: 0.0494 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0706 - acc: 0.9792
 1408/60000 [..............................] - ETA: 5s - loss: 0.0634 - acc: 0.9801
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0771 - acc: 0.9780
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0851 - acc: 0.9743
 3328/60000 [>.............................] - ETA: 4s - loss: 0.0912 - acc: 0.9733
 3968/60000 [>.............................] - ETA: 4s - loss: 0.0984 - acc: 0.9708
 4608/60000 [=>............................] - ETA: 4s - loss: 0.1022 - acc: 0.9696
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0958 - acc: 0.9712
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0961 - acc: 0.9710
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0944 - acc: 0.9714
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0969 - acc: 0.9707
 7680/60000 [==>...........................] - ETA: 4s - loss: 0.0987 - acc: 0.9706
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0982 - acc: 0.9706
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0981 - acc: 0.9704
 9600/60000 [===>..........................] - ETA: 4s - loss: 0.0988 - acc: 0.9705
10240/60000 [====>.........................] - ETA: 4s - loss: 0.0983 - acc: 0.9704
10880/60000 [====>.........................] - ETA: 4s - loss: 0.0974 - acc: 0.9706
11520/60000 [====>.........................] - ETA: 4s - loss: 0.0973 - acc: 0.9701
12160/60000 [=====>........................] - ETA: 4s - loss: 0.0977 - acc: 0.9702
12800/60000 [=====>........................] - ETA: 4s - loss: 0.0979 - acc: 0.9699
13440/60000 [=====>........................] - ETA: 4s - loss: 0.0994 - acc: 0.9695
14080/60000 [======>.......................] - ETA: 4s - loss: 0.1004 - acc: 0.9692
14720/60000 [======>.......................] - ETA: 4s - loss: 0.1012 - acc: 0.9689
15360/60000 [======>.......................] - ETA: 3s - loss: 0.1002 - acc: 0.9694
16000/60000 [=======>......................] - ETA: 3s - loss: 0.1011 - acc: 0.9691
16640/60000 [=======>......................] - ETA: 3s - loss: 0.1005 - acc: 0.9692
17280/60000 [=======>......................] - ETA: 3s - loss: 0.1006 - acc: 0.9688
17920/60000 [=======>......................] - ETA: 3s - loss: 0.1013 - acc: 0.9688
18560/60000 [========>.....................] - ETA: 3s - loss: 0.1010 - acc: 0.9686
19200/60000 [========>.....................] - ETA: 3s - loss: 0.1020 - acc: 0.9682
19840/60000 [========>.....................] - ETA: 3s - loss: 0.1025 - acc: 0.9682
20480/60000 [=========>....................] - ETA: 3s - loss: 0.1035 - acc: 0.9678
20992/60000 [=========>....................] - ETA: 3s - loss: 0.1028 - acc: 0.9681
21632/60000 [=========>....................] - ETA: 3s - loss: 0.1049 - acc: 0.9673
22272/60000 [==========>...................] - ETA: 3s - loss: 0.1049 - acc: 0.9672
22912/60000 [==========>...................] - ETA: 3s - loss: 0.1046 - acc: 0.9675
23552/60000 [==========>...................] - ETA: 3s - loss: 0.1046 - acc: 0.9676
24192/60000 [===========>..................] - ETA: 3s - loss: 0.1038 - acc: 0.9680
24832/60000 [===========>..................] - ETA: 3s - loss: 0.1042 - acc: 0.9679
25472/60000 [===========>..................] - ETA: 3s - loss: 0.1058 - acc: 0.9678
26112/60000 [============>.................] - ETA: 3s - loss: 0.1052 - acc: 0.9679
26752/60000 [============>.................] - ETA: 2s - loss: 0.1056 - acc: 0.9677
27392/60000 [============>.................] - ETA: 2s - loss: 0.1052 - acc: 0.9679
28032/60000 [=============>................] - ETA: 2s - loss: 0.1052 - acc: 0.9678
28672/60000 [=============>................] - ETA: 2s - loss: 0.1051 - acc: 0.9678
29312/60000 [=============>................] - ETA: 2s - loss: 0.1055 - acc: 0.9677
29952/60000 [=============>................] - ETA: 2s - loss: 0.1048 - acc: 0.9678
30592/60000 [==============>...............] - ETA: 2s - loss: 0.1054 - acc: 0.9677
31232/60000 [==============>...............] - ETA: 2s - loss: 0.1060 - acc: 0.9675
31872/60000 [==============>...............] - ETA: 2s - loss: 0.1056 - acc: 0.9677
32512/60000 [===============>..............] - ETA: 2s - loss: 0.1054 - acc: 0.9677
33152/60000 [===============>..............] - ETA: 2s - loss: 0.1054 - acc: 0.9677
33792/60000 [===============>..............] - ETA: 2s - loss: 0.1057 - acc: 0.9676
34432/60000 [================>.............] - ETA: 2s - loss: 0.1057 - acc: 0.9676
35072/60000 [================>.............] - ETA: 2s - loss: 0.1054 - acc: 0.9676
35712/60000 [================>.............] - ETA: 2s - loss: 0.1063 - acc: 0.9673
36352/60000 [=================>............] - ETA: 2s - loss: 0.1062 - acc: 0.9674
36992/60000 [=================>............] - ETA: 2s - loss: 0.1058 - acc: 0.9675
37632/60000 [=================>............] - ETA: 2s - loss: 0.1057 - acc: 0.9675
38272/60000 [==================>...........] - ETA: 1s - loss: 0.1054 - acc: 0.9675
38912/60000 [==================>...........] - ETA: 1s - loss: 0.1055 - acc: 0.9675
39552/60000 [==================>...........] - ETA: 1s - loss: 0.1064 - acc: 0.9673
40192/60000 [===================>..........] - ETA: 1s - loss: 0.1057 - acc: 0.9675
40832/60000 [===================>..........] - ETA: 1s - loss: 0.1057 - acc: 0.9675
41472/60000 [===================>..........] - ETA: 1s - loss: 0.1056 - acc: 0.9675
42112/60000 [====================>.........] - ETA: 1s - loss: 0.1060 - acc: 0.9675
42752/60000 [====================>.........] - ETA: 1s - loss: 0.1063 - acc: 0.9675
43392/60000 [====================>.........] - ETA: 1s - loss: 0.1061 - acc: 0.9675
44032/60000 [=====================>........] - ETA: 1s - loss: 0.1057 - acc: 0.9676
44672/60000 [=====================>........] - ETA: 1s - loss: 0.1055 - acc: 0.9677
45312/60000 [=====================>........] - ETA: 1s - loss: 0.1053 - acc: 0.9678
45824/60000 [=====================>........] - ETA: 1s - loss: 0.1056 - acc: 0.9678
46464/60000 [======================>.......] - ETA: 1s - loss: 0.1053 - acc: 0.9678
46976/60000 [======================>.......] - ETA: 1s - loss: 0.1049 - acc: 0.9679
47616/60000 [======================>.......] - ETA: 1s - loss: 0.1047 - acc: 0.9680
48256/60000 [=======================>......] - ETA: 1s - loss: 0.1051 - acc: 0.9679
48896/60000 [=======================>......] - ETA: 0s - loss: 0.1050 - acc: 0.9680
49536/60000 [=======================>......] - ETA: 0s - loss: 0.1050 - acc: 0.9680
50176/60000 [========================>.....] - ETA: 0s - loss: 0.1050 - acc: 0.9680
50816/60000 [========================>.....] - ETA: 0s - loss: 0.1047 - acc: 0.9681
51456/60000 [========================>.....] - ETA: 0s - loss: 0.1048 - acc: 0.9681
52096/60000 [=========================>....] - ETA: 0s - loss: 0.1050 - acc: 0.9682
52736/60000 [=========================>....] - ETA: 0s - loss: 0.1047 - acc: 0.9684
53376/60000 [=========================>....] - ETA: 0s - loss: 0.1047 - acc: 0.9684
54016/60000 [==========================>...] - ETA: 0s - loss: 0.1047 - acc: 0.9683
54656/60000 [==========================>...] - ETA: 0s - loss: 0.1046 - acc: 0.9682
55296/60000 [==========================>...] - ETA: 0s - loss: 0.1042 - acc: 0.9684
55936/60000 [==========================>...] - ETA: 0s - loss: 0.1037 - acc: 0.9685
56576/60000 [===========================>..] - ETA: 0s - loss: 0.1037 - acc: 0.9685
57216/60000 [===========================>..] - ETA: 0s - loss: 0.1034 - acc: 0.9685
57856/60000 [===========================>..] - ETA: 0s - loss: 0.1033 - acc: 0.9684
58496/60000 [============================>.] - ETA: 0s - loss: 0.1030 - acc: 0.9685
59008/60000 [============================>.] - ETA: 0s - loss: 0.1028 - acc: 0.9686
59520/60000 [============================>.] - ETA: 0s - loss: 0.1024 - acc: 0.9687
60000/60000 [==============================] - 6s 94us/step - loss: 0.1023 - acc: 0.9688 - val_loss: 0.0970 - val_acc: 0.9711
Epoch 3/20

  128/60000 [..............................] - ETA: 5s - loss: 0.0692 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0511 - acc: 0.9870
 1408/60000 [..............................] - ETA: 5s - loss: 0.0596 - acc: 0.9851
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0639 - acc: 0.9805
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0685 - acc: 0.9788
 3328/60000 [>.............................] - ETA: 4s - loss: 0.0798 - acc: 0.9763
 3968/60000 [>.............................] - ETA: 4s - loss: 0.0837 - acc: 0.9758
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0812 - acc: 0.9759
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0784 - acc: 0.9766
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0788 - acc: 0.9762
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0795 - acc: 0.9758
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0820 - acc: 0.9752
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0805 - acc: 0.9758
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0803 - acc: 0.9755
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0794 - acc: 0.9754
 9472/60000 [===>..........................] - ETA: 4s - loss: 0.0798 - acc: 0.9756
10112/60000 [====>.........................] - ETA: 4s - loss: 0.0795 - acc: 0.9757
10752/60000 [====>.........................] - ETA: 4s - loss: 0.0806 - acc: 0.9754
11392/60000 [====>.........................] - ETA: 4s - loss: 0.0825 - acc: 0.9753
12032/60000 [=====>........................] - ETA: 4s - loss: 0.0809 - acc: 0.9759
12672/60000 [=====>........................] - ETA: 4s - loss: 0.0810 - acc: 0.9759
13312/60000 [=====>........................] - ETA: 4s - loss: 0.0797 - acc: 0.9760
13952/60000 [=====>........................] - ETA: 4s - loss: 0.0811 - acc: 0.9759
14592/60000 [======>.......................] - ETA: 4s - loss: 0.0804 - acc: 0.9759
15232/60000 [======>.......................] - ETA: 4s - loss: 0.0805 - acc: 0.9761
15872/60000 [======>.......................] - ETA: 3s - loss: 0.0799 - acc: 0.9763
16512/60000 [=======>......................] - ETA: 3s - loss: 0.0797 - acc: 0.9763
17152/60000 [=======>......................] - ETA: 3s - loss: 0.0790 - acc: 0.9763
17792/60000 [=======>......................] - ETA: 3s - loss: 0.0797 - acc: 0.9761
18432/60000 [========>.....................] - ETA: 3s - loss: 0.0808 - acc: 0.9759
19072/60000 [========>.....................] - ETA: 3s - loss: 0.0808 - acc: 0.9757
19712/60000 [========>.....................] - ETA: 3s - loss: 0.0811 - acc: 0.9756
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0820 - acc: 0.9751
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0819 - acc: 0.9754
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0810 - acc: 0.9755
22144/60000 [==========>...................] - ETA: 3s - loss: 0.0814 - acc: 0.9753
22784/60000 [==========>...................] - ETA: 3s - loss: 0.0814 - acc: 0.9752
23424/60000 [==========>...................] - ETA: 3s - loss: 0.0809 - acc: 0.9753
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0812 - acc: 0.9752
24704/60000 [===========>..................] - ETA: 3s - loss: 0.0809 - acc: 0.9753
25344/60000 [===========>..................] - ETA: 3s - loss: 0.0803 - acc: 0.9757
25984/60000 [===========>..................] - ETA: 3s - loss: 0.0804 - acc: 0.9756
26624/60000 [============>.................] - ETA: 3s - loss: 0.0792 - acc: 0.9760
27264/60000 [============>.................] - ETA: 2s - loss: 0.0792 - acc: 0.9760
27904/60000 [============>.................] - ETA: 2s - loss: 0.0784 - acc: 0.9763
28544/60000 [=============>................] - ETA: 2s - loss: 0.0782 - acc: 0.9763
29184/60000 [=============>................] - ETA: 2s - loss: 0.0781 - acc: 0.9764
29824/60000 [=============>................] - ETA: 2s - loss: 0.0784 - acc: 0.9762
30464/60000 [==============>...............] - ETA: 2s - loss: 0.0782 - acc: 0.9762
31104/60000 [==============>...............] - ETA: 2s - loss: 0.0780 - acc: 0.9762
31744/60000 [==============>...............] - ETA: 2s - loss: 0.0784 - acc: 0.9760
32384/60000 [===============>..............] - ETA: 2s - loss: 0.0780 - acc: 0.9761
33024/60000 [===============>..............] - ETA: 2s - loss: 0.0786 - acc: 0.9759
33664/60000 [===============>..............] - ETA: 2s - loss: 0.0787 - acc: 0.9759
34304/60000 [================>.............] - ETA: 2s - loss: 0.0781 - acc: 0.9761
34816/60000 [================>.............] - ETA: 2s - loss: 0.0778 - acc: 0.9762
35456/60000 [================>.............] - ETA: 2s - loss: 0.0778 - acc: 0.9762
36096/60000 [=================>............] - ETA: 2s - loss: 0.0770 - acc: 0.9764
36608/60000 [=================>............] - ETA: 2s - loss: 0.0768 - acc: 0.9764
37120/60000 [=================>............] - ETA: 2s - loss: 0.0763 - acc: 0.9765
37760/60000 [=================>............] - ETA: 2s - loss: 0.0757 - acc: 0.9767
38400/60000 [==================>...........] - ETA: 1s - loss: 0.0757 - acc: 0.9767
38912/60000 [==================>...........] - ETA: 1s - loss: 0.0758 - acc: 0.9767
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0757 - acc: 0.9766
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0759 - acc: 0.9766
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0753 - acc: 0.9767
41472/60000 [===================>..........] - ETA: 1s - loss: 0.0749 - acc: 0.9768
42112/60000 [====================>.........] - ETA: 1s - loss: 0.0751 - acc: 0.9768
42752/60000 [====================>.........] - ETA: 1s - loss: 0.0756 - acc: 0.9767
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0755 - acc: 0.9767
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0751 - acc: 0.9768
44672/60000 [=====================>........] - ETA: 1s - loss: 0.0748 - acc: 0.9769
45312/60000 [=====================>........] - ETA: 1s - loss: 0.0751 - acc: 0.9769
45952/60000 [=====================>........] - ETA: 1s - loss: 0.0751 - acc: 0.9769
46592/60000 [======================>.......] - ETA: 1s - loss: 0.0750 - acc: 0.9769
47232/60000 [======================>.......] - ETA: 1s - loss: 0.0749 - acc: 0.9768
47744/60000 [======================>.......] - ETA: 1s - loss: 0.0754 - acc: 0.9766
48384/60000 [=======================>......] - ETA: 1s - loss: 0.0754 - acc: 0.9766
49024/60000 [=======================>......] - ETA: 1s - loss: 0.0751 - acc: 0.9767
49664/60000 [=======================>......] - ETA: 0s - loss: 0.0752 - acc: 0.9767
50304/60000 [========================>.....] - ETA: 0s - loss: 0.0752 - acc: 0.9767
50944/60000 [========================>.....] - ETA: 0s - loss: 0.0756 - acc: 0.9766
51584/60000 [========================>.....] - ETA: 0s - loss: 0.0755 - acc: 0.9767
52224/60000 [=========================>....] - ETA: 0s - loss: 0.0753 - acc: 0.9768
52864/60000 [=========================>....] - ETA: 0s - loss: 0.0752 - acc: 0.9768
53504/60000 [=========================>....] - ETA: 0s - loss: 0.0749 - acc: 0.9768
54144/60000 [==========================>...] - ETA: 0s - loss: 0.0751 - acc: 0.9768
54784/60000 [==========================>...] - ETA: 0s - loss: 0.0746 - acc: 0.9769
55424/60000 [==========================>...] - ETA: 0s - loss: 0.0746 - acc: 0.9769
56064/60000 [===========================>..] - ETA: 0s - loss: 0.0742 - acc: 0.9770
56704/60000 [===========================>..] - ETA: 0s - loss: 0.0741 - acc: 0.9771
57344/60000 [===========================>..] - ETA: 0s - loss: 0.0743 - acc: 0.9770
57984/60000 [===========================>..] - ETA: 0s - loss: 0.0742 - acc: 0.9770
58624/60000 [============================>.] - ETA: 0s - loss: 0.0744 - acc: 0.9770
59264/60000 [============================>.] - ETA: 0s - loss: 0.0744 - acc: 0.9770
59904/60000 [============================>.] - ETA: 0s - loss: 0.0744 - acc: 0.9771
60000/60000 [==============================] - 6s 95us/step - loss: 0.0743 - acc: 0.9771 - val_loss: 0.0861 - val_acc: 0.9758
Epoch 4/20

  128/60000 [..............................] - ETA: 6s - loss: 0.1127 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0610 - acc: 0.9844
 1408/60000 [..............................] - ETA: 5s - loss: 0.0558 - acc: 0.9851
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0485 - acc: 0.9863
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0461 - acc: 0.9870
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0500 - acc: 0.9862
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0465 - acc: 0.9869
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0483 - acc: 0.9868
 5248/60000 [=>............................] - ETA: 5s - loss: 0.0517 - acc: 0.9863
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0522 - acc: 0.9864
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0561 - acc: 0.9851
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0566 - acc: 0.9842
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0579 - acc: 0.9837
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0585 - acc: 0.9838
 9088/60000 [===>..........................] - ETA: 4s - loss: 0.0603 - acc: 0.9834
 9728/60000 [===>..........................] - ETA: 4s - loss: 0.0584 - acc: 0.9839
10368/60000 [====>.........................] - ETA: 4s - loss: 0.0567 - acc: 0.9841
11008/60000 [====>.........................] - ETA: 4s - loss: 0.0566 - acc: 0.9841
11648/60000 [====>.........................] - ETA: 4s - loss: 0.0563 - acc: 0.9840
12288/60000 [=====>........................] - ETA: 4s - loss: 0.0570 - acc: 0.9839
12928/60000 [=====>........................] - ETA: 4s - loss: 0.0582 - acc: 0.9835
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0587 - acc: 0.9836
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0575 - acc: 0.9837
14848/60000 [======>.......................] - ETA: 4s - loss: 0.0590 - acc: 0.9834
15488/60000 [======>.......................] - ETA: 4s - loss: 0.0587 - acc: 0.9834
16128/60000 [=======>......................] - ETA: 4s - loss: 0.0587 - acc: 0.9833
16768/60000 [=======>......................] - ETA: 3s - loss: 0.0601 - acc: 0.9832
17408/60000 [=======>......................] - ETA: 3s - loss: 0.0601 - acc: 0.9832
18048/60000 [========>.....................] - ETA: 3s - loss: 0.0611 - acc: 0.9829
18688/60000 [========>.....................] - ETA: 3s - loss: 0.0610 - acc: 0.9829
19328/60000 [========>.....................] - ETA: 3s - loss: 0.0612 - acc: 0.9826
19968/60000 [========>.....................] - ETA: 3s - loss: 0.0608 - acc: 0.9827
20608/60000 [=========>....................] - ETA: 3s - loss: 0.0619 - acc: 0.9823
21248/60000 [=========>....................] - ETA: 3s - loss: 0.0620 - acc: 0.9823
21888/60000 [=========>....................] - ETA: 3s - loss: 0.0611 - acc: 0.9825
22528/60000 [==========>...................] - ETA: 3s - loss: 0.0608 - acc: 0.9824
23168/60000 [==========>...................] - ETA: 3s - loss: 0.0607 - acc: 0.9823
23808/60000 [==========>...................] - ETA: 3s - loss: 0.0606 - acc: 0.9820
24320/60000 [===========>..................] - ETA: 3s - loss: 0.0619 - acc: 0.9819
24960/60000 [===========>..................] - ETA: 3s - loss: 0.0614 - acc: 0.9820
25600/60000 [===========>..................] - ETA: 3s - loss: 0.0614 - acc: 0.9820
26240/60000 [============>.................] - ETA: 3s - loss: 0.0618 - acc: 0.9819
26880/60000 [============>.................] - ETA: 3s - loss: 0.0615 - acc: 0.9820
27520/60000 [============>.................] - ETA: 2s - loss: 0.0612 - acc: 0.9820
28160/60000 [=============>................] - ETA: 2s - loss: 0.0612 - acc: 0.9821
28800/60000 [=============>................] - ETA: 2s - loss: 0.0607 - acc: 0.9821
29440/60000 [=============>................] - ETA: 2s - loss: 0.0607 - acc: 0.9821
30080/60000 [==============>...............] - ETA: 2s - loss: 0.0610 - acc: 0.9819
30720/60000 [==============>...............] - ETA: 2s - loss: 0.0606 - acc: 0.9821
31360/60000 [==============>...............] - ETA: 2s - loss: 0.0605 - acc: 0.9820
32000/60000 [===============>..............] - ETA: 2s - loss: 0.0609 - acc: 0.9818
32640/60000 [===============>..............] - ETA: 2s - loss: 0.0612 - acc: 0.9818
33280/60000 [===============>..............] - ETA: 2s - loss: 0.0611 - acc: 0.9818
33792/60000 [===============>..............] - ETA: 2s - loss: 0.0613 - acc: 0.9818
34432/60000 [================>.............] - ETA: 2s - loss: 0.0615 - acc: 0.9817
35072/60000 [================>.............] - ETA: 2s - loss: 0.0617 - acc: 0.9816
35712/60000 [================>.............] - ETA: 2s - loss: 0.0616 - acc: 0.9816
36352/60000 [=================>............] - ETA: 2s - loss: 0.0619 - acc: 0.9814
36992/60000 [=================>............] - ETA: 2s - loss: 0.0615 - acc: 0.9815
37632/60000 [=================>............] - ETA: 2s - loss: 0.0616 - acc: 0.9815
38272/60000 [==================>...........] - ETA: 1s - loss: 0.0615 - acc: 0.9815
38912/60000 [==================>...........] - ETA: 1s - loss: 0.0611 - acc: 0.9816
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0610 - acc: 0.9815
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0610 - acc: 0.9815
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0613 - acc: 0.9815
41472/60000 [===================>..........] - ETA: 1s - loss: 0.0608 - acc: 0.9816
42112/60000 [====================>.........] - ETA: 1s - loss: 0.0609 - acc: 0.9816
42752/60000 [====================>.........] - ETA: 1s - loss: 0.0609 - acc: 0.9816
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0606 - acc: 0.9816
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0604 - acc: 0.9817
44672/60000 [=====================>........] - ETA: 1s - loss: 0.0607 - acc: 0.9816
45312/60000 [=====================>........] - ETA: 1s - loss: 0.0607 - acc: 0.9816
45952/60000 [=====================>........] - ETA: 1s - loss: 0.0603 - acc: 0.9817
46592/60000 [======================>.......] - ETA: 1s - loss: 0.0602 - acc: 0.9817
47232/60000 [======================>.......] - ETA: 1s - loss: 0.0606 - acc: 0.9816
47872/60000 [======================>.......] - ETA: 1s - loss: 0.0607 - acc: 0.9816
48512/60000 [=======================>......] - ETA: 1s - loss: 0.0610 - acc: 0.9816
49152/60000 [=======================>......] - ETA: 0s - loss: 0.0611 - acc: 0.9815
49664/60000 [=======================>......] - ETA: 0s - loss: 0.0610 - acc: 0.9815
50176/60000 [========================>.....] - ETA: 0s - loss: 0.0612 - acc: 0.9814
50816/60000 [========================>.....] - ETA: 0s - loss: 0.0614 - acc: 0.9814
51456/60000 [========================>.....] - ETA: 0s - loss: 0.0620 - acc: 0.9812
52096/60000 [=========================>....] - ETA: 0s - loss: 0.0618 - acc: 0.9813
52736/60000 [=========================>....] - ETA: 0s - loss: 0.0614 - acc: 0.9814
53376/60000 [=========================>....] - ETA: 0s - loss: 0.0615 - acc: 0.9813
54016/60000 [==========================>...] - ETA: 0s - loss: 0.0613 - acc: 0.9814
54656/60000 [==========================>...] - ETA: 0s - loss: 0.0616 - acc: 0.9814
55296/60000 [==========================>...] - ETA: 0s - loss: 0.0619 - acc: 0.9813
55936/60000 [==========================>...] - ETA: 0s - loss: 0.0617 - acc: 0.9813
56576/60000 [===========================>..] - ETA: 0s - loss: 0.0619 - acc: 0.9812
57216/60000 [===========================>..] - ETA: 0s - loss: 0.0615 - acc: 0.9813
57856/60000 [===========================>..] - ETA: 0s - loss: 0.0619 - acc: 0.9812
58496/60000 [============================>.] - ETA: 0s - loss: 0.0625 - acc: 0.9810
59136/60000 [============================>.] - ETA: 0s - loss: 0.0627 - acc: 0.9811
59776/60000 [============================>.] - ETA: 0s - loss: 0.0624 - acc: 0.9811
60000/60000 [==============================] - 6s 95us/step - loss: 0.0625 - acc: 0.9811 - val_loss: 0.0682 - val_acc: 0.9804
Epoch 5/20

  128/60000 [..............................] - ETA: 5s - loss: 0.0411 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0402 - acc: 0.9896
 1408/60000 [..............................] - ETA: 5s - loss: 0.0407 - acc: 0.9865
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0387 - acc: 0.9868
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0411 - acc: 0.9870
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0403 - acc: 0.9868
 3968/60000 [>.............................] - ETA: 4s - loss: 0.0386 - acc: 0.9866
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0460 - acc: 0.9852
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0454 - acc: 0.9857
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0452 - acc: 0.9854
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0488 - acc: 0.9851
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0479 - acc: 0.9851
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0479 - acc: 0.9853
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0469 - acc: 0.9857
 9088/60000 [===>..........................] - ETA: 4s - loss: 0.0467 - acc: 0.9857
 9728/60000 [===>..........................] - ETA: 4s - loss: 0.0465 - acc: 0.9859
10368/60000 [====>.........................] - ETA: 4s - loss: 0.0451 - acc: 0.9862
11008/60000 [====>.........................] - ETA: 4s - loss: 0.0435 - acc: 0.9866
11648/60000 [====>.........................] - ETA: 4s - loss: 0.0432 - acc: 0.9865
12288/60000 [=====>........................] - ETA: 4s - loss: 0.0428 - acc: 0.9867
12800/60000 [=====>........................] - ETA: 4s - loss: 0.0424 - acc: 0.9867
13312/60000 [=====>........................] - ETA: 4s - loss: 0.0425 - acc: 0.9868
13952/60000 [=====>........................] - ETA: 4s - loss: 0.0430 - acc: 0.9867
14592/60000 [======>.......................] - ETA: 4s - loss: 0.0432 - acc: 0.9866
15232/60000 [======>.......................] - ETA: 4s - loss: 0.0437 - acc: 0.9865
15872/60000 [======>.......................] - ETA: 4s - loss: 0.0444 - acc: 0.9861
16512/60000 [=======>......................] - ETA: 3s - loss: 0.0440 - acc: 0.9862
17152/60000 [=======>......................] - ETA: 3s - loss: 0.0432 - acc: 0.9864
17792/60000 [=======>......................] - ETA: 3s - loss: 0.0435 - acc: 0.9862
18432/60000 [========>.....................] - ETA: 3s - loss: 0.0433 - acc: 0.9862
19072/60000 [========>.....................] - ETA: 3s - loss: 0.0443 - acc: 0.9861
19712/60000 [========>.....................] - ETA: 3s - loss: 0.0444 - acc: 0.9859
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0439 - acc: 0.9860
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0441 - acc: 0.9859
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0443 - acc: 0.9858
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0444 - acc: 0.9859
22912/60000 [==========>...................] - ETA: 3s - loss: 0.0440 - acc: 0.9860
23552/60000 [==========>...................] - ETA: 3s - loss: 0.0444 - acc: 0.9861
24192/60000 [===========>..................] - ETA: 3s - loss: 0.0448 - acc: 0.9859
24832/60000 [===========>..................] - ETA: 3s - loss: 0.0450 - acc: 0.9859
25472/60000 [===========>..................] - ETA: 3s - loss: 0.0455 - acc: 0.9858
25984/60000 [===========>..................] - ETA: 3s - loss: 0.0455 - acc: 0.9856
26496/60000 [============>.................] - ETA: 3s - loss: 0.0464 - acc: 0.9854
27136/60000 [============>.................] - ETA: 3s - loss: 0.0464 - acc: 0.9853
27776/60000 [============>.................] - ETA: 2s - loss: 0.0464 - acc: 0.9853
28416/60000 [=============>................] - ETA: 2s - loss: 0.0467 - acc: 0.9853
29056/60000 [=============>................] - ETA: 2s - loss: 0.0468 - acc: 0.9854
29696/60000 [=============>................] - ETA: 2s - loss: 0.0476 - acc: 0.9853
30336/60000 [==============>...............] - ETA: 2s - loss: 0.0472 - acc: 0.9855
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0474 - acc: 0.9855
31616/60000 [==============>...............] - ETA: 2s - loss: 0.0473 - acc: 0.9855
32256/60000 [===============>..............] - ETA: 2s - loss: 0.0472 - acc: 0.9855
32896/60000 [===============>..............] - ETA: 2s - loss: 0.0472 - acc: 0.9854
33536/60000 [===============>..............] - ETA: 2s - loss: 0.0478 - acc: 0.9852
34176/60000 [================>.............] - ETA: 2s - loss: 0.0477 - acc: 0.9851
34816/60000 [================>.............] - ETA: 2s - loss: 0.0483 - acc: 0.9851
35456/60000 [================>.............] - ETA: 2s - loss: 0.0480 - acc: 0.9852
36096/60000 [=================>............] - ETA: 2s - loss: 0.0480 - acc: 0.9851
36736/60000 [=================>............] - ETA: 2s - loss: 0.0481 - acc: 0.9850
37248/60000 [=================>............] - ETA: 2s - loss: 0.0478 - acc: 0.9851
37888/60000 [=================>............] - ETA: 2s - loss: 0.0477 - acc: 0.9851
38400/60000 [==================>...........] - ETA: 1s - loss: 0.0475 - acc: 0.9851
39040/60000 [==================>...........] - ETA: 1s - loss: 0.0477 - acc: 0.9851
39680/60000 [==================>...........] - ETA: 1s - loss: 0.0477 - acc: 0.9851
40320/60000 [===================>..........] - ETA: 1s - loss: 0.0473 - acc: 0.9852
40960/60000 [===================>..........] - ETA: 1s - loss: 0.0474 - acc: 0.9852
41600/60000 [===================>..........] - ETA: 1s - loss: 0.0479 - acc: 0.9850
42240/60000 [====================>.........] - ETA: 1s - loss: 0.0480 - acc: 0.9850
42880/60000 [====================>.........] - ETA: 1s - loss: 0.0478 - acc: 0.9849
43520/60000 [====================>.........] - ETA: 1s - loss: 0.0483 - acc: 0.9849
44160/60000 [=====================>........] - ETA: 1s - loss: 0.0484 - acc: 0.9849
44800/60000 [=====================>........] - ETA: 1s - loss: 0.0480 - acc: 0.9849
45440/60000 [=====================>........] - ETA: 1s - loss: 0.0482 - acc: 0.9849
46080/60000 [======================>.......] - ETA: 1s - loss: 0.0482 - acc: 0.9848
46720/60000 [======================>.......] - ETA: 1s - loss: 0.0487 - acc: 0.9848
47360/60000 [======================>.......] - ETA: 1s - loss: 0.0489 - acc: 0.9848
48000/60000 [=======================>......] - ETA: 1s - loss: 0.0492 - acc: 0.9846
48640/60000 [=======================>......] - ETA: 1s - loss: 0.0491 - acc: 0.9847
49280/60000 [=======================>......] - ETA: 0s - loss: 0.0491 - acc: 0.9847
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0499 - acc: 0.9847
50560/60000 [========================>.....] - ETA: 0s - loss: 0.0500 - acc: 0.9847
51072/60000 [========================>.....] - ETA: 0s - loss: 0.0498 - acc: 0.9847
51712/60000 [========================>.....] - ETA: 0s - loss: 0.0499 - acc: 0.9848
52352/60000 [=========================>....] - ETA: 0s - loss: 0.0498 - acc: 0.9848
52992/60000 [=========================>....] - ETA: 0s - loss: 0.0499 - acc: 0.9847
53632/60000 [=========================>....] - ETA: 0s - loss: 0.0499 - acc: 0.9847
54272/60000 [==========================>...] - ETA: 0s - loss: 0.0497 - acc: 0.9847
54912/60000 [==========================>...] - ETA: 0s - loss: 0.0499 - acc: 0.9846
55552/60000 [==========================>...] - ETA: 0s - loss: 0.0506 - acc: 0.9845
56192/60000 [===========================>..] - ETA: 0s - loss: 0.0507 - acc: 0.9846
56832/60000 [===========================>..] - ETA: 0s - loss: 0.0504 - acc: 0.9846
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0506 - acc: 0.9846
58112/60000 [============================>.] - ETA: 0s - loss: 0.0506 - acc: 0.9846
58752/60000 [============================>.] - ETA: 0s - loss: 0.0508 - acc: 0.9845
59392/60000 [============================>.] - ETA: 0s - loss: 0.0508 - acc: 0.9845
60000/60000 [==============================] - 6s 95us/step - loss: 0.0506 - acc: 0.9846 - val_loss: 0.0745 - val_acc: 0.9802
Epoch 6/20

  128/60000 [..............................] - ETA: 5s - loss: 0.0520 - acc: 0.9766
  768/60000 [..............................] - ETA: 5s - loss: 0.0432 - acc: 0.9857
 1408/60000 [..............................] - ETA: 5s - loss: 0.0438 - acc: 0.9886
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0508 - acc: 0.9863
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0554 - acc: 0.9866
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0488 - acc: 0.9877
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0435 - acc: 0.9889
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0441 - acc: 0.9887
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0449 - acc: 0.9880
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0452 - acc: 0.9878
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0431 - acc: 0.9882
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0430 - acc: 0.9884
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0415 - acc: 0.9887
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0403 - acc: 0.9886
 9088/60000 [===>..........................] - ETA: 4s - loss: 0.0419 - acc: 0.9883
 9728/60000 [===>..........................] - ETA: 4s - loss: 0.0413 - acc: 0.9888
10368/60000 [====>.........................] - ETA: 4s - loss: 0.0434 - acc: 0.9883
11008/60000 [====>.........................] - ETA: 4s - loss: 0.0429 - acc: 0.9886
11648/60000 [====>.........................] - ETA: 4s - loss: 0.0411 - acc: 0.9890
12288/60000 [=====>........................] - ETA: 4s - loss: 0.0422 - acc: 0.9885
12928/60000 [=====>........................] - ETA: 4s - loss: 0.0426 - acc: 0.9883
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0434 - acc: 0.9878
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0435 - acc: 0.9878
14848/60000 [======>.......................] - ETA: 4s - loss: 0.0427 - acc: 0.9879
15360/60000 [======>.......................] - ETA: 4s - loss: 0.0430 - acc: 0.9878
16000/60000 [=======>......................] - ETA: 4s - loss: 0.0418 - acc: 0.9882
16640/60000 [=======>......................] - ETA: 3s - loss: 0.0422 - acc: 0.9879
17280/60000 [=======>......................] - ETA: 3s - loss: 0.0415 - acc: 0.9880
17920/60000 [=======>......................] - ETA: 3s - loss: 0.0410 - acc: 0.9882
18560/60000 [========>.....................] - ETA: 3s - loss: 0.0406 - acc: 0.9883
19200/60000 [========>.....................] - ETA: 3s - loss: 0.0410 - acc: 0.9882
19840/60000 [========>.....................] - ETA: 3s - loss: 0.0402 - acc: 0.9884
20480/60000 [=========>....................] - ETA: 3s - loss: 0.0407 - acc: 0.9882
21120/60000 [=========>....................] - ETA: 3s - loss: 0.0406 - acc: 0.9881
21760/60000 [=========>....................] - ETA: 3s - loss: 0.0419 - acc: 0.9877
22400/60000 [==========>...................] - ETA: 3s - loss: 0.0423 - acc: 0.9876
23040/60000 [==========>...................] - ETA: 3s - loss: 0.0423 - acc: 0.9875
23680/60000 [==========>...................] - ETA: 3s - loss: 0.0417 - acc: 0.9877
24320/60000 [===========>..................] - ETA: 3s - loss: 0.0421 - acc: 0.9876
24960/60000 [===========>..................] - ETA: 3s - loss: 0.0417 - acc: 0.9877
25600/60000 [===========>..................] - ETA: 3s - loss: 0.0418 - acc: 0.9878
26240/60000 [============>.................] - ETA: 3s - loss: 0.0414 - acc: 0.9878
26880/60000 [============>.................] - ETA: 3s - loss: 0.0420 - acc: 0.9876
27520/60000 [============>.................] - ETA: 2s - loss: 0.0424 - acc: 0.9875
28160/60000 [=============>................] - ETA: 2s - loss: 0.0424 - acc: 0.9874
28800/60000 [=============>................] - ETA: 2s - loss: 0.0425 - acc: 0.9874
29312/60000 [=============>................] - ETA: 2s - loss: 0.0423 - acc: 0.9874
29952/60000 [=============>................] - ETA: 2s - loss: 0.0420 - acc: 0.9875
30592/60000 [==============>...............] - ETA: 2s - loss: 0.0420 - acc: 0.9874
31232/60000 [==============>...............] - ETA: 2s - loss: 0.0424 - acc: 0.9874
31872/60000 [==============>...............] - ETA: 2s - loss: 0.0419 - acc: 0.9875
32512/60000 [===============>..............] - ETA: 2s - loss: 0.0421 - acc: 0.9875
33152/60000 [===============>..............] - ETA: 2s - loss: 0.0418 - acc: 0.9876
33792/60000 [===============>..............] - ETA: 2s - loss: 0.0419 - acc: 0.9876
34432/60000 [================>.............] - ETA: 2s - loss: 0.0426 - acc: 0.9875
35072/60000 [================>.............] - ETA: 2s - loss: 0.0426 - acc: 0.9875
35712/60000 [================>.............] - ETA: 2s - loss: 0.0429 - acc: 0.9874
36352/60000 [=================>............] - ETA: 2s - loss: 0.0431 - acc: 0.9873
36992/60000 [=================>............] - ETA: 2s - loss: 0.0430 - acc: 0.9873
37632/60000 [=================>............] - ETA: 2s - loss: 0.0440 - acc: 0.9870
38272/60000 [==================>...........] - ETA: 1s - loss: 0.0439 - acc: 0.9870
38912/60000 [==================>...........] - ETA: 1s - loss: 0.0444 - acc: 0.9870
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0446 - acc: 0.9869
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0444 - acc: 0.9870
40704/60000 [===================>..........] - ETA: 1s - loss: 0.0447 - acc: 0.9869
41216/60000 [===================>..........] - ETA: 1s - loss: 0.0444 - acc: 0.9869
41856/60000 [===================>..........] - ETA: 1s - loss: 0.0444 - acc: 0.9869
42496/60000 [====================>.........] - ETA: 1s - loss: 0.0439 - acc: 0.9870
43136/60000 [====================>.........] - ETA: 1s - loss: 0.0437 - acc: 0.9871
43776/60000 [====================>.........] - ETA: 1s - loss: 0.0435 - acc: 0.9871
44416/60000 [=====================>........] - ETA: 1s - loss: 0.0433 - acc: 0.9871
45056/60000 [=====================>........] - ETA: 1s - loss: 0.0437 - acc: 0.9871
45696/60000 [=====================>........] - ETA: 1s - loss: 0.0434 - acc: 0.9872
46336/60000 [======================>.......] - ETA: 1s - loss: 0.0432 - acc: 0.9873
46976/60000 [======================>.......] - ETA: 1s - loss: 0.0434 - acc: 0.9872
47616/60000 [======================>.......] - ETA: 1s - loss: 0.0432 - acc: 0.9873
48256/60000 [=======================>......] - ETA: 1s - loss: 0.0430 - acc: 0.9873
48896/60000 [=======================>......] - ETA: 1s - loss: 0.0431 - acc: 0.9873
49536/60000 [=======================>......] - ETA: 0s - loss: 0.0429 - acc: 0.9874
50176/60000 [========================>.....] - ETA: 0s - loss: 0.0427 - acc: 0.9874
50816/60000 [========================>.....] - ETA: 0s - loss: 0.0427 - acc: 0.9873
51456/60000 [========================>.....] - ETA: 0s - loss: 0.0426 - acc: 0.9873
52096/60000 [=========================>....] - ETA: 0s - loss: 0.0426 - acc: 0.9873
52736/60000 [=========================>....] - ETA: 0s - loss: 0.0424 - acc: 0.9873
53376/60000 [=========================>....] - ETA: 0s - loss: 0.0423 - acc: 0.9873
53888/60000 [=========================>....] - ETA: 0s - loss: 0.0424 - acc: 0.9874
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0425 - acc: 0.9874
55040/60000 [==========================>...] - ETA: 0s - loss: 0.0425 - acc: 0.9874
55680/60000 [==========================>...] - ETA: 0s - loss: 0.0425 - acc: 0.9874
56320/60000 [===========================>..] - ETA: 0s - loss: 0.0428 - acc: 0.9874
56960/60000 [===========================>..] - ETA: 0s - loss: 0.0429 - acc: 0.9873
57600/60000 [===========================>..] - ETA: 0s - loss: 0.0428 - acc: 0.9874
58240/60000 [============================>.] - ETA: 0s - loss: 0.0433 - acc: 0.9873
58880/60000 [============================>.] - ETA: 0s - loss: 0.0434 - acc: 0.9873
59520/60000 [============================>.] - ETA: 0s - loss: 0.0436 - acc: 0.9873
60000/60000 [==============================] - 6s 95us/step - loss: 0.0435 - acc: 0.9873 - val_loss: 0.0768 - val_acc: 0.9796
Epoch 7/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0159 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0261 - acc: 0.9974
 1408/60000 [..............................] - ETA: 5s - loss: 0.0311 - acc: 0.9901
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0302 - acc: 0.9902
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0294 - acc: 0.9914
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0286 - acc: 0.9916
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0292 - acc: 0.9914
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0274 - acc: 0.9915
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0267 - acc: 0.9912
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0275 - acc: 0.9913
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0276 - acc: 0.9910
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0284 - acc: 0.9907
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0272 - acc: 0.9909
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0278 - acc: 0.9905
 9088/60000 [===>..........................] - ETA: 4s - loss: 0.0272 - acc: 0.9905
 9728/60000 [===>..........................] - ETA: 4s - loss: 0.0280 - acc: 0.9903
10240/60000 [====>.........................] - ETA: 4s - loss: 0.0285 - acc: 0.9904
10752/60000 [====>.........................] - ETA: 4s - loss: 0.0291 - acc: 0.9901
11392/60000 [====>.........................] - ETA: 4s - loss: 0.0312 - acc: 0.9896
12032/60000 [=====>........................] - ETA: 4s - loss: 0.0306 - acc: 0.9897
12672/60000 [=====>........................] - ETA: 4s - loss: 0.0308 - acc: 0.9896
13312/60000 [=====>........................] - ETA: 4s - loss: 0.0302 - acc: 0.9898
13952/60000 [=====>........................] - ETA: 4s - loss: 0.0316 - acc: 0.9894
14592/60000 [======>.......................] - ETA: 4s - loss: 0.0311 - acc: 0.9894
15232/60000 [======>.......................] - ETA: 4s - loss: 0.0313 - acc: 0.9893
15872/60000 [======>.......................] - ETA: 4s - loss: 0.0314 - acc: 0.9894
16384/60000 [=======>......................] - ETA: 3s - loss: 0.0319 - acc: 0.9890
17024/60000 [=======>......................] - ETA: 3s - loss: 0.0323 - acc: 0.9888
17536/60000 [=======>......................] - ETA: 3s - loss: 0.0325 - acc: 0.9889
18176/60000 [========>.....................] - ETA: 3s - loss: 0.0324 - acc: 0.9891
18816/60000 [========>.....................] - ETA: 3s - loss: 0.0328 - acc: 0.9890
19456/60000 [========>.....................] - ETA: 3s - loss: 0.0332 - acc: 0.9891
20096/60000 [=========>....................] - ETA: 3s - loss: 0.0332 - acc: 0.9890
20608/60000 [=========>....................] - ETA: 3s - loss: 0.0331 - acc: 0.9890
21248/60000 [=========>....................] - ETA: 3s - loss: 0.0329 - acc: 0.9892
21888/60000 [=========>....................] - ETA: 3s - loss: 0.0329 - acc: 0.9894
22528/60000 [==========>...................] - ETA: 3s - loss: 0.0341 - acc: 0.9892
23168/60000 [==========>...................] - ETA: 3s - loss: 0.0343 - acc: 0.9891
23808/60000 [==========>...................] - ETA: 3s - loss: 0.0346 - acc: 0.9891
24320/60000 [===========>..................] - ETA: 3s - loss: 0.0342 - acc: 0.9892
24960/60000 [===========>..................] - ETA: 3s - loss: 0.0337 - acc: 0.9893
25600/60000 [===========>..................] - ETA: 3s - loss: 0.0334 - acc: 0.9894
26240/60000 [============>.................] - ETA: 3s - loss: 0.0336 - acc: 0.9893
26880/60000 [============>.................] - ETA: 3s - loss: 0.0336 - acc: 0.9893
27520/60000 [============>.................] - ETA: 3s - loss: 0.0336 - acc: 0.9893
28032/60000 [=============>................] - ETA: 2s - loss: 0.0342 - acc: 0.9891
28672/60000 [=============>................] - ETA: 2s - loss: 0.0343 - acc: 0.9890
29184/60000 [=============>................] - ETA: 2s - loss: 0.0352 - acc: 0.9889
29696/60000 [=============>................] - ETA: 2s - loss: 0.0351 - acc: 0.9890
30336/60000 [==============>...............] - ETA: 2s - loss: 0.0351 - acc: 0.9889
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0353 - acc: 0.9888
31616/60000 [==============>...............] - ETA: 2s - loss: 0.0358 - acc: 0.9887
32256/60000 [===============>..............] - ETA: 2s - loss: 0.0354 - acc: 0.9888
32896/60000 [===============>..............] - ETA: 2s - loss: 0.0350 - acc: 0.9889
33536/60000 [===============>..............] - ETA: 2s - loss: 0.0351 - acc: 0.9888
34176/60000 [================>.............] - ETA: 2s - loss: 0.0352 - acc: 0.9887
34816/60000 [================>.............] - ETA: 2s - loss: 0.0356 - acc: 0.9886
35456/60000 [================>.............] - ETA: 2s - loss: 0.0355 - acc: 0.9886
36096/60000 [=================>............] - ETA: 2s - loss: 0.0359 - acc: 0.9884
36736/60000 [=================>............] - ETA: 2s - loss: 0.0358 - acc: 0.9885
37376/60000 [=================>............] - ETA: 2s - loss: 0.0358 - acc: 0.9886
38016/60000 [==================>...........] - ETA: 2s - loss: 0.0356 - acc: 0.9886
38656/60000 [==================>...........] - ETA: 1s - loss: 0.0354 - acc: 0.9887
39296/60000 [==================>...........] - ETA: 1s - loss: 0.0355 - acc: 0.9886
39936/60000 [==================>...........] - ETA: 1s - loss: 0.0353 - acc: 0.9886
40576/60000 [===================>..........] - ETA: 1s - loss: 0.0354 - acc: 0.9887
41216/60000 [===================>..........] - ETA: 1s - loss: 0.0357 - acc: 0.9887
41856/60000 [===================>..........] - ETA: 1s - loss: 0.0357 - acc: 0.9887
42368/60000 [====================>.........] - ETA: 1s - loss: 0.0358 - acc: 0.9886
43008/60000 [====================>.........] - ETA: 1s - loss: 0.0365 - acc: 0.9886
43648/60000 [====================>.........] - ETA: 1s - loss: 0.0367 - acc: 0.9886
44288/60000 [=====================>........] - ETA: 1s - loss: 0.0376 - acc: 0.9884
44928/60000 [=====================>........] - ETA: 1s - loss: 0.0374 - acc: 0.9884
45568/60000 [=====================>........] - ETA: 1s - loss: 0.0376 - acc: 0.9884
46208/60000 [======================>.......] - ETA: 1s - loss: 0.0377 - acc: 0.9884
46848/60000 [======================>.......] - ETA: 1s - loss: 0.0375 - acc: 0.9884
47488/60000 [======================>.......] - ETA: 1s - loss: 0.0375 - acc: 0.9885
48128/60000 [=======================>......] - ETA: 1s - loss: 0.0378 - acc: 0.9884
48768/60000 [=======================>......] - ETA: 1s - loss: 0.0381 - acc: 0.9885
49408/60000 [=======================>......] - ETA: 0s - loss: 0.0381 - acc: 0.9885
50048/60000 [========================>.....] - ETA: 0s - loss: 0.0383 - acc: 0.9884
50688/60000 [========================>.....] - ETA: 0s - loss: 0.0382 - acc: 0.9885
51328/60000 [========================>.....] - ETA: 0s - loss: 0.0383 - acc: 0.9884
51968/60000 [========================>.....] - ETA: 0s - loss: 0.0383 - acc: 0.9884
52608/60000 [=========================>....] - ETA: 0s - loss: 0.0381 - acc: 0.9885
53248/60000 [=========================>....] - ETA: 0s - loss: 0.0379 - acc: 0.9885
53888/60000 [=========================>....] - ETA: 0s - loss: 0.0377 - acc: 0.9886
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0381 - acc: 0.9885
54912/60000 [==========================>...] - ETA: 0s - loss: 0.0382 - acc: 0.9885
55552/60000 [==========================>...] - ETA: 0s - loss: 0.0383 - acc: 0.9884
56192/60000 [===========================>..] - ETA: 0s - loss: 0.0384 - acc: 0.9884
56832/60000 [===========================>..] - ETA: 0s - loss: 0.0386 - acc: 0.9882
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0388 - acc: 0.9882
58112/60000 [============================>.] - ETA: 0s - loss: 0.0389 - acc: 0.9882
58752/60000 [============================>.] - ETA: 0s - loss: 0.0393 - acc: 0.9881
59392/60000 [============================>.] - ETA: 0s - loss: 0.0392 - acc: 0.9882
60000/60000 [==============================] - 6s 96us/step - loss: 0.0391 - acc: 0.9882 - val_loss: 0.0877 - val_acc: 0.9779
Epoch 8/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0038 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0206 - acc: 0.9896
 1408/60000 [..............................] - ETA: 5s - loss: 0.0224 - acc: 0.9908
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0289 - acc: 0.9888
 2560/60000 [>.............................] - ETA: 5s - loss: 0.0330 - acc: 0.9883
 3072/60000 [>.............................] - ETA: 5s - loss: 0.0328 - acc: 0.9886
 3712/60000 [>.............................] - ETA: 5s - loss: 0.0294 - acc: 0.9900
 4352/60000 [=>............................] - ETA: 5s - loss: 0.0326 - acc: 0.9901
 4992/60000 [=>............................] - ETA: 5s - loss: 0.0341 - acc: 0.9908
 5632/60000 [=>............................] - ETA: 5s - loss: 0.0321 - acc: 0.9911
 6144/60000 [==>...........................] - ETA: 5s - loss: 0.0320 - acc: 0.9912
 6784/60000 [==>...........................] - ETA: 5s - loss: 0.0341 - acc: 0.9903
 7424/60000 [==>...........................] - ETA: 4s - loss: 0.0327 - acc: 0.9906
 8064/60000 [===>..........................] - ETA: 4s - loss: 0.0324 - acc: 0.9907
 8704/60000 [===>..........................] - ETA: 4s - loss: 0.0313 - acc: 0.9909
 9344/60000 [===>..........................] - ETA: 4s - loss: 0.0313 - acc: 0.9906
 9984/60000 [===>..........................] - ETA: 4s - loss: 0.0312 - acc: 0.9907
10624/60000 [====>.........................] - ETA: 4s - loss: 0.0311 - acc: 0.9906
11264/60000 [====>.........................] - ETA: 4s - loss: 0.0303 - acc: 0.9909
11904/60000 [====>.........................] - ETA: 4s - loss: 0.0325 - acc: 0.9903
12416/60000 [=====>........................] - ETA: 4s - loss: 0.0314 - acc: 0.9905
12928/60000 [=====>........................] - ETA: 4s - loss: 0.0310 - acc: 0.9906
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0320 - acc: 0.9905
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0329 - acc: 0.9903
14720/60000 [======>.......................] - ETA: 4s - loss: 0.0322 - acc: 0.9904
15360/60000 [======>.......................] - ETA: 4s - loss: 0.0335 - acc: 0.9900
16000/60000 [=======>......................] - ETA: 4s - loss: 0.0333 - acc: 0.9901
16640/60000 [=======>......................] - ETA: 4s - loss: 0.0331 - acc: 0.9901
17280/60000 [=======>......................] - ETA: 4s - loss: 0.0330 - acc: 0.9901
17792/60000 [=======>......................] - ETA: 3s - loss: 0.0324 - acc: 0.9902
18432/60000 [========>.....................] - ETA: 3s - loss: 0.0327 - acc: 0.9902
19072/60000 [========>.....................] - ETA: 3s - loss: 0.0330 - acc: 0.9902
19712/60000 [========>.....................] - ETA: 3s - loss: 0.0336 - acc: 0.9902
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0345 - acc: 0.9899
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0354 - acc: 0.9898
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0360 - acc: 0.9896
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0363 - acc: 0.9896
22912/60000 [==========>...................] - ETA: 3s - loss: 0.0361 - acc: 0.9895
23552/60000 [==========>...................] - ETA: 3s - loss: 0.0360 - acc: 0.9894
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0363 - acc: 0.9892
24704/60000 [===========>..................] - ETA: 3s - loss: 0.0361 - acc: 0.9892
25216/60000 [===========>..................] - ETA: 3s - loss: 0.0359 - acc: 0.9892
25728/60000 [===========>..................] - ETA: 3s - loss: 0.0357 - acc: 0.9892
26240/60000 [============>.................] - ETA: 3s - loss: 0.0354 - acc: 0.9893
26752/60000 [============>.................] - ETA: 3s - loss: 0.0356 - acc: 0.9893
27392/60000 [============>.................] - ETA: 3s - loss: 0.0351 - acc: 0.9894
28032/60000 [=============>................] - ETA: 3s - loss: 0.0362 - acc: 0.9892
28672/60000 [=============>................] - ETA: 2s - loss: 0.0360 - acc: 0.9892
29312/60000 [=============>................] - ETA: 2s - loss: 0.0358 - acc: 0.9892
29824/60000 [=============>................] - ETA: 2s - loss: 0.0359 - acc: 0.9892
30336/60000 [==============>...............] - ETA: 2s - loss: 0.0359 - acc: 0.9892
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0359 - acc: 0.9892
31616/60000 [==============>...............] - ETA: 2s - loss: 0.0359 - acc: 0.9892
32256/60000 [===============>..............] - ETA: 2s - loss: 0.0360 - acc: 0.9892
32896/60000 [===============>..............] - ETA: 2s - loss: 0.0363 - acc: 0.9891
33408/60000 [===============>..............] - ETA: 2s - loss: 0.0366 - acc: 0.9890
34048/60000 [================>.............] - ETA: 2s - loss: 0.0363 - acc: 0.9892
34688/60000 [================>.............] - ETA: 2s - loss: 0.0359 - acc: 0.9893
35328/60000 [================>.............] - ETA: 2s - loss: 0.0359 - acc: 0.9893
35968/60000 [================>.............] - ETA: 2s - loss: 0.0362 - acc: 0.9892
36608/60000 [=================>............] - ETA: 2s - loss: 0.0366 - acc: 0.9891
37120/60000 [=================>............] - ETA: 2s - loss: 0.0369 - acc: 0.9891
37632/60000 [=================>............] - ETA: 2s - loss: 0.0368 - acc: 0.9891
38144/60000 [==================>...........] - ETA: 2s - loss: 0.0365 - acc: 0.9892
38656/60000 [==================>...........] - ETA: 2s - loss: 0.0366 - acc: 0.9892
39168/60000 [==================>...........] - ETA: 1s - loss: 0.0362 - acc: 0.9893
39808/60000 [==================>...........] - ETA: 1s - loss: 0.0362 - acc: 0.9893
40320/60000 [===================>..........] - ETA: 1s - loss: 0.0363 - acc: 0.9892
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0360 - acc: 0.9893
41344/60000 [===================>..........] - ETA: 1s - loss: 0.0361 - acc: 0.9893
41856/60000 [===================>..........] - ETA: 1s - loss: 0.0359 - acc: 0.9894
42240/60000 [====================>.........] - ETA: 1s - loss: 0.0359 - acc: 0.9894
42880/60000 [====================>.........] - ETA: 1s - loss: 0.0362 - acc: 0.9893
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0363 - acc: 0.9894
43904/60000 [====================>.........] - ETA: 1s - loss: 0.0362 - acc: 0.9894
44416/60000 [=====================>........] - ETA: 1s - loss: 0.0360 - acc: 0.9895
45056/60000 [=====================>........] - ETA: 1s - loss: 0.0357 - acc: 0.9895
45568/60000 [=====================>........] - ETA: 1s - loss: 0.0357 - acc: 0.9895
46080/60000 [======================>.......] - ETA: 1s - loss: 0.0355 - acc: 0.9895
46592/60000 [======================>.......] - ETA: 1s - loss: 0.0354 - acc: 0.9896
47104/60000 [======================>.......] - ETA: 1s - loss: 0.0352 - acc: 0.9896
47616/60000 [======================>.......] - ETA: 1s - loss: 0.0351 - acc: 0.9896
48128/60000 [=======================>......] - ETA: 1s - loss: 0.0351 - acc: 0.9896
48640/60000 [=======================>......] - ETA: 1s - loss: 0.0353 - acc: 0.9895
49152/60000 [=======================>......] - ETA: 1s - loss: 0.0355 - acc: 0.9895
49664/60000 [=======================>......] - ETA: 1s - loss: 0.0357 - acc: 0.9895
50176/60000 [========================>.....] - ETA: 0s - loss: 0.0356 - acc: 0.9895
50688/60000 [========================>.....] - ETA: 0s - loss: 0.0355 - acc: 0.9895
51200/60000 [========================>.....] - ETA: 0s - loss: 0.0353 - acc: 0.9896
51712/60000 [========================>.....] - ETA: 0s - loss: 0.0351 - acc: 0.9897
52224/60000 [=========================>....] - ETA: 0s - loss: 0.0349 - acc: 0.9897
52736/60000 [=========================>....] - ETA: 0s - loss: 0.0349 - acc: 0.9897
53248/60000 [=========================>....] - ETA: 0s - loss: 0.0348 - acc: 0.9898
53888/60000 [=========================>....] - ETA: 0s - loss: 0.0350 - acc: 0.9898
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0348 - acc: 0.9898
54912/60000 [==========================>...] - ETA: 0s - loss: 0.0347 - acc: 0.9899
55552/60000 [==========================>...] - ETA: 0s - loss: 0.0350 - acc: 0.9897
56064/60000 [===========================>..] - ETA: 0s - loss: 0.0352 - acc: 0.9897
56576/60000 [===========================>..] - ETA: 0s - loss: 0.0349 - acc: 0.9898
57088/60000 [===========================>..] - ETA: 0s - loss: 0.0348 - acc: 0.9898
57728/60000 [===========================>..] - ETA: 0s - loss: 0.0350 - acc: 0.9898
58240/60000 [============================>.] - ETA: 0s - loss: 0.0350 - acc: 0.9897
58880/60000 [============================>.] - ETA: 0s - loss: 0.0350 - acc: 0.9898
59392/60000 [============================>.] - ETA: 0s - loss: 0.0352 - acc: 0.9897
59904/60000 [============================>.] - ETA: 0s - loss: 0.0353 - acc: 0.9897
60000/60000 [==============================] - 6s 104us/step - loss: 0.0352 - acc: 0.9897 - val_loss: 0.0820 - val_acc: 0.9815
Epoch 9/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0209 - acc: 0.9922
  768/60000 [..............................] - ETA: 5s - loss: 0.0160 - acc: 0.9922
 1280/60000 [..............................] - ETA: 5s - loss: 0.0188 - acc: 0.9922
 1920/60000 [..............................] - ETA: 5s - loss: 0.0171 - acc: 0.9922
 2432/60000 [>.............................] - ETA: 5s - loss: 0.0222 - acc: 0.9922
 2944/60000 [>.............................] - ETA: 5s - loss: 0.0230 - acc: 0.9912
 3456/60000 [>.............................] - ETA: 5s - loss: 0.0351 - acc: 0.9905
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0337 - acc: 0.9907
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0317 - acc: 0.9911
 5120/60000 [=>............................] - ETA: 5s - loss: 0.0290 - acc: 0.9920
 5632/60000 [=>............................] - ETA: 5s - loss: 0.0309 - acc: 0.9917
 6016/60000 [==>...........................] - ETA: 5s - loss: 0.0308 - acc: 0.9915
 6528/60000 [==>...........................] - ETA: 5s - loss: 0.0291 - acc: 0.9919
 7168/60000 [==>...........................] - ETA: 5s - loss: 0.0285 - acc: 0.9922
 7808/60000 [==>...........................] - ETA: 5s - loss: 0.0278 - acc: 0.9924
 8320/60000 [===>..........................] - ETA: 5s - loss: 0.0271 - acc: 0.9927
 8704/60000 [===>..........................] - ETA: 5s - loss: 0.0269 - acc: 0.9928
 9216/60000 [===>..........................] - ETA: 5s - loss: 0.0259 - acc: 0.9929
 9728/60000 [===>..........................] - ETA: 5s - loss: 0.0262 - acc: 0.9929
10240/60000 [====>.........................] - ETA: 5s - loss: 0.0263 - acc: 0.9927
10752/60000 [====>.........................] - ETA: 5s - loss: 0.0263 - acc: 0.9927
11392/60000 [====>.........................] - ETA: 5s - loss: 0.0254 - acc: 0.9928
11904/60000 [====>.........................] - ETA: 5s - loss: 0.0270 - acc: 0.9925
12416/60000 [=====>........................] - ETA: 5s - loss: 0.0268 - acc: 0.9923
12928/60000 [=====>........................] - ETA: 5s - loss: 0.0260 - acc: 0.9926
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0258 - acc: 0.9925
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0256 - acc: 0.9925
14848/60000 [======>.......................] - ETA: 4s - loss: 0.0260 - acc: 0.9924
15360/60000 [======>.......................] - ETA: 4s - loss: 0.0259 - acc: 0.9924
16000/60000 [=======>......................] - ETA: 4s - loss: 0.0258 - acc: 0.9924
16640/60000 [=======>......................] - ETA: 4s - loss: 0.0258 - acc: 0.9923
17152/60000 [=======>......................] - ETA: 4s - loss: 0.0260 - acc: 0.9923
17792/60000 [=======>......................] - ETA: 4s - loss: 0.0258 - acc: 0.9923
18432/60000 [========>.....................] - ETA: 4s - loss: 0.0256 - acc: 0.9922
19072/60000 [========>.....................] - ETA: 4s - loss: 0.0255 - acc: 0.9923
19584/60000 [========>.....................] - ETA: 4s - loss: 0.0253 - acc: 0.9923
20096/60000 [=========>....................] - ETA: 4s - loss: 0.0252 - acc: 0.9923
20608/60000 [=========>....................] - ETA: 4s - loss: 0.0254 - acc: 0.9923
21120/60000 [=========>....................] - ETA: 4s - loss: 0.0262 - acc: 0.9921
21760/60000 [=========>....................] - ETA: 3s - loss: 0.0277 - acc: 0.9917
22400/60000 [==========>...................] - ETA: 3s - loss: 0.0283 - acc: 0.9917
23040/60000 [==========>...................] - ETA: 3s - loss: 0.0278 - acc: 0.9919
23552/60000 [==========>...................] - ETA: 3s - loss: 0.0274 - acc: 0.9920
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0283 - acc: 0.9918
24576/60000 [===========>..................] - ETA: 3s - loss: 0.0293 - acc: 0.9916
25088/60000 [===========>..................] - ETA: 3s - loss: 0.0291 - acc: 0.9917
25600/60000 [===========>..................] - ETA: 3s - loss: 0.0288 - acc: 0.9917
26240/60000 [============>.................] - ETA: 3s - loss: 0.0291 - acc: 0.9916
26752/60000 [============>.................] - ETA: 3s - loss: 0.0290 - acc: 0.9916
27392/60000 [============>.................] - ETA: 3s - loss: 0.0287 - acc: 0.9917
27904/60000 [============>.................] - ETA: 3s - loss: 0.0286 - acc: 0.9917
28416/60000 [=============>................] - ETA: 3s - loss: 0.0287 - acc: 0.9916
28928/60000 [=============>................] - ETA: 3s - loss: 0.0290 - acc: 0.9915
29568/60000 [=============>................] - ETA: 3s - loss: 0.0288 - acc: 0.9915
30208/60000 [==============>...............] - ETA: 3s - loss: 0.0287 - acc: 0.9916
30848/60000 [==============>...............] - ETA: 2s - loss: 0.0287 - acc: 0.9916
31488/60000 [==============>...............] - ETA: 2s - loss: 0.0287 - acc: 0.9916
32128/60000 [===============>..............] - ETA: 2s - loss: 0.0288 - acc: 0.9915
32768/60000 [===============>..............] - ETA: 2s - loss: 0.0288 - acc: 0.9915
33408/60000 [===============>..............] - ETA: 2s - loss: 0.0288 - acc: 0.9916
34048/60000 [================>.............] - ETA: 2s - loss: 0.0290 - acc: 0.9915
34688/60000 [================>.............] - ETA: 2s - loss: 0.0293 - acc: 0.9914
35328/60000 [================>.............] - ETA: 2s - loss: 0.0298 - acc: 0.9913
35968/60000 [================>.............] - ETA: 2s - loss: 0.0295 - acc: 0.9914
36480/60000 [=================>............] - ETA: 2s - loss: 0.0294 - acc: 0.9914
36992/60000 [=================>............] - ETA: 2s - loss: 0.0293 - acc: 0.9914
37632/60000 [=================>............] - ETA: 2s - loss: 0.0294 - acc: 0.9914
38272/60000 [==================>...........] - ETA: 2s - loss: 0.0293 - acc: 0.9914
38912/60000 [==================>...........] - ETA: 2s - loss: 0.0293 - acc: 0.9913
39424/60000 [==================>...........] - ETA: 2s - loss: 0.0291 - acc: 0.9914
40064/60000 [===================>..........] - ETA: 2s - loss: 0.0290 - acc: 0.9914
40576/60000 [===================>..........] - ETA: 1s - loss: 0.0291 - acc: 0.9914
41216/60000 [===================>..........] - ETA: 1s - loss: 0.0293 - acc: 0.9913
41856/60000 [===================>..........] - ETA: 1s - loss: 0.0293 - acc: 0.9913
42368/60000 [====================>.........] - ETA: 1s - loss: 0.0298 - acc: 0.9911
42880/60000 [====================>.........] - ETA: 1s - loss: 0.0297 - acc: 0.9912
43520/60000 [====================>.........] - ETA: 1s - loss: 0.0296 - acc: 0.9912
44160/60000 [=====================>........] - ETA: 1s - loss: 0.0298 - acc: 0.9911
44800/60000 [=====================>........] - ETA: 1s - loss: 0.0299 - acc: 0.9912
45440/60000 [=====================>........] - ETA: 1s - loss: 0.0296 - acc: 0.9912
46080/60000 [======================>.......] - ETA: 1s - loss: 0.0296 - acc: 0.9913
46720/60000 [======================>.......] - ETA: 1s - loss: 0.0301 - acc: 0.9912
47360/60000 [======================>.......] - ETA: 1s - loss: 0.0303 - acc: 0.9911
47872/60000 [======================>.......] - ETA: 1s - loss: 0.0306 - acc: 0.9910
48384/60000 [=======================>......] - ETA: 1s - loss: 0.0304 - acc: 0.9911
48896/60000 [=======================>......] - ETA: 1s - loss: 0.0302 - acc: 0.9911
49408/60000 [=======================>......] - ETA: 1s - loss: 0.0300 - acc: 0.9912
49920/60000 [=======================>......] - ETA: 1s - loss: 0.0299 - acc: 0.9912
50560/60000 [========================>.....] - ETA: 0s - loss: 0.0300 - acc: 0.9911
51072/60000 [========================>.....] - ETA: 0s - loss: 0.0299 - acc: 0.9911
51712/60000 [========================>.....] - ETA: 0s - loss: 0.0299 - acc: 0.9911
52352/60000 [=========================>....] - ETA: 0s - loss: 0.0300 - acc: 0.9912
52992/60000 [=========================>....] - ETA: 0s - loss: 0.0302 - acc: 0.9911
53632/60000 [=========================>....] - ETA: 0s - loss: 0.0309 - acc: 0.9911
54272/60000 [==========================>...] - ETA: 0s - loss: 0.0314 - acc: 0.9909
54784/60000 [==========================>...] - ETA: 0s - loss: 0.0313 - acc: 0.9909
55424/60000 [==========================>...] - ETA: 0s - loss: 0.0313 - acc: 0.9909
56064/60000 [===========================>..] - ETA: 0s - loss: 0.0312 - acc: 0.9910
56704/60000 [===========================>..] - ETA: 0s - loss: 0.0312 - acc: 0.9909
57344/60000 [===========================>..] - ETA: 0s - loss: 0.0314 - acc: 0.9909
57984/60000 [===========================>..] - ETA: 0s - loss: 0.0311 - acc: 0.9910
58624/60000 [============================>.] - ETA: 0s - loss: 0.0310 - acc: 0.9910
59264/60000 [============================>.] - ETA: 0s - loss: 0.0311 - acc: 0.9910
59776/60000 [============================>.] - ETA: 0s - loss: 0.0310 - acc: 0.9910
60000/60000 [==============================] - 6s 103us/step - loss: 0.0312 - acc: 0.9910 - val_loss: 0.1010 - val_acc: 0.9786
Epoch 10/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0410 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0402 - acc: 0.9909
 1408/60000 [..............................] - ETA: 5s - loss: 0.0278 - acc: 0.9929
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0273 - acc: 0.9927
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0323 - acc: 0.9918
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0308 - acc: 0.9910
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0288 - acc: 0.9917
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0266 - acc: 0.9924
 5248/60000 [=>............................] - ETA: 5s - loss: 0.0272 - acc: 0.9920
 5888/60000 [=>............................] - ETA: 5s - loss: 0.0277 - acc: 0.9918
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0264 - acc: 0.9920
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0255 - acc: 0.9923
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0267 - acc: 0.9917
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0258 - acc: 0.9921
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0245 - acc: 0.9923
 9600/60000 [===>..........................] - ETA: 4s - loss: 0.0240 - acc: 0.9923
10112/60000 [====>.........................] - ETA: 4s - loss: 0.0248 - acc: 0.9920
10624/60000 [====>.........................] - ETA: 4s - loss: 0.0245 - acc: 0.9920
11136/60000 [====>.........................] - ETA: 4s - loss: 0.0255 - acc: 0.9916
11648/60000 [====>.........................] - ETA: 4s - loss: 0.0253 - acc: 0.9915
12288/60000 [=====>........................] - ETA: 4s - loss: 0.0256 - acc: 0.9914
12928/60000 [=====>........................] - ETA: 4s - loss: 0.0266 - acc: 0.9910
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0257 - acc: 0.9913
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0251 - acc: 0.9915
14848/60000 [======>.......................] - ETA: 4s - loss: 0.0249 - acc: 0.9917
15488/60000 [======>.......................] - ETA: 4s - loss: 0.0248 - acc: 0.9917
16128/60000 [=======>......................] - ETA: 4s - loss: 0.0254 - acc: 0.9916
16768/60000 [=======>......................] - ETA: 4s - loss: 0.0254 - acc: 0.9914
17280/60000 [=======>......................] - ETA: 4s - loss: 0.0256 - acc: 0.9914
17920/60000 [=======>......................] - ETA: 4s - loss: 0.0256 - acc: 0.9915
18432/60000 [========>.....................] - ETA: 3s - loss: 0.0253 - acc: 0.9916
19072/60000 [========>.....................] - ETA: 3s - loss: 0.0254 - acc: 0.9917
19712/60000 [========>.....................] - ETA: 3s - loss: 0.0260 - acc: 0.9917
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0266 - acc: 0.9915
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0272 - acc: 0.9914
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0270 - acc: 0.9914
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0270 - acc: 0.9914
22784/60000 [==========>...................] - ETA: 3s - loss: 0.0271 - acc: 0.9914
23296/60000 [==========>...................] - ETA: 3s - loss: 0.0268 - acc: 0.9914
23936/60000 [==========>...................] - ETA: 3s - loss: 0.0267 - acc: 0.9914
24448/60000 [===========>..................] - ETA: 3s - loss: 0.0268 - acc: 0.9913
24960/60000 [===========>..................] - ETA: 3s - loss: 0.0277 - acc: 0.9911
25472/60000 [===========>..................] - ETA: 3s - loss: 0.0279 - acc: 0.9910
25984/60000 [===========>..................] - ETA: 3s - loss: 0.0275 - acc: 0.9911
26496/60000 [============>.................] - ETA: 3s - loss: 0.0274 - acc: 0.9912
27136/60000 [============>.................] - ETA: 3s - loss: 0.0272 - acc: 0.9913
27648/60000 [============>.................] - ETA: 3s - loss: 0.0278 - acc: 0.9912
28160/60000 [=============>................] - ETA: 3s - loss: 0.0277 - acc: 0.9913
28672/60000 [=============>................] - ETA: 3s - loss: 0.0275 - acc: 0.9914
29312/60000 [=============>................] - ETA: 2s - loss: 0.0274 - acc: 0.9914
29952/60000 [=============>................] - ETA: 2s - loss: 0.0271 - acc: 0.9915
30592/60000 [==============>...............] - ETA: 2s - loss: 0.0273 - acc: 0.9916
31232/60000 [==============>...............] - ETA: 2s - loss: 0.0274 - acc: 0.9916
31872/60000 [==============>...............] - ETA: 2s - loss: 0.0275 - acc: 0.9916
32512/60000 [===============>..............] - ETA: 2s - loss: 0.0274 - acc: 0.9917
33152/60000 [===============>..............] - ETA: 2s - loss: 0.0274 - acc: 0.9917
33664/60000 [===============>..............] - ETA: 2s - loss: 0.0276 - acc: 0.9917
34304/60000 [================>.............] - ETA: 2s - loss: 0.0281 - acc: 0.9915
34816/60000 [================>.............] - ETA: 2s - loss: 0.0281 - acc: 0.9916
35328/60000 [================>.............] - ETA: 2s - loss: 0.0283 - acc: 0.9915
35968/60000 [================>.............] - ETA: 2s - loss: 0.0284 - acc: 0.9915
36608/60000 [=================>............] - ETA: 2s - loss: 0.0291 - acc: 0.9913
37248/60000 [=================>............] - ETA: 2s - loss: 0.0292 - acc: 0.9913
37888/60000 [=================>............] - ETA: 2s - loss: 0.0291 - acc: 0.9913
38528/60000 [==================>...........] - ETA: 2s - loss: 0.0292 - acc: 0.9913
39040/60000 [==================>...........] - ETA: 2s - loss: 0.0290 - acc: 0.9914
39680/60000 [==================>...........] - ETA: 1s - loss: 0.0289 - acc: 0.9914
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0289 - acc: 0.9914
40704/60000 [===================>..........] - ETA: 1s - loss: 0.0288 - acc: 0.9915
41216/60000 [===================>..........] - ETA: 1s - loss: 0.0292 - acc: 0.9914
41728/60000 [===================>..........] - ETA: 1s - loss: 0.0290 - acc: 0.9914
42368/60000 [====================>.........] - ETA: 1s - loss: 0.0287 - acc: 0.9915
43008/60000 [====================>.........] - ETA: 1s - loss: 0.0284 - acc: 0.9916
43520/60000 [====================>.........] - ETA: 1s - loss: 0.0284 - acc: 0.9915
44160/60000 [=====================>........] - ETA: 1s - loss: 0.0288 - acc: 0.9914
44800/60000 [=====================>........] - ETA: 1s - loss: 0.0288 - acc: 0.9915
45440/60000 [=====================>........] - ETA: 1s - loss: 0.0286 - acc: 0.9915
46080/60000 [======================>.......] - ETA: 1s - loss: 0.0289 - acc: 0.9915
46592/60000 [======================>.......] - ETA: 1s - loss: 0.0290 - acc: 0.9915
47104/60000 [======================>.......] - ETA: 1s - loss: 0.0290 - acc: 0.9915
47616/60000 [======================>.......] - ETA: 1s - loss: 0.0288 - acc: 0.9915
48256/60000 [=======================>......] - ETA: 1s - loss: 0.0286 - acc: 0.9915
48896/60000 [=======================>......] - ETA: 1s - loss: 0.0292 - acc: 0.9914
49408/60000 [=======================>......] - ETA: 1s - loss: 0.0292 - acc: 0.9914
50048/60000 [========================>.....] - ETA: 0s - loss: 0.0292 - acc: 0.9914
50688/60000 [========================>.....] - ETA: 0s - loss: 0.0296 - acc: 0.9912
51328/60000 [========================>.....] - ETA: 0s - loss: 0.0302 - acc: 0.9911
51968/60000 [========================>.....] - ETA: 0s - loss: 0.0299 - acc: 0.9911
52608/60000 [=========================>....] - ETA: 0s - loss: 0.0299 - acc: 0.9911
53248/60000 [=========================>....] - ETA: 0s - loss: 0.0299 - acc: 0.9911
53760/60000 [=========================>....] - ETA: 0s - loss: 0.0298 - acc: 0.9911
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0300 - acc: 0.9911
55040/60000 [==========================>...] - ETA: 0s - loss: 0.0305 - acc: 0.9910
55680/60000 [==========================>...] - ETA: 0s - loss: 0.0305 - acc: 0.9910
56320/60000 [===========================>..] - ETA: 0s - loss: 0.0304 - acc: 0.9910
56960/60000 [===========================>..] - ETA: 0s - loss: 0.0304 - acc: 0.9909
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0303 - acc: 0.9910
58112/60000 [============================>.] - ETA: 0s - loss: 0.0304 - acc: 0.9909
58624/60000 [============================>.] - ETA: 0s - loss: 0.0304 - acc: 0.9909
59136/60000 [============================>.] - ETA: 0s - loss: 0.0304 - acc: 0.9909
59648/60000 [============================>.] - ETA: 0s - loss: 0.0303 - acc: 0.9909
60000/60000 [==============================] - 6s 101us/step - loss: 0.0306 - acc: 0.9908 - val_loss: 0.1001 - val_acc: 0.9788
Epoch 11/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0357 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0241 - acc: 0.9922
 1408/60000 [..............................] - ETA: 5s - loss: 0.0198 - acc: 0.9950
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0200 - acc: 0.9951
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0219 - acc: 0.9944
 3200/60000 [>.............................] - ETA: 5s - loss: 0.0221 - acc: 0.9941
 3840/60000 [>.............................] - ETA: 5s - loss: 0.0286 - acc: 0.9927
 4480/60000 [=>............................] - ETA: 5s - loss: 0.0258 - acc: 0.9935
 5120/60000 [=>............................] - ETA: 5s - loss: 0.0266 - acc: 0.9932
 5760/60000 [=>............................] - ETA: 5s - loss: 0.0251 - acc: 0.9934
 6400/60000 [==>...........................] - ETA: 5s - loss: 0.0250 - acc: 0.9936
 7040/60000 [==>...........................] - ETA: 4s - loss: 0.0236 - acc: 0.9939
 7680/60000 [==>...........................] - ETA: 4s - loss: 0.0238 - acc: 0.9940
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0228 - acc: 0.9942
 8832/60000 [===>..........................] - ETA: 4s - loss: 0.0241 - acc: 0.9939
 9472/60000 [===>..........................] - ETA: 4s - loss: 0.0236 - acc: 0.9941
10112/60000 [====>.........................] - ETA: 4s - loss: 0.0244 - acc: 0.9939
10752/60000 [====>.........................] - ETA: 4s - loss: 0.0242 - acc: 0.9939
11392/60000 [====>.........................] - ETA: 4s - loss: 0.0236 - acc: 0.9939
12032/60000 [=====>........................] - ETA: 4s - loss: 0.0238 - acc: 0.9938
12672/60000 [=====>........................] - ETA: 4s - loss: 0.0240 - acc: 0.9938
13312/60000 [=====>........................] - ETA: 4s - loss: 0.0237 - acc: 0.9938
13952/60000 [=====>........................] - ETA: 4s - loss: 0.0237 - acc: 0.9938
14592/60000 [======>.......................] - ETA: 4s - loss: 0.0240 - acc: 0.9938
15232/60000 [======>.......................] - ETA: 4s - loss: 0.0244 - acc: 0.9936
15872/60000 [======>.......................] - ETA: 4s - loss: 0.0241 - acc: 0.9936
16512/60000 [=======>......................] - ETA: 4s - loss: 0.0252 - acc: 0.9933
17152/60000 [=======>......................] - ETA: 4s - loss: 0.0264 - acc: 0.9930
17792/60000 [=======>......................] - ETA: 3s - loss: 0.0267 - acc: 0.9929
18304/60000 [========>.....................] - ETA: 3s - loss: 0.0271 - acc: 0.9928
18944/60000 [========>.....................] - ETA: 3s - loss: 0.0270 - acc: 0.9929
19584/60000 [========>.....................] - ETA: 3s - loss: 0.0263 - acc: 0.9930
20224/60000 [=========>....................] - ETA: 3s - loss: 0.0257 - acc: 0.9931
20864/60000 [=========>....................] - ETA: 3s - loss: 0.0257 - acc: 0.9931
21376/60000 [=========>....................] - ETA: 3s - loss: 0.0263 - acc: 0.9928
22016/60000 [==========>...................] - ETA: 3s - loss: 0.0265 - acc: 0.9928
22656/60000 [==========>...................] - ETA: 3s - loss: 0.0267 - acc: 0.9927
23296/60000 [==========>...................] - ETA: 3s - loss: 0.0262 - acc: 0.9927
23936/60000 [==========>...................] - ETA: 3s - loss: 0.0258 - acc: 0.9928
24576/60000 [===========>..................] - ETA: 3s - loss: 0.0258 - acc: 0.9928
25216/60000 [===========>..................] - ETA: 3s - loss: 0.0264 - acc: 0.9927
25856/60000 [===========>..................] - ETA: 3s - loss: 0.0264 - acc: 0.9927
26496/60000 [============>.................] - ETA: 3s - loss: 0.0259 - acc: 0.9928
27136/60000 [============>.................] - ETA: 3s - loss: 0.0258 - acc: 0.9927
27776/60000 [============>.................] - ETA: 3s - loss: 0.0261 - acc: 0.9926
28416/60000 [=============>................] - ETA: 2s - loss: 0.0261 - acc: 0.9926
29056/60000 [=============>................] - ETA: 2s - loss: 0.0256 - acc: 0.9927
29696/60000 [=============>................] - ETA: 2s - loss: 0.0251 - acc: 0.9929
30208/60000 [==============>...............] - ETA: 2s - loss: 0.0248 - acc: 0.9930
30720/60000 [==============>...............] - ETA: 2s - loss: 0.0249 - acc: 0.9929
31360/60000 [==============>...............] - ETA: 2s - loss: 0.0251 - acc: 0.9929
32000/60000 [===============>..............] - ETA: 2s - loss: 0.0251 - acc: 0.9928
32640/60000 [===============>..............] - ETA: 2s - loss: 0.0248 - acc: 0.9929
33280/60000 [===============>..............] - ETA: 2s - loss: 0.0249 - acc: 0.9929
33792/60000 [===============>..............] - ETA: 2s - loss: 0.0248 - acc: 0.9929
34304/60000 [================>.............] - ETA: 2s - loss: 0.0252 - acc: 0.9928
34944/60000 [================>.............] - ETA: 2s - loss: 0.0251 - acc: 0.9928
35584/60000 [================>.............] - ETA: 2s - loss: 0.0248 - acc: 0.9929
36224/60000 [=================>............] - ETA: 2s - loss: 0.0248 - acc: 0.9929
36864/60000 [=================>............] - ETA: 2s - loss: 0.0248 - acc: 0.9928
37504/60000 [=================>............] - ETA: 2s - loss: 0.0255 - acc: 0.9927
38144/60000 [==================>...........] - ETA: 2s - loss: 0.0258 - acc: 0.9926
38784/60000 [==================>...........] - ETA: 1s - loss: 0.0258 - acc: 0.9926
39424/60000 [==================>...........] - ETA: 1s - loss: 0.0259 - acc: 0.9926
40064/60000 [===================>..........] - ETA: 1s - loss: 0.0258 - acc: 0.9926
40704/60000 [===================>..........] - ETA: 1s - loss: 0.0256 - acc: 0.9927
41344/60000 [===================>..........] - ETA: 1s - loss: 0.0256 - acc: 0.9926
41984/60000 [===================>..........] - ETA: 1s - loss: 0.0256 - acc: 0.9926
42624/60000 [====================>.........] - ETA: 1s - loss: 0.0258 - acc: 0.9926
43264/60000 [====================>.........] - ETA: 1s - loss: 0.0256 - acc: 0.9926
43904/60000 [====================>.........] - ETA: 1s - loss: 0.0258 - acc: 0.9926
44544/60000 [=====================>........] - ETA: 1s - loss: 0.0256 - acc: 0.9927
45184/60000 [=====================>........] - ETA: 1s - loss: 0.0256 - acc: 0.9926
45696/60000 [=====================>........] - ETA: 1s - loss: 0.0255 - acc: 0.9926
46208/60000 [======================>.......] - ETA: 1s - loss: 0.0254 - acc: 0.9926
46848/60000 [======================>.......] - ETA: 1s - loss: 0.0254 - acc: 0.9926
47488/60000 [======================>.......] - ETA: 1s - loss: 0.0252 - acc: 0.9926
48128/60000 [=======================>......] - ETA: 1s - loss: 0.0256 - acc: 0.9925
48768/60000 [=======================>......] - ETA: 1s - loss: 0.0257 - acc: 0.9925
49408/60000 [=======================>......] - ETA: 0s - loss: 0.0258 - acc: 0.9925
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0259 - acc: 0.9925
50560/60000 [========================>.....] - ETA: 0s - loss: 0.0260 - acc: 0.9924
51200/60000 [========================>.....] - ETA: 0s - loss: 0.0258 - acc: 0.9925
51840/60000 [========================>.....] - ETA: 0s - loss: 0.0256 - acc: 0.9926
52480/60000 [=========================>....] - ETA: 0s - loss: 0.0254 - acc: 0.9926
53120/60000 [=========================>....] - ETA: 0s - loss: 0.0254 - acc: 0.9926
53760/60000 [=========================>....] - ETA: 0s - loss: 0.0253 - acc: 0.9926
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0251 - acc: 0.9927
55040/60000 [==========================>...] - ETA: 0s - loss: 0.0250 - acc: 0.9927
55680/60000 [==========================>...] - ETA: 0s - loss: 0.0250 - acc: 0.9927
56320/60000 [===========================>..] - ETA: 0s - loss: 0.0258 - acc: 0.9926
56960/60000 [===========================>..] - ETA: 0s - loss: 0.0256 - acc: 0.9926
57600/60000 [===========================>..] - ETA: 0s - loss: 0.0256 - acc: 0.9926
58240/60000 [============================>.] - ETA: 0s - loss: 0.0254 - acc: 0.9927
58880/60000 [============================>.] - ETA: 0s - loss: 0.0253 - acc: 0.9927
59520/60000 [============================>.] - ETA: 0s - loss: 0.0256 - acc: 0.9927
60000/60000 [==============================] - 6s 97us/step - loss: 0.0257 - acc: 0.9927 - val_loss: 0.1000 - val_acc: 0.9813
Epoch 12/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0044 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0177 - acc: 0.9935
 1408/60000 [..............................] - ETA: 5s - loss: 0.0144 - acc: 0.9936
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0211 - acc: 0.9927
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0216 - acc: 0.9926
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0221 - acc: 0.9928
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0270 - acc: 0.9922
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0249 - acc: 0.9926
 5248/60000 [=>............................] - ETA: 5s - loss: 0.0282 - acc: 0.9924
 5888/60000 [=>............................] - ETA: 5s - loss: 0.0289 - acc: 0.9925
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0272 - acc: 0.9926
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0276 - acc: 0.9923
 7680/60000 [==>...........................] - ETA: 4s - loss: 0.0261 - acc: 0.9927
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0250 - acc: 0.9928
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0251 - acc: 0.9929
 9472/60000 [===>..........................] - ETA: 4s - loss: 0.0241 - acc: 0.9931
 9984/60000 [===>..........................] - ETA: 4s - loss: 0.0249 - acc: 0.9929
10624/60000 [====>.........................] - ETA: 4s - loss: 0.0247 - acc: 0.9928
11264/60000 [====>.........................] - ETA: 4s - loss: 0.0254 - acc: 0.9926
11904/60000 [====>.........................] - ETA: 4s - loss: 0.0250 - acc: 0.9926
12544/60000 [=====>........................] - ETA: 4s - loss: 0.0252 - acc: 0.9923
13184/60000 [=====>........................] - ETA: 4s - loss: 0.0252 - acc: 0.9923
13824/60000 [=====>........................] - ETA: 4s - loss: 0.0256 - acc: 0.9923
14464/60000 [======>.......................] - ETA: 4s - loss: 0.0256 - acc: 0.9922
14976/60000 [======>.......................] - ETA: 4s - loss: 0.0252 - acc: 0.9923
15616/60000 [======>.......................] - ETA: 4s - loss: 0.0251 - acc: 0.9923
16128/60000 [=======>......................] - ETA: 4s - loss: 0.0251 - acc: 0.9923
16768/60000 [=======>......................] - ETA: 4s - loss: 0.0254 - acc: 0.9922
17408/60000 [=======>......................] - ETA: 4s - loss: 0.0249 - acc: 0.9923
18048/60000 [========>.....................] - ETA: 3s - loss: 0.0255 - acc: 0.9921
18688/60000 [========>.....................] - ETA: 3s - loss: 0.0260 - acc: 0.9920
19200/60000 [========>.....................] - ETA: 3s - loss: 0.0268 - acc: 0.9919
19840/60000 [========>.....................] - ETA: 3s - loss: 0.0270 - acc: 0.9919
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0267 - acc: 0.9919
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0275 - acc: 0.9918
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0268 - acc: 0.9920
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0264 - acc: 0.9920
22784/60000 [==========>...................] - ETA: 3s - loss: 0.0265 - acc: 0.9920
23424/60000 [==========>...................] - ETA: 3s - loss: 0.0266 - acc: 0.9921
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0265 - acc: 0.9919
24704/60000 [===========>..................] - ETA: 3s - loss: 0.0263 - acc: 0.9919
25344/60000 [===========>..................] - ETA: 3s - loss: 0.0263 - acc: 0.9919
25984/60000 [===========>..................] - ETA: 3s - loss: 0.0263 - acc: 0.9920
26624/60000 [============>.................] - ETA: 3s - loss: 0.0260 - acc: 0.9921
27264/60000 [============>.................] - ETA: 3s - loss: 0.0268 - acc: 0.9920
27904/60000 [============>.................] - ETA: 3s - loss: 0.0263 - acc: 0.9921
28544/60000 [=============>................] - ETA: 2s - loss: 0.0263 - acc: 0.9921
29184/60000 [=============>................] - ETA: 2s - loss: 0.0262 - acc: 0.9921
29824/60000 [=============>................] - ETA: 2s - loss: 0.0262 - acc: 0.9920
30464/60000 [==============>...............] - ETA: 2s - loss: 0.0265 - acc: 0.9919
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0266 - acc: 0.9919
31616/60000 [==============>...............] - ETA: 2s - loss: 0.0267 - acc: 0.9918
32128/60000 [===============>..............] - ETA: 2s - loss: 0.0269 - acc: 0.9919
32768/60000 [===============>..............] - ETA: 2s - loss: 0.0270 - acc: 0.9919
33408/60000 [===============>..............] - ETA: 2s - loss: 0.0266 - acc: 0.9920
33920/60000 [===============>..............] - ETA: 2s - loss: 0.0267 - acc: 0.9919
34432/60000 [================>.............] - ETA: 2s - loss: 0.0266 - acc: 0.9919
34944/60000 [================>.............] - ETA: 2s - loss: 0.0266 - acc: 0.9919
35456/60000 [================>.............] - ETA: 2s - loss: 0.0265 - acc: 0.9920
36096/60000 [=================>............] - ETA: 2s - loss: 0.0264 - acc: 0.9919
36736/60000 [=================>............] - ETA: 2s - loss: 0.0263 - acc: 0.9919
37248/60000 [=================>............] - ETA: 2s - loss: 0.0262 - acc: 0.9919
37760/60000 [=================>............] - ETA: 2s - loss: 0.0263 - acc: 0.9919
38400/60000 [==================>...........] - ETA: 2s - loss: 0.0262 - acc: 0.9919
38912/60000 [==================>...........] - ETA: 2s - loss: 0.0263 - acc: 0.9919
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0262 - acc: 0.9919
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0262 - acc: 0.9919
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0261 - acc: 0.9919
41472/60000 [===================>..........] - ETA: 1s - loss: 0.0261 - acc: 0.9919
41984/60000 [===================>..........] - ETA: 1s - loss: 0.0260 - acc: 0.9919
42624/60000 [====================>.........] - ETA: 1s - loss: 0.0257 - acc: 0.9920
43264/60000 [====================>.........] - ETA: 1s - loss: 0.0260 - acc: 0.9920
43776/60000 [====================>.........] - ETA: 1s - loss: 0.0259 - acc: 0.9920
44416/60000 [=====================>........] - ETA: 1s - loss: 0.0261 - acc: 0.9920
45056/60000 [=====================>........] - ETA: 1s - loss: 0.0261 - acc: 0.9920
45696/60000 [=====================>........] - ETA: 1s - loss: 0.0260 - acc: 0.9920
46336/60000 [======================>.......] - ETA: 1s - loss: 0.0257 - acc: 0.9921
46848/60000 [======================>.......] - ETA: 1s - loss: 0.0260 - acc: 0.9920
47360/60000 [======================>.......] - ETA: 1s - loss: 0.0259 - acc: 0.9920
47872/60000 [======================>.......] - ETA: 1s - loss: 0.0263 - acc: 0.9920
48512/60000 [=======================>......] - ETA: 1s - loss: 0.0261 - acc: 0.9920
49152/60000 [=======================>......] - ETA: 1s - loss: 0.0263 - acc: 0.9920
49664/60000 [=======================>......] - ETA: 0s - loss: 0.0263 - acc: 0.9920
50176/60000 [========================>.....] - ETA: 0s - loss: 0.0265 - acc: 0.9919
50816/60000 [========================>.....] - ETA: 0s - loss: 0.0262 - acc: 0.9920
51328/60000 [========================>.....] - ETA: 0s - loss: 0.0261 - acc: 0.9920
51840/60000 [========================>.....] - ETA: 0s - loss: 0.0263 - acc: 0.9920
52352/60000 [=========================>....] - ETA: 0s - loss: 0.0263 - acc: 0.9920
52992/60000 [=========================>....] - ETA: 0s - loss: 0.0261 - acc: 0.9920
53632/60000 [=========================>....] - ETA: 0s - loss: 0.0262 - acc: 0.9920
54272/60000 [==========================>...] - ETA: 0s - loss: 0.0261 - acc: 0.9920
54912/60000 [==========================>...] - ETA: 0s - loss: 0.0262 - acc: 0.9920
55552/60000 [==========================>...] - ETA: 0s - loss: 0.0264 - acc: 0.9919
56192/60000 [===========================>..] - ETA: 0s - loss: 0.0266 - acc: 0.9919
56832/60000 [===========================>..] - ETA: 0s - loss: 0.0268 - acc: 0.9919
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0268 - acc: 0.9919
58112/60000 [============================>.] - ETA: 0s - loss: 0.0267 - acc: 0.9920
58752/60000 [============================>.] - ETA: 0s - loss: 0.0267 - acc: 0.9920
59264/60000 [============================>.] - ETA: 0s - loss: 0.0266 - acc: 0.9920
59904/60000 [============================>.] - ETA: 0s - loss: 0.0264 - acc: 0.9921
60000/60000 [==============================] - 6s 99us/step - loss: 0.0263 - acc: 0.9921 - val_loss: 0.0862 - val_acc: 0.9847
Epoch 13/20

  128/60000 [..............................] - ETA: 6s - loss: 9.4695e-04 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0245 - acc: 0.9948    
 1408/60000 [..............................] - ETA: 5s - loss: 0.0155 - acc: 0.9957
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0156 - acc: 0.9956
 2560/60000 [>.............................] - ETA: 5s - loss: 0.0139 - acc: 0.9957
 3072/60000 [>.............................] - ETA: 5s - loss: 0.0144 - acc: 0.9961
 3712/60000 [>.............................] - ETA: 5s - loss: 0.0141 - acc: 0.9960
 4352/60000 [=>............................] - ETA: 5s - loss: 0.0211 - acc: 0.9945
 4992/60000 [=>............................] - ETA: 5s - loss: 0.0213 - acc: 0.9942
 5632/60000 [=>............................] - ETA: 5s - loss: 0.0209 - acc: 0.9943
 6272/60000 [==>...........................] - ETA: 5s - loss: 0.0207 - acc: 0.9944
 6912/60000 [==>...........................] - ETA: 4s - loss: 0.0195 - acc: 0.9945
 7552/60000 [==>...........................] - ETA: 4s - loss: 0.0192 - acc: 0.9947
 8064/60000 [===>..........................] - ETA: 4s - loss: 0.0187 - acc: 0.9949
 8704/60000 [===>..........................] - ETA: 4s - loss: 0.0198 - acc: 0.9948
 9216/60000 [===>..........................] - ETA: 4s - loss: 0.0199 - acc: 0.9947
 9728/60000 [===>..........................] - ETA: 4s - loss: 0.0199 - acc: 0.9948
10368/60000 [====>.........................] - ETA: 4s - loss: 0.0188 - acc: 0.9951
11008/60000 [====>.........................] - ETA: 4s - loss: 0.0188 - acc: 0.9951
11648/60000 [====>.........................] - ETA: 4s - loss: 0.0178 - acc: 0.9954
12288/60000 [=====>........................] - ETA: 4s - loss: 0.0173 - acc: 0.9954
12928/60000 [=====>........................] - ETA: 4s - loss: 0.0176 - acc: 0.9954
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0181 - acc: 0.9953
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0174 - acc: 0.9955
14848/60000 [======>.......................] - ETA: 4s - loss: 0.0173 - acc: 0.9954
15488/60000 [======>.......................] - ETA: 4s - loss: 0.0172 - acc: 0.9954
16128/60000 [=======>......................] - ETA: 4s - loss: 0.0178 - acc: 0.9950
16768/60000 [=======>......................] - ETA: 4s - loss: 0.0174 - acc: 0.9952
17408/60000 [=======>......................] - ETA: 4s - loss: 0.0176 - acc: 0.9951
18048/60000 [========>.....................] - ETA: 3s - loss: 0.0174 - acc: 0.9951
18688/60000 [========>.....................] - ETA: 3s - loss: 0.0172 - acc: 0.9951
19328/60000 [========>.....................] - ETA: 3s - loss: 0.0184 - acc: 0.9950
19968/60000 [========>.....................] - ETA: 3s - loss: 0.0184 - acc: 0.9950
20608/60000 [=========>....................] - ETA: 3s - loss: 0.0188 - acc: 0.9950
21120/60000 [=========>....................] - ETA: 3s - loss: 0.0190 - acc: 0.9949
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0186 - acc: 0.9950
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0185 - acc: 0.9950
22912/60000 [==========>...................] - ETA: 3s - loss: 0.0182 - acc: 0.9950
23552/60000 [==========>...................] - ETA: 3s - loss: 0.0190 - acc: 0.9948
24192/60000 [===========>..................] - ETA: 3s - loss: 0.0194 - acc: 0.9948
24832/60000 [===========>..................] - ETA: 3s - loss: 0.0193 - acc: 0.9947
25472/60000 [===========>..................] - ETA: 3s - loss: 0.0193 - acc: 0.9947
26112/60000 [============>.................] - ETA: 3s - loss: 0.0193 - acc: 0.9948
26752/60000 [============>.................] - ETA: 3s - loss: 0.0202 - acc: 0.9946
27392/60000 [============>.................] - ETA: 3s - loss: 0.0199 - acc: 0.9946
27904/60000 [============>.................] - ETA: 3s - loss: 0.0202 - acc: 0.9946
28544/60000 [=============>................] - ETA: 2s - loss: 0.0203 - acc: 0.9946
29184/60000 [=============>................] - ETA: 2s - loss: 0.0200 - acc: 0.9947
29824/60000 [=============>................] - ETA: 2s - loss: 0.0199 - acc: 0.9947
30464/60000 [==============>...............] - ETA: 2s - loss: 0.0204 - acc: 0.9946
31104/60000 [==============>...............] - ETA: 2s - loss: 0.0207 - acc: 0.9945
31744/60000 [==============>...............] - ETA: 2s - loss: 0.0207 - acc: 0.9946
32384/60000 [===============>..............] - ETA: 2s - loss: 0.0206 - acc: 0.9946
33024/60000 [===============>..............] - ETA: 2s - loss: 0.0217 - acc: 0.9944
33536/60000 [===============>..............] - ETA: 2s - loss: 0.0216 - acc: 0.9944
34176/60000 [================>.............] - ETA: 2s - loss: 0.0218 - acc: 0.9942
34816/60000 [================>.............] - ETA: 2s - loss: 0.0217 - acc: 0.9942
35456/60000 [================>.............] - ETA: 2s - loss: 0.0216 - acc: 0.9942
36096/60000 [=================>............] - ETA: 2s - loss: 0.0218 - acc: 0.9942
36736/60000 [=================>............] - ETA: 2s - loss: 0.0222 - acc: 0.9940
37376/60000 [=================>............] - ETA: 2s - loss: 0.0225 - acc: 0.9939
38016/60000 [==================>...........] - ETA: 2s - loss: 0.0224 - acc: 0.9939
38656/60000 [==================>...........] - ETA: 1s - loss: 0.0223 - acc: 0.9940
39296/60000 [==================>...........] - ETA: 1s - loss: 0.0223 - acc: 0.9940
39936/60000 [==================>...........] - ETA: 1s - loss: 0.0222 - acc: 0.9940
40576/60000 [===================>..........] - ETA: 1s - loss: 0.0222 - acc: 0.9940
41216/60000 [===================>..........] - ETA: 1s - loss: 0.0221 - acc: 0.9940
41856/60000 [===================>..........] - ETA: 1s - loss: 0.0223 - acc: 0.9940
42368/60000 [====================>.........] - ETA: 1s - loss: 0.0225 - acc: 0.9939
42880/60000 [====================>.........] - ETA: 1s - loss: 0.0226 - acc: 0.9939
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0224 - acc: 0.9940
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0225 - acc: 0.9940
44544/60000 [=====================>........] - ETA: 1s - loss: 0.0228 - acc: 0.9939
45184/60000 [=====================>........] - ETA: 1s - loss: 0.0228 - acc: 0.9939
45696/60000 [=====================>........] - ETA: 1s - loss: 0.0228 - acc: 0.9939
46208/60000 [======================>.......] - ETA: 1s - loss: 0.0226 - acc: 0.9940
46720/60000 [======================>.......] - ETA: 1s - loss: 0.0230 - acc: 0.9939
47232/60000 [======================>.......] - ETA: 1s - loss: 0.0232 - acc: 0.9938
47872/60000 [======================>.......] - ETA: 1s - loss: 0.0233 - acc: 0.9938
48512/60000 [=======================>......] - ETA: 1s - loss: 0.0232 - acc: 0.9938
49152/60000 [=======================>......] - ETA: 1s - loss: 0.0232 - acc: 0.9938
49664/60000 [=======================>......] - ETA: 0s - loss: 0.0232 - acc: 0.9938
50304/60000 [========================>.....] - ETA: 0s - loss: 0.0232 - acc: 0.9937
50944/60000 [========================>.....] - ETA: 0s - loss: 0.0230 - acc: 0.9938
51584/60000 [========================>.....] - ETA: 0s - loss: 0.0230 - acc: 0.9938
52096/60000 [=========================>....] - ETA: 0s - loss: 0.0229 - acc: 0.9938
52736/60000 [=========================>....] - ETA: 0s - loss: 0.0231 - acc: 0.9938
53248/60000 [=========================>....] - ETA: 0s - loss: 0.0232 - acc: 0.9938
53888/60000 [=========================>....] - ETA: 0s - loss: 0.0231 - acc: 0.9938
54528/60000 [==========================>...] - ETA: 0s - loss: 0.0229 - acc: 0.9938
55168/60000 [==========================>...] - ETA: 0s - loss: 0.0233 - acc: 0.9938
55808/60000 [==========================>...] - ETA: 0s - loss: 0.0233 - acc: 0.9937
56448/60000 [===========================>..] - ETA: 0s - loss: 0.0233 - acc: 0.9937
57088/60000 [===========================>..] - ETA: 0s - loss: 0.0233 - acc: 0.9937
57728/60000 [===========================>..] - ETA: 0s - loss: 0.0233 - acc: 0.9937
58240/60000 [============================>.] - ETA: 0s - loss: 0.0234 - acc: 0.9937
58880/60000 [============================>.] - ETA: 0s - loss: 0.0234 - acc: 0.9937
59392/60000 [============================>.] - ETA: 0s - loss: 0.0234 - acc: 0.9937
59904/60000 [============================>.] - ETA: 0s - loss: 0.0238 - acc: 0.9936
60000/60000 [==============================] - 6s 99us/step - loss: 0.0239 - acc: 0.9936 - val_loss: 0.0877 - val_acc: 0.9834
Epoch 14/20

  128/60000 [..............................] - ETA: 6s - loss: 4.2280e-04 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0120 - acc: 0.9974    
 1408/60000 [..............................] - ETA: 5s - loss: 0.0131 - acc: 0.9950
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0105 - acc: 0.9956
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0121 - acc: 0.9955
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0115 - acc: 0.9955
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0120 - acc: 0.9957
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0130 - acc: 0.9948
 5248/60000 [=>............................] - ETA: 5s - loss: 0.0134 - acc: 0.9950
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0162 - acc: 0.9951
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0152 - acc: 0.9954
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0164 - acc: 0.9951
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0164 - acc: 0.9949
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0176 - acc: 0.9944
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0170 - acc: 0.9946
 9472/60000 [===>..........................] - ETA: 4s - loss: 0.0179 - acc: 0.9946
10112/60000 [====>.........................] - ETA: 4s - loss: 0.0180 - acc: 0.9946
10624/60000 [====>.........................] - ETA: 4s - loss: 0.0197 - acc: 0.9944
11264/60000 [====>.........................] - ETA: 4s - loss: 0.0191 - acc: 0.9945
11904/60000 [====>.........................] - ETA: 4s - loss: 0.0196 - acc: 0.9946
12544/60000 [=====>........................] - ETA: 4s - loss: 0.0195 - acc: 0.9946
13184/60000 [=====>........................] - ETA: 4s - loss: 0.0207 - acc: 0.9944
13696/60000 [=====>........................] - ETA: 4s - loss: 0.0211 - acc: 0.9942
14336/60000 [======>.......................] - ETA: 4s - loss: 0.0209 - acc: 0.9943
14976/60000 [======>.......................] - ETA: 4s - loss: 0.0209 - acc: 0.9943
15488/60000 [======>.......................] - ETA: 4s - loss: 0.0208 - acc: 0.9943
16128/60000 [=======>......................] - ETA: 4s - loss: 0.0216 - acc: 0.9941
16640/60000 [=======>......................] - ETA: 4s - loss: 0.0213 - acc: 0.9942
17280/60000 [=======>......................] - ETA: 4s - loss: 0.0211 - acc: 0.9941
17920/60000 [=======>......................] - ETA: 3s - loss: 0.0210 - acc: 0.9940
18560/60000 [========>.....................] - ETA: 3s - loss: 0.0207 - acc: 0.9941
19072/60000 [========>.....................] - ETA: 3s - loss: 0.0212 - acc: 0.9939
19584/60000 [========>.....................] - ETA: 3s - loss: 0.0213 - acc: 0.9938
20096/60000 [=========>....................] - ETA: 3s - loss: 0.0218 - acc: 0.9936
20608/60000 [=========>....................] - ETA: 3s - loss: 0.0213 - acc: 0.9938
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0223 - acc: 0.9936
21504/60000 [=========>....................] - ETA: 3s - loss: 0.0219 - acc: 0.9937
22016/60000 [==========>...................] - ETA: 3s - loss: 0.0222 - acc: 0.9936
22528/60000 [==========>...................] - ETA: 3s - loss: 0.0219 - acc: 0.9937
23040/60000 [==========>...................] - ETA: 3s - loss: 0.0227 - acc: 0.9935
23680/60000 [==========>...................] - ETA: 3s - loss: 0.0227 - acc: 0.9936
24320/60000 [===========>..................] - ETA: 3s - loss: 0.0224 - acc: 0.9936
24960/60000 [===========>..................] - ETA: 3s - loss: 0.0225 - acc: 0.9936
25600/60000 [===========>..................] - ETA: 3s - loss: 0.0226 - acc: 0.9934
26240/60000 [============>.................] - ETA: 3s - loss: 0.0223 - acc: 0.9935
26752/60000 [============>.................] - ETA: 3s - loss: 0.0222 - acc: 0.9935
27264/60000 [============>.................] - ETA: 3s - loss: 0.0226 - acc: 0.9934
27904/60000 [============>.................] - ETA: 3s - loss: 0.0235 - acc: 0.9932
28544/60000 [=============>................] - ETA: 3s - loss: 0.0231 - acc: 0.9933
29184/60000 [=============>................] - ETA: 3s - loss: 0.0230 - acc: 0.9934
29824/60000 [=============>................] - ETA: 2s - loss: 0.0228 - acc: 0.9934
30464/60000 [==============>...............] - ETA: 2s - loss: 0.0235 - acc: 0.9932
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0235 - acc: 0.9933
31488/60000 [==============>...............] - ETA: 2s - loss: 0.0235 - acc: 0.9932
32128/60000 [===============>..............] - ETA: 2s - loss: 0.0233 - acc: 0.9932
32640/60000 [===============>..............] - ETA: 2s - loss: 0.0233 - acc: 0.9932
33152/60000 [===============>..............] - ETA: 2s - loss: 0.0231 - acc: 0.9932
33664/60000 [===============>..............] - ETA: 2s - loss: 0.0230 - acc: 0.9933
34176/60000 [================>.............] - ETA: 2s - loss: 0.0228 - acc: 0.9933
34816/60000 [================>.............] - ETA: 2s - loss: 0.0227 - acc: 0.9933
35456/60000 [================>.............] - ETA: 2s - loss: 0.0226 - acc: 0.9934
36096/60000 [=================>............] - ETA: 2s - loss: 0.0233 - acc: 0.9934
36736/60000 [=================>............] - ETA: 2s - loss: 0.0236 - acc: 0.9933
37376/60000 [=================>............] - ETA: 2s - loss: 0.0236 - acc: 0.9932
38016/60000 [==================>...........] - ETA: 2s - loss: 0.0232 - acc: 0.9933
38656/60000 [==================>...........] - ETA: 2s - loss: 0.0229 - acc: 0.9934
39296/60000 [==================>...........] - ETA: 2s - loss: 0.0231 - acc: 0.9934
39936/60000 [==================>...........] - ETA: 1s - loss: 0.0230 - acc: 0.9934
40576/60000 [===================>..........] - ETA: 1s - loss: 0.0233 - acc: 0.9934
41088/60000 [===================>..........] - ETA: 1s - loss: 0.0231 - acc: 0.9934
41728/60000 [===================>..........] - ETA: 1s - loss: 0.0232 - acc: 0.9934
42368/60000 [====================>.........] - ETA: 1s - loss: 0.0230 - acc: 0.9934
43008/60000 [====================>.........] - ETA: 1s - loss: 0.0230 - acc: 0.9934
43648/60000 [====================>.........] - ETA: 1s - loss: 0.0228 - acc: 0.9934
44288/60000 [=====================>........] - ETA: 1s - loss: 0.0228 - acc: 0.9935
44928/60000 [=====================>........] - ETA: 1s - loss: 0.0225 - acc: 0.9935
45440/60000 [=====================>........] - ETA: 1s - loss: 0.0224 - acc: 0.9935
45952/60000 [=====================>........] - ETA: 1s - loss: 0.0224 - acc: 0.9935
46464/60000 [======================>.......] - ETA: 1s - loss: 0.0223 - acc: 0.9935
46976/60000 [======================>.......] - ETA: 1s - loss: 0.0223 - acc: 0.9935
47616/60000 [======================>.......] - ETA: 1s - loss: 0.0220 - acc: 0.9936
48256/60000 [=======================>......] - ETA: 1s - loss: 0.0221 - acc: 0.9936
48768/60000 [=======================>......] - ETA: 1s - loss: 0.0222 - acc: 0.9935
49280/60000 [=======================>......] - ETA: 1s - loss: 0.0221 - acc: 0.9936
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0219 - acc: 0.9936
50432/60000 [========================>.....] - ETA: 0s - loss: 0.0221 - acc: 0.9936
50944/60000 [========================>.....] - ETA: 0s - loss: 0.0226 - acc: 0.9936
51584/60000 [========================>.....] - ETA: 0s - loss: 0.0226 - acc: 0.9936
52224/60000 [=========================>....] - ETA: 0s - loss: 0.0224 - acc: 0.9936
52864/60000 [=========================>....] - ETA: 0s - loss: 0.0228 - acc: 0.9935
53504/60000 [=========================>....] - ETA: 0s - loss: 0.0227 - acc: 0.9936
54144/60000 [==========================>...] - ETA: 0s - loss: 0.0228 - acc: 0.9935
54784/60000 [==========================>...] - ETA: 0s - loss: 0.0233 - acc: 0.9934
55424/60000 [==========================>...] - ETA: 0s - loss: 0.0234 - acc: 0.9933
56064/60000 [===========================>..] - ETA: 0s - loss: 0.0235 - acc: 0.9933
56704/60000 [===========================>..] - ETA: 0s - loss: 0.0236 - acc: 0.9933
57344/60000 [===========================>..] - ETA: 0s - loss: 0.0237 - acc: 0.9932
57856/60000 [===========================>..] - ETA: 0s - loss: 0.0236 - acc: 0.9933
58496/60000 [============================>.] - ETA: 0s - loss: 0.0236 - acc: 0.9933
59136/60000 [============================>.] - ETA: 0s - loss: 0.0235 - acc: 0.9933
59776/60000 [============================>.] - ETA: 0s - loss: 0.0234 - acc: 0.9933
60000/60000 [==============================] - 6s 101us/step - loss: 0.0233 - acc: 0.9933 - val_loss: 0.0975 - val_acc: 0.9826
Epoch 15/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0058 - acc: 0.9922
  768/60000 [..............................] - ETA: 5s - loss: 0.0241 - acc: 0.9948
 1408/60000 [..............................] - ETA: 5s - loss: 0.0165 - acc: 0.9957
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0202 - acc: 0.9946
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0177 - acc: 0.9948
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0180 - acc: 0.9949
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0205 - acc: 0.9947
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0190 - acc: 0.9950
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0180 - acc: 0.9954
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0183 - acc: 0.9952
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0177 - acc: 0.9954
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0177 - acc: 0.9954
 7680/60000 [==>...........................] - ETA: 4s - loss: 0.0191 - acc: 0.9953
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0183 - acc: 0.9954
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0180 - acc: 0.9954
 9600/60000 [===>..........................] - ETA: 4s - loss: 0.0176 - acc: 0.9954
10240/60000 [====>.........................] - ETA: 4s - loss: 0.0167 - acc: 0.9956
10880/60000 [====>.........................] - ETA: 4s - loss: 0.0168 - acc: 0.9954
11392/60000 [====>.........................] - ETA: 4s - loss: 0.0167 - acc: 0.9953
12032/60000 [=====>........................] - ETA: 4s - loss: 0.0167 - acc: 0.9954
12672/60000 [=====>........................] - ETA: 4s - loss: 0.0176 - acc: 0.9954
13184/60000 [=====>........................] - ETA: 4s - loss: 0.0178 - acc: 0.9953
13824/60000 [=====>........................] - ETA: 4s - loss: 0.0177 - acc: 0.9953
14464/60000 [======>.......................] - ETA: 4s - loss: 0.0186 - acc: 0.9952
15104/60000 [======>.......................] - ETA: 4s - loss: 0.0181 - acc: 0.9954
15744/60000 [======>.......................] - ETA: 4s - loss: 0.0180 - acc: 0.9952
16256/60000 [=======>......................] - ETA: 4s - loss: 0.0175 - acc: 0.9953
16896/60000 [=======>......................] - ETA: 4s - loss: 0.0172 - acc: 0.9954
17408/60000 [=======>......................] - ETA: 3s - loss: 0.0176 - acc: 0.9952
17920/60000 [=======>......................] - ETA: 3s - loss: 0.0184 - acc: 0.9951
18560/60000 [========>.....................] - ETA: 3s - loss: 0.0182 - acc: 0.9951
19200/60000 [========>.....................] - ETA: 3s - loss: 0.0180 - acc: 0.9952
19840/60000 [========>.....................] - ETA: 3s - loss: 0.0185 - acc: 0.9952
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0188 - acc: 0.9952
20864/60000 [=========>....................] - ETA: 3s - loss: 0.0186 - acc: 0.9952
21504/60000 [=========>....................] - ETA: 3s - loss: 0.0190 - acc: 0.9949
22144/60000 [==========>...................] - ETA: 3s - loss: 0.0188 - acc: 0.9949
22784/60000 [==========>...................] - ETA: 3s - loss: 0.0187 - acc: 0.9950
23424/60000 [==========>...................] - ETA: 3s - loss: 0.0197 - acc: 0.9947
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0199 - acc: 0.9946
24704/60000 [===========>..................] - ETA: 3s - loss: 0.0196 - acc: 0.9947
25344/60000 [===========>..................] - ETA: 3s - loss: 0.0203 - acc: 0.9945
25984/60000 [===========>..................] - ETA: 3s - loss: 0.0201 - acc: 0.9945
26624/60000 [============>.................] - ETA: 3s - loss: 0.0198 - acc: 0.9945
27264/60000 [============>.................] - ETA: 3s - loss: 0.0196 - acc: 0.9945
27904/60000 [============>.................] - ETA: 3s - loss: 0.0199 - acc: 0.9946
28544/60000 [=============>................] - ETA: 2s - loss: 0.0204 - acc: 0.9945
29184/60000 [=============>................] - ETA: 2s - loss: 0.0205 - acc: 0.9945
29824/60000 [=============>................] - ETA: 2s - loss: 0.0207 - acc: 0.9945
30464/60000 [==============>...............] - ETA: 2s - loss: 0.0205 - acc: 0.9946
31104/60000 [==============>...............] - ETA: 2s - loss: 0.0206 - acc: 0.9945
31616/60000 [==============>...............] - ETA: 2s - loss: 0.0204 - acc: 0.9946
32256/60000 [===============>..............] - ETA: 2s - loss: 0.0205 - acc: 0.9945
32896/60000 [===============>..............] - ETA: 2s - loss: 0.0206 - acc: 0.9944
33536/60000 [===============>..............] - ETA: 2s - loss: 0.0208 - acc: 0.9944
34048/60000 [================>.............] - ETA: 2s - loss: 0.0209 - acc: 0.9944
34688/60000 [================>.............] - ETA: 2s - loss: 0.0208 - acc: 0.9944
35328/60000 [================>.............] - ETA: 2s - loss: 0.0207 - acc: 0.9943
35968/60000 [================>.............] - ETA: 2s - loss: 0.0206 - acc: 0.9944
36608/60000 [=================>............] - ETA: 2s - loss: 0.0203 - acc: 0.9944
37248/60000 [=================>............] - ETA: 2s - loss: 0.0204 - acc: 0.9944
37760/60000 [=================>............] - ETA: 2s - loss: 0.0202 - acc: 0.9944
38400/60000 [==================>...........] - ETA: 2s - loss: 0.0200 - acc: 0.9945
39040/60000 [==================>...........] - ETA: 1s - loss: 0.0199 - acc: 0.9945
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0199 - acc: 0.9945
40064/60000 [===================>..........] - ETA: 1s - loss: 0.0204 - acc: 0.9944
40704/60000 [===================>..........] - ETA: 1s - loss: 0.0205 - acc: 0.9944
41344/60000 [===================>..........] - ETA: 1s - loss: 0.0202 - acc: 0.9944
41984/60000 [===================>..........] - ETA: 1s - loss: 0.0207 - acc: 0.9944
42496/60000 [====================>.........] - ETA: 1s - loss: 0.0205 - acc: 0.9944
43008/60000 [====================>.........] - ETA: 1s - loss: 0.0208 - acc: 0.9943
43520/60000 [====================>.........] - ETA: 1s - loss: 0.0209 - acc: 0.9944
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0208 - acc: 0.9944
44544/60000 [=====================>........] - ETA: 1s - loss: 0.0211 - acc: 0.9943
45056/60000 [=====================>........] - ETA: 1s - loss: 0.0214 - acc: 0.9943
45568/60000 [=====================>........] - ETA: 1s - loss: 0.0213 - acc: 0.9943
46080/60000 [======================>.......] - ETA: 1s - loss: 0.0211 - acc: 0.9944
46720/60000 [======================>.......] - ETA: 1s - loss: 0.0212 - acc: 0.9944
47360/60000 [======================>.......] - ETA: 1s - loss: 0.0215 - acc: 0.9943
47872/60000 [======================>.......] - ETA: 1s - loss: 0.0213 - acc: 0.9944
48384/60000 [=======================>......] - ETA: 1s - loss: 0.0216 - acc: 0.9943
48896/60000 [=======================>......] - ETA: 1s - loss: 0.0215 - acc: 0.9944
49408/60000 [=======================>......] - ETA: 1s - loss: 0.0215 - acc: 0.9943
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0216 - acc: 0.9943
50432/60000 [========================>.....] - ETA: 0s - loss: 0.0218 - acc: 0.9942
50944/60000 [========================>.....] - ETA: 0s - loss: 0.0216 - acc: 0.9942
51328/60000 [========================>.....] - ETA: 0s - loss: 0.0216 - acc: 0.9942
51840/60000 [========================>.....] - ETA: 0s - loss: 0.0215 - acc: 0.9943
52352/60000 [=========================>....] - ETA: 0s - loss: 0.0215 - acc: 0.9943
52864/60000 [=========================>....] - ETA: 0s - loss: 0.0216 - acc: 0.9942
53376/60000 [=========================>....] - ETA: 0s - loss: 0.0215 - acc: 0.9942
53888/60000 [=========================>....] - ETA: 0s - loss: 0.0214 - acc: 0.9942
54272/60000 [==========================>...] - ETA: 0s - loss: 0.0212 - acc: 0.9943
54784/60000 [==========================>...] - ETA: 0s - loss: 0.0217 - acc: 0.9942
55296/60000 [==========================>...] - ETA: 0s - loss: 0.0215 - acc: 0.9943
55808/60000 [==========================>...] - ETA: 0s - loss: 0.0215 - acc: 0.9943
56320/60000 [===========================>..] - ETA: 0s - loss: 0.0213 - acc: 0.9943
56960/60000 [===========================>..] - ETA: 0s - loss: 0.0214 - acc: 0.9943
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0214 - acc: 0.9943
58112/60000 [============================>.] - ETA: 0s - loss: 0.0212 - acc: 0.9943
58752/60000 [============================>.] - ETA: 0s - loss: 0.0214 - acc: 0.9943
59392/60000 [============================>.] - ETA: 0s - loss: 0.0213 - acc: 0.9943
60000/60000 [==============================] - 6s 101us/step - loss: 0.0211 - acc: 0.9943 - val_loss: 0.0996 - val_acc: 0.9847
Epoch 16/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0871 - acc: 0.9844
  768/60000 [..............................] - ETA: 5s - loss: 0.0218 - acc: 0.9935
 1408/60000 [..............................] - ETA: 5s - loss: 0.0151 - acc: 0.9957
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0148 - acc: 0.9966
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0129 - acc: 0.9967
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0162 - acc: 0.9955
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0201 - acc: 0.9952
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0177 - acc: 0.9959
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0158 - acc: 0.9962
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0172 - acc: 0.9959
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0172 - acc: 0.9957
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0189 - acc: 0.9954
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0183 - acc: 0.9955
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0176 - acc: 0.9954
 9088/60000 [===>..........................] - ETA: 4s - loss: 0.0178 - acc: 0.9953
 9600/60000 [===>..........................] - ETA: 4s - loss: 0.0176 - acc: 0.9952
10240/60000 [====>.........................] - ETA: 4s - loss: 0.0192 - acc: 0.9951
10752/60000 [====>.........................] - ETA: 4s - loss: 0.0188 - acc: 0.9953
11264/60000 [====>.........................] - ETA: 4s - loss: 0.0186 - acc: 0.9952
11904/60000 [====>.........................] - ETA: 4s - loss: 0.0191 - acc: 0.9950
12544/60000 [=====>........................] - ETA: 4s - loss: 0.0196 - acc: 0.9950
13184/60000 [=====>........................] - ETA: 4s - loss: 0.0195 - acc: 0.9949
13824/60000 [=====>........................] - ETA: 4s - loss: 0.0199 - acc: 0.9949
14464/60000 [======>.......................] - ETA: 4s - loss: 0.0194 - acc: 0.9950
15104/60000 [======>.......................] - ETA: 4s - loss: 0.0196 - acc: 0.9948
15744/60000 [======>.......................] - ETA: 4s - loss: 0.0207 - acc: 0.9947
16384/60000 [=======>......................] - ETA: 4s - loss: 0.0203 - acc: 0.9947
17024/60000 [=======>......................] - ETA: 3s - loss: 0.0204 - acc: 0.9946
17664/60000 [=======>......................] - ETA: 3s - loss: 0.0203 - acc: 0.9946
18304/60000 [========>.....................] - ETA: 3s - loss: 0.0199 - acc: 0.9946
18944/60000 [========>.....................] - ETA: 3s - loss: 0.0205 - acc: 0.9945
19584/60000 [========>.....................] - ETA: 3s - loss: 0.0205 - acc: 0.9944
20096/60000 [=========>....................] - ETA: 3s - loss: 0.0200 - acc: 0.9945
20736/60000 [=========>....................] - ETA: 3s - loss: 0.0213 - acc: 0.9944
21376/60000 [=========>....................] - ETA: 3s - loss: 0.0208 - acc: 0.9945
22016/60000 [==========>...................] - ETA: 3s - loss: 0.0208 - acc: 0.9945
22656/60000 [==========>...................] - ETA: 3s - loss: 0.0207 - acc: 0.9945
23296/60000 [==========>...................] - ETA: 3s - loss: 0.0210 - acc: 0.9942
23936/60000 [==========>...................] - ETA: 3s - loss: 0.0207 - acc: 0.9942
24576/60000 [===========>..................] - ETA: 3s - loss: 0.0203 - acc: 0.9944
25216/60000 [===========>..................] - ETA: 3s - loss: 0.0212 - acc: 0.9943
25856/60000 [===========>..................] - ETA: 3s - loss: 0.0210 - acc: 0.9943
26496/60000 [============>.................] - ETA: 3s - loss: 0.0209 - acc: 0.9943
27136/60000 [============>.................] - ETA: 3s - loss: 0.0209 - acc: 0.9943
27776/60000 [============>.................] - ETA: 2s - loss: 0.0214 - acc: 0.9942
28416/60000 [=============>................] - ETA: 2s - loss: 0.0217 - acc: 0.9942
29056/60000 [=============>................] - ETA: 2s - loss: 0.0217 - acc: 0.9942
29696/60000 [=============>................] - ETA: 2s - loss: 0.0214 - acc: 0.9942
30336/60000 [==============>...............] - ETA: 2s - loss: 0.0213 - acc: 0.9942
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0209 - acc: 0.9943
31488/60000 [==============>...............] - ETA: 2s - loss: 0.0210 - acc: 0.9943
32000/60000 [===============>..............] - ETA: 2s - loss: 0.0214 - acc: 0.9942
32640/60000 [===============>..............] - ETA: 2s - loss: 0.0215 - acc: 0.9942
33152/60000 [===============>..............] - ETA: 2s - loss: 0.0215 - acc: 0.9942
33792/60000 [===============>..............] - ETA: 2s - loss: 0.0215 - acc: 0.9943
34432/60000 [================>.............] - ETA: 2s - loss: 0.0219 - acc: 0.9942
35072/60000 [================>.............] - ETA: 2s - loss: 0.0216 - acc: 0.9942
35712/60000 [================>.............] - ETA: 2s - loss: 0.0214 - acc: 0.9943
36352/60000 [=================>............] - ETA: 2s - loss: 0.0213 - acc: 0.9943
36992/60000 [=================>............] - ETA: 2s - loss: 0.0213 - acc: 0.9943
37632/60000 [=================>............] - ETA: 2s - loss: 0.0214 - acc: 0.9943
38272/60000 [==================>...........] - ETA: 2s - loss: 0.0213 - acc: 0.9943
38912/60000 [==================>...........] - ETA: 1s - loss: 0.0212 - acc: 0.9943
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0209 - acc: 0.9944
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0207 - acc: 0.9944
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0206 - acc: 0.9944
41472/60000 [===================>..........] - ETA: 1s - loss: 0.0213 - acc: 0.9943
42112/60000 [====================>.........] - ETA: 1s - loss: 0.0211 - acc: 0.9943
42752/60000 [====================>.........] - ETA: 1s - loss: 0.0211 - acc: 0.9944
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0211 - acc: 0.9944
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0215 - acc: 0.9944
44672/60000 [=====================>........] - ETA: 1s - loss: 0.0216 - acc: 0.9943
45184/60000 [=====================>........] - ETA: 1s - loss: 0.0216 - acc: 0.9943
45824/60000 [=====================>........] - ETA: 1s - loss: 0.0217 - acc: 0.9943
46464/60000 [======================>.......] - ETA: 1s - loss: 0.0219 - acc: 0.9943
47104/60000 [======================>.......] - ETA: 1s - loss: 0.0221 - acc: 0.9943
47744/60000 [======================>.......] - ETA: 1s - loss: 0.0219 - acc: 0.9943
48384/60000 [=======================>......] - ETA: 1s - loss: 0.0218 - acc: 0.9943
49024/60000 [=======================>......] - ETA: 1s - loss: 0.0217 - acc: 0.9943
49664/60000 [=======================>......] - ETA: 0s - loss: 0.0217 - acc: 0.9943
50304/60000 [========================>.....] - ETA: 0s - loss: 0.0217 - acc: 0.9943
50944/60000 [========================>.....] - ETA: 0s - loss: 0.0218 - acc: 0.9942
51584/60000 [========================>.....] - ETA: 0s - loss: 0.0217 - acc: 0.9942
52224/60000 [=========================>....] - ETA: 0s - loss: 0.0218 - acc: 0.9942
52864/60000 [=========================>....] - ETA: 0s - loss: 0.0217 - acc: 0.9942
53504/60000 [=========================>....] - ETA: 0s - loss: 0.0216 - acc: 0.9942
54144/60000 [==========================>...] - ETA: 0s - loss: 0.0215 - acc: 0.9942
54784/60000 [==========================>...] - ETA: 0s - loss: 0.0213 - acc: 0.9942
55424/60000 [==========================>...] - ETA: 0s - loss: 0.0216 - acc: 0.9942
56064/60000 [===========================>..] - ETA: 0s - loss: 0.0214 - acc: 0.9942
56704/60000 [===========================>..] - ETA: 0s - loss: 0.0214 - acc: 0.9942
57216/60000 [===========================>..] - ETA: 0s - loss: 0.0216 - acc: 0.9942
57728/60000 [===========================>..] - ETA: 0s - loss: 0.0218 - acc: 0.9941
58368/60000 [============================>.] - ETA: 0s - loss: 0.0218 - acc: 0.9942
59008/60000 [============================>.] - ETA: 0s - loss: 0.0217 - acc: 0.9942
59648/60000 [============================>.] - ETA: 0s - loss: 0.0218 - acc: 0.9942
60000/60000 [==============================] - 6s 96us/step - loss: 0.0219 - acc: 0.9941 - val_loss: 0.1152 - val_acc: 0.9805
Epoch 17/20

  128/60000 [..............................] - ETA: 5s - loss: 0.0012 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0090 - acc: 0.9961
 1408/60000 [..............................] - ETA: 5s - loss: 0.0124 - acc: 0.9950
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0117 - acc: 0.9956
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0109 - acc: 0.9963
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0096 - acc: 0.9967
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0116 - acc: 0.9960
 4608/60000 [=>............................] - ETA: 4s - loss: 0.0123 - acc: 0.9954
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0123 - acc: 0.9954
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0136 - acc: 0.9949
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0140 - acc: 0.9951
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0155 - acc: 0.9951
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0180 - acc: 0.9947
 8448/60000 [===>..........................] - ETA: 4s - loss: 0.0202 - acc: 0.9946
 9088/60000 [===>..........................] - ETA: 4s - loss: 0.0198 - acc: 0.9946
 9728/60000 [===>..........................] - ETA: 4s - loss: 0.0192 - acc: 0.9948
10368/60000 [====>.........................] - ETA: 4s - loss: 0.0201 - acc: 0.9944
11008/60000 [====>.........................] - ETA: 4s - loss: 0.0214 - acc: 0.9941
11648/60000 [====>.........................] - ETA: 4s - loss: 0.0222 - acc: 0.9939
12288/60000 [=====>........................] - ETA: 4s - loss: 0.0224 - acc: 0.9939
12928/60000 [=====>........................] - ETA: 4s - loss: 0.0217 - acc: 0.9940
13568/60000 [=====>........................] - ETA: 4s - loss: 0.0228 - acc: 0.9940
14208/60000 [======>.......................] - ETA: 4s - loss: 0.0226 - acc: 0.9940
14848/60000 [======>.......................] - ETA: 4s - loss: 0.0222 - acc: 0.9941
15488/60000 [======>.......................] - ETA: 4s - loss: 0.0219 - acc: 0.9941
16128/60000 [=======>......................] - ETA: 3s - loss: 0.0227 - acc: 0.9940
16768/60000 [=======>......................] - ETA: 3s - loss: 0.0234 - acc: 0.9940
17408/60000 [=======>......................] - ETA: 3s - loss: 0.0242 - acc: 0.9940
18048/60000 [========>.....................] - ETA: 3s - loss: 0.0239 - acc: 0.9940
18688/60000 [========>.....................] - ETA: 3s - loss: 0.0243 - acc: 0.9939
19328/60000 [========>.....................] - ETA: 3s - loss: 0.0252 - acc: 0.9938
19968/60000 [========>.....................] - ETA: 3s - loss: 0.0256 - acc: 0.9937
20608/60000 [=========>....................] - ETA: 3s - loss: 0.0249 - acc: 0.9939
21120/60000 [=========>....................] - ETA: 3s - loss: 0.0248 - acc: 0.9938
21760/60000 [=========>....................] - ETA: 3s - loss: 0.0246 - acc: 0.9939
22400/60000 [==========>...................] - ETA: 3s - loss: 0.0248 - acc: 0.9939
23040/60000 [==========>...................] - ETA: 3s - loss: 0.0243 - acc: 0.9940
23680/60000 [==========>...................] - ETA: 3s - loss: 0.0237 - acc: 0.9941
24320/60000 [===========>..................] - ETA: 3s - loss: 0.0234 - acc: 0.9942
24960/60000 [===========>..................] - ETA: 3s - loss: 0.0235 - acc: 0.9942
25600/60000 [===========>..................] - ETA: 3s - loss: 0.0230 - acc: 0.9943
26240/60000 [============>.................] - ETA: 3s - loss: 0.0231 - acc: 0.9943
26880/60000 [============>.................] - ETA: 3s - loss: 0.0230 - acc: 0.9942
27520/60000 [============>.................] - ETA: 2s - loss: 0.0233 - acc: 0.9941
28160/60000 [=============>................] - ETA: 2s - loss: 0.0232 - acc: 0.9941
28672/60000 [=============>................] - ETA: 2s - loss: 0.0233 - acc: 0.9941
29184/60000 [=============>................] - ETA: 2s - loss: 0.0232 - acc: 0.9940
29696/60000 [=============>................] - ETA: 2s - loss: 0.0229 - acc: 0.9940
30208/60000 [==============>...............] - ETA: 2s - loss: 0.0233 - acc: 0.9940
30720/60000 [==============>...............] - ETA: 2s - loss: 0.0229 - acc: 0.9941
31232/60000 [==============>...............] - ETA: 2s - loss: 0.0230 - acc: 0.9941
31744/60000 [==============>...............] - ETA: 2s - loss: 0.0229 - acc: 0.9942
32256/60000 [===============>..............] - ETA: 2s - loss: 0.0226 - acc: 0.9943
32768/60000 [===============>..............] - ETA: 2s - loss: 0.0224 - acc: 0.9943
33152/60000 [===============>..............] - ETA: 2s - loss: 0.0228 - acc: 0.9943
33664/60000 [===============>..............] - ETA: 2s - loss: 0.0229 - acc: 0.9942
34176/60000 [================>.............] - ETA: 2s - loss: 0.0226 - acc: 0.9942
34688/60000 [================>.............] - ETA: 2s - loss: 0.0226 - acc: 0.9942
35200/60000 [================>.............] - ETA: 2s - loss: 0.0227 - acc: 0.9942
35840/60000 [================>.............] - ETA: 2s - loss: 0.0229 - acc: 0.9941
36480/60000 [=================>............] - ETA: 2s - loss: 0.0234 - acc: 0.9941
37120/60000 [=================>............] - ETA: 2s - loss: 0.0231 - acc: 0.9942
37760/60000 [=================>............] - ETA: 2s - loss: 0.0228 - acc: 0.9943
38400/60000 [==================>...........] - ETA: 2s - loss: 0.0228 - acc: 0.9943
39040/60000 [==================>...........] - ETA: 1s - loss: 0.0227 - acc: 0.9943
39680/60000 [==================>...........] - ETA: 1s - loss: 0.0228 - acc: 0.9943
40320/60000 [===================>..........] - ETA: 1s - loss: 0.0231 - acc: 0.9941
40960/60000 [===================>..........] - ETA: 1s - loss: 0.0236 - acc: 0.9940
41600/60000 [===================>..........] - ETA: 1s - loss: 0.0235 - acc: 0.9940
42240/60000 [====================>.........] - ETA: 1s - loss: 0.0231 - acc: 0.9941
42880/60000 [====================>.........] - ETA: 1s - loss: 0.0232 - acc: 0.9941
43520/60000 [====================>.........] - ETA: 1s - loss: 0.0230 - acc: 0.9941
44160/60000 [=====================>........] - ETA: 1s - loss: 0.0229 - acc: 0.9941
44800/60000 [=====================>........] - ETA: 1s - loss: 0.0229 - acc: 0.9941
45312/60000 [=====================>........] - ETA: 1s - loss: 0.0227 - acc: 0.9942
45824/60000 [=====================>........] - ETA: 1s - loss: 0.0227 - acc: 0.9942
46336/60000 [======================>.......] - ETA: 1s - loss: 0.0226 - acc: 0.9942
46976/60000 [======================>.......] - ETA: 1s - loss: 0.0229 - acc: 0.9942
47616/60000 [======================>.......] - ETA: 1s - loss: 0.0229 - acc: 0.9942
48128/60000 [=======================>......] - ETA: 1s - loss: 0.0227 - acc: 0.9943
48768/60000 [=======================>......] - ETA: 1s - loss: 0.0225 - acc: 0.9943
49280/60000 [=======================>......] - ETA: 1s - loss: 0.0224 - acc: 0.9943
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0223 - acc: 0.9943
50560/60000 [========================>.....] - ETA: 0s - loss: 0.0222 - acc: 0.9943
51200/60000 [========================>.....] - ETA: 0s - loss: 0.0221 - acc: 0.9943
51840/60000 [========================>.....] - ETA: 0s - loss: 0.0220 - acc: 0.9943
52480/60000 [=========================>....] - ETA: 0s - loss: 0.0219 - acc: 0.9944
53120/60000 [=========================>....] - ETA: 0s - loss: 0.0217 - acc: 0.9944
53760/60000 [=========================>....] - ETA: 0s - loss: 0.0217 - acc: 0.9944
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0217 - acc: 0.9944
54912/60000 [==========================>...] - ETA: 0s - loss: 0.0216 - acc: 0.9944
55552/60000 [==========================>...] - ETA: 0s - loss: 0.0216 - acc: 0.9944
56192/60000 [===========================>..] - ETA: 0s - loss: 0.0214 - acc: 0.9944
56832/60000 [===========================>..] - ETA: 0s - loss: 0.0214 - acc: 0.9944
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0217 - acc: 0.9943
58112/60000 [============================>.] - ETA: 0s - loss: 0.0216 - acc: 0.9944
58624/60000 [============================>.] - ETA: 0s - loss: 0.0216 - acc: 0.9944
59264/60000 [============================>.] - ETA: 0s - loss: 0.0219 - acc: 0.9943
59904/60000 [============================>.] - ETA: 0s - loss: 0.0217 - acc: 0.9944
60000/60000 [==============================] - 6s 98us/step - loss: 0.0216 - acc: 0.9944 - val_loss: 0.1007 - val_acc: 0.9834
Epoch 18/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0840 - acc: 0.9922
  768/60000 [..............................] - ETA: 5s - loss: 0.0269 - acc: 0.9961
 1408/60000 [..............................] - ETA: 5s - loss: 0.0169 - acc: 0.9964
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0150 - acc: 0.9961
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0128 - acc: 0.9963
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0158 - acc: 0.9946
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0168 - acc: 0.9945
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0180 - acc: 0.9939
 5248/60000 [=>............................] - ETA: 5s - loss: 0.0168 - acc: 0.9945
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0185 - acc: 0.9942
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0178 - acc: 0.9945
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0173 - acc: 0.9946
 7808/60000 [==>...........................] - ETA: 4s - loss: 0.0183 - acc: 0.9941
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0198 - acc: 0.9940
 8832/60000 [===>..........................] - ETA: 4s - loss: 0.0198 - acc: 0.9941
 9472/60000 [===>..........................] - ETA: 4s - loss: 0.0195 - acc: 0.9942
 9984/60000 [===>..........................] - ETA: 4s - loss: 0.0190 - acc: 0.9944
10624/60000 [====>.........................] - ETA: 4s - loss: 0.0190 - acc: 0.9943
11264/60000 [====>.........................] - ETA: 4s - loss: 0.0186 - acc: 0.9942
11904/60000 [====>.........................] - ETA: 4s - loss: 0.0179 - acc: 0.9944
12544/60000 [=====>........................] - ETA: 4s - loss: 0.0175 - acc: 0.9943
13184/60000 [=====>........................] - ETA: 4s - loss: 0.0168 - acc: 0.9945
13824/60000 [=====>........................] - ETA: 4s - loss: 0.0160 - acc: 0.9948
14464/60000 [======>.......................] - ETA: 4s - loss: 0.0164 - acc: 0.9949
15104/60000 [======>.......................] - ETA: 4s - loss: 0.0161 - acc: 0.9950
15744/60000 [======>.......................] - ETA: 4s - loss: 0.0158 - acc: 0.9951
16384/60000 [=======>......................] - ETA: 4s - loss: 0.0162 - acc: 0.9951
17024/60000 [=======>......................] - ETA: 3s - loss: 0.0161 - acc: 0.9951
17664/60000 [=======>......................] - ETA: 3s - loss: 0.0167 - acc: 0.9948
18304/60000 [========>.....................] - ETA: 3s - loss: 0.0167 - acc: 0.9949
18944/60000 [========>.....................] - ETA: 3s - loss: 0.0166 - acc: 0.9949
19456/60000 [========>.....................] - ETA: 3s - loss: 0.0167 - acc: 0.9950
20096/60000 [=========>....................] - ETA: 3s - loss: 0.0165 - acc: 0.9950
20736/60000 [=========>....................] - ETA: 3s - loss: 0.0162 - acc: 0.9951
21248/60000 [=========>....................] - ETA: 3s - loss: 0.0159 - acc: 0.9952
21760/60000 [=========>....................] - ETA: 3s - loss: 0.0157 - acc: 0.9952
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0159 - acc: 0.9950
22784/60000 [==========>...................] - ETA: 3s - loss: 0.0158 - acc: 0.9950
23424/60000 [==========>...................] - ETA: 3s - loss: 0.0167 - acc: 0.9950
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0167 - acc: 0.9950
24704/60000 [===========>..................] - ETA: 3s - loss: 0.0164 - acc: 0.9951
25344/60000 [===========>..................] - ETA: 3s - loss: 0.0163 - acc: 0.9951
25984/60000 [===========>..................] - ETA: 3s - loss: 0.0163 - acc: 0.9952
26624/60000 [============>.................] - ETA: 3s - loss: 0.0169 - acc: 0.9950
27264/60000 [============>.................] - ETA: 3s - loss: 0.0170 - acc: 0.9950
27904/60000 [============>.................] - ETA: 3s - loss: 0.0168 - acc: 0.9950
28544/60000 [=============>................] - ETA: 2s - loss: 0.0169 - acc: 0.9950
29184/60000 [=============>................] - ETA: 2s - loss: 0.0171 - acc: 0.9949
29824/60000 [=============>................] - ETA: 2s - loss: 0.0170 - acc: 0.9949
30464/60000 [==============>...............] - ETA: 2s - loss: 0.0173 - acc: 0.9948
31104/60000 [==============>...............] - ETA: 2s - loss: 0.0178 - acc: 0.9948
31744/60000 [==============>...............] - ETA: 2s - loss: 0.0178 - acc: 0.9948
32384/60000 [===============>..............] - ETA: 2s - loss: 0.0176 - acc: 0.9948
33024/60000 [===============>..............] - ETA: 2s - loss: 0.0180 - acc: 0.9947
33664/60000 [===============>..............] - ETA: 2s - loss: 0.0185 - acc: 0.9947
34176/60000 [================>.............] - ETA: 2s - loss: 0.0184 - acc: 0.9946
34688/60000 [================>.............] - ETA: 2s - loss: 0.0182 - acc: 0.9947
35200/60000 [================>.............] - ETA: 2s - loss: 0.0183 - acc: 0.9946
35712/60000 [================>.............] - ETA: 2s - loss: 0.0181 - acc: 0.9946
36352/60000 [=================>............] - ETA: 2s - loss: 0.0180 - acc: 0.9946
36992/60000 [=================>............] - ETA: 2s - loss: 0.0177 - acc: 0.9947
37632/60000 [=================>............] - ETA: 2s - loss: 0.0177 - acc: 0.9947
38272/60000 [==================>...........] - ETA: 2s - loss: 0.0179 - acc: 0.9947
38912/60000 [==================>...........] - ETA: 1s - loss: 0.0178 - acc: 0.9947
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0179 - acc: 0.9947
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0179 - acc: 0.9947
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0177 - acc: 0.9947
41472/60000 [===================>..........] - ETA: 1s - loss: 0.0177 - acc: 0.9947
42112/60000 [====================>.........] - ETA: 1s - loss: 0.0176 - acc: 0.9948
42752/60000 [====================>.........] - ETA: 1s - loss: 0.0175 - acc: 0.9948
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0177 - acc: 0.9947
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0175 - acc: 0.9948
44672/60000 [=====================>........] - ETA: 1s - loss: 0.0178 - acc: 0.9947
45312/60000 [=====================>........] - ETA: 1s - loss: 0.0176 - acc: 0.9948
45952/60000 [=====================>........] - ETA: 1s - loss: 0.0178 - acc: 0.9947
46464/60000 [======================>.......] - ETA: 1s - loss: 0.0178 - acc: 0.9948
46976/60000 [======================>.......] - ETA: 1s - loss: 0.0177 - acc: 0.9948
47488/60000 [======================>.......] - ETA: 1s - loss: 0.0177 - acc: 0.9947
48000/60000 [=======================>......] - ETA: 1s - loss: 0.0179 - acc: 0.9947
48640/60000 [=======================>......] - ETA: 1s - loss: 0.0180 - acc: 0.9947
49280/60000 [=======================>......] - ETA: 1s - loss: 0.0181 - acc: 0.9947
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0181 - acc: 0.9947
50560/60000 [========================>.....] - ETA: 0s - loss: 0.0180 - acc: 0.9947
51200/60000 [========================>.....] - ETA: 0s - loss: 0.0179 - acc: 0.9947
51840/60000 [========================>.....] - ETA: 0s - loss: 0.0178 - acc: 0.9947
52480/60000 [=========================>....] - ETA: 0s - loss: 0.0178 - acc: 0.9947
53120/60000 [=========================>....] - ETA: 0s - loss: 0.0179 - acc: 0.9947
53760/60000 [=========================>....] - ETA: 0s - loss: 0.0179 - acc: 0.9948
54400/60000 [==========================>...] - ETA: 0s - loss: 0.0179 - acc: 0.9948
55040/60000 [==========================>...] - ETA: 0s - loss: 0.0178 - acc: 0.9948
55552/60000 [==========================>...] - ETA: 0s - loss: 0.0179 - acc: 0.9948
56192/60000 [===========================>..] - ETA: 0s - loss: 0.0181 - acc: 0.9948
56832/60000 [===========================>..] - ETA: 0s - loss: 0.0181 - acc: 0.9948
57472/60000 [===========================>..] - ETA: 0s - loss: 0.0181 - acc: 0.9948
58112/60000 [============================>.] - ETA: 0s - loss: 0.0182 - acc: 0.9948
58752/60000 [============================>.] - ETA: 0s - loss: 0.0184 - acc: 0.9947
59392/60000 [============================>.] - ETA: 0s - loss: 0.0187 - acc: 0.9947
60000/60000 [==============================] - 6s 97us/step - loss: 0.0189 - acc: 0.9947 - val_loss: 0.0991 - val_acc: 0.9833
Epoch 19/20

  128/60000 [..............................] - ETA: 6s - loss: 0.0074 - acc: 0.9922
  768/60000 [..............................] - ETA: 5s - loss: 0.0034 - acc: 0.9987
 1408/60000 [..............................] - ETA: 5s - loss: 0.0154 - acc: 0.9957
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0131 - acc: 0.9961
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0113 - acc: 0.9967
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0175 - acc: 0.9952
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0156 - acc: 0.9957
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0149 - acc: 0.9961
 5248/60000 [=>............................] - ETA: 5s - loss: 0.0146 - acc: 0.9960
 5888/60000 [=>............................] - ETA: 5s - loss: 0.0134 - acc: 0.9963
 6528/60000 [==>...........................] - ETA: 4s - loss: 0.0126 - acc: 0.9965
 7168/60000 [==>...........................] - ETA: 4s - loss: 0.0130 - acc: 0.9961
 7680/60000 [==>...........................] - ETA: 4s - loss: 0.0148 - acc: 0.9958
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0158 - acc: 0.9957
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0172 - acc: 0.9953
 9472/60000 [===>..........................] - ETA: 4s - loss: 0.0172 - acc: 0.9951
10112/60000 [====>.........................] - ETA: 4s - loss: 0.0162 - acc: 0.9955
10624/60000 [====>.........................] - ETA: 4s - loss: 0.0155 - acc: 0.9957
11264/60000 [====>.........................] - ETA: 4s - loss: 0.0160 - acc: 0.9956
11904/60000 [====>.........................] - ETA: 4s - loss: 0.0157 - acc: 0.9955
12544/60000 [=====>........................] - ETA: 4s - loss: 0.0153 - acc: 0.9956
13184/60000 [=====>........................] - ETA: 4s - loss: 0.0148 - acc: 0.9958
13824/60000 [=====>........................] - ETA: 4s - loss: 0.0142 - acc: 0.9959
14464/60000 [======>.......................] - ETA: 4s - loss: 0.0147 - acc: 0.9959
14976/60000 [======>.......................] - ETA: 4s - loss: 0.0150 - acc: 0.9959
15616/60000 [======>.......................] - ETA: 4s - loss: 0.0145 - acc: 0.9960
16256/60000 [=======>......................] - ETA: 4s - loss: 0.0147 - acc: 0.9960
16896/60000 [=======>......................] - ETA: 4s - loss: 0.0144 - acc: 0.9960
17536/60000 [=======>......................] - ETA: 3s - loss: 0.0139 - acc: 0.9962
18176/60000 [========>.....................] - ETA: 3s - loss: 0.0138 - acc: 0.9961
18816/60000 [========>.....................] - ETA: 3s - loss: 0.0140 - acc: 0.9961
19456/60000 [========>.....................] - ETA: 3s - loss: 0.0144 - acc: 0.9960
20096/60000 [=========>....................] - ETA: 3s - loss: 0.0144 - acc: 0.9961
20736/60000 [=========>....................] - ETA: 3s - loss: 0.0147 - acc: 0.9959
21376/60000 [=========>....................] - ETA: 3s - loss: 0.0147 - acc: 0.9960
22016/60000 [==========>...................] - ETA: 3s - loss: 0.0143 - acc: 0.9961
22528/60000 [==========>...................] - ETA: 3s - loss: 0.0151 - acc: 0.9960
23040/60000 [==========>...................] - ETA: 3s - loss: 0.0149 - acc: 0.9961
23552/60000 [==========>...................] - ETA: 3s - loss: 0.0146 - acc: 0.9961
24192/60000 [===========>..................] - ETA: 3s - loss: 0.0143 - acc: 0.9962
24832/60000 [===========>..................] - ETA: 3s - loss: 0.0143 - acc: 0.9962
25472/60000 [===========>..................] - ETA: 3s - loss: 0.0146 - acc: 0.9961
26112/60000 [============>.................] - ETA: 3s - loss: 0.0149 - acc: 0.9961
26752/60000 [============>.................] - ETA: 3s - loss: 0.0149 - acc: 0.9961
27392/60000 [============>.................] - ETA: 3s - loss: 0.0151 - acc: 0.9960
28032/60000 [=============>................] - ETA: 2s - loss: 0.0153 - acc: 0.9960
28672/60000 [=============>................] - ETA: 2s - loss: 0.0151 - acc: 0.9960
29312/60000 [=============>................] - ETA: 2s - loss: 0.0151 - acc: 0.9960
29952/60000 [=============>................] - ETA: 2s - loss: 0.0150 - acc: 0.9960
30592/60000 [==============>...............] - ETA: 2s - loss: 0.0153 - acc: 0.9960
31232/60000 [==============>...............] - ETA: 2s - loss: 0.0152 - acc: 0.9960
31872/60000 [==============>...............] - ETA: 2s - loss: 0.0160 - acc: 0.9958
32512/60000 [===============>..............] - ETA: 2s - loss: 0.0162 - acc: 0.9958
33152/60000 [===============>..............] - ETA: 2s - loss: 0.0166 - acc: 0.9957
33792/60000 [===============>..............] - ETA: 2s - loss: 0.0169 - acc: 0.9957
34432/60000 [================>.............] - ETA: 2s - loss: 0.0169 - acc: 0.9957
35072/60000 [================>.............] - ETA: 2s - loss: 0.0170 - acc: 0.9956
35712/60000 [================>.............] - ETA: 2s - loss: 0.0169 - acc: 0.9956
36352/60000 [=================>............] - ETA: 2s - loss: 0.0166 - acc: 0.9957
36992/60000 [=================>............] - ETA: 2s - loss: 0.0171 - acc: 0.9956
37632/60000 [=================>............] - ETA: 2s - loss: 0.0170 - acc: 0.9956
38272/60000 [==================>...........] - ETA: 2s - loss: 0.0172 - acc: 0.9956
38912/60000 [==================>...........] - ETA: 1s - loss: 0.0173 - acc: 0.9955
39552/60000 [==================>...........] - ETA: 1s - loss: 0.0178 - acc: 0.9954
40192/60000 [===================>..........] - ETA: 1s - loss: 0.0179 - acc: 0.9954
40832/60000 [===================>..........] - ETA: 1s - loss: 0.0179 - acc: 0.9954
41472/60000 [===================>..........] - ETA: 1s - loss: 0.0177 - acc: 0.9954
42112/60000 [====================>.........] - ETA: 1s - loss: 0.0178 - acc: 0.9954
42752/60000 [====================>.........] - ETA: 1s - loss: 0.0177 - acc: 0.9954
43392/60000 [====================>.........] - ETA: 1s - loss: 0.0175 - acc: 0.9954
44032/60000 [=====================>........] - ETA: 1s - loss: 0.0175 - acc: 0.9954
44672/60000 [=====================>........] - ETA: 1s - loss: 0.0175 - acc: 0.9954
45312/60000 [=====================>........] - ETA: 1s - loss: 0.0179 - acc: 0.9954
45952/60000 [=====================>........] - ETA: 1s - loss: 0.0177 - acc: 0.9955
46592/60000 [======================>.......] - ETA: 1s - loss: 0.0179 - acc: 0.9954
47232/60000 [======================>.......] - ETA: 1s - loss: 0.0177 - acc: 0.9955
47744/60000 [======================>.......] - ETA: 1s - loss: 0.0179 - acc: 0.9955
48256/60000 [=======================>......] - ETA: 1s - loss: 0.0178 - acc: 0.9955
48896/60000 [=======================>......] - ETA: 1s - loss: 0.0176 - acc: 0.9955
49536/60000 [=======================>......] - ETA: 0s - loss: 0.0178 - acc: 0.9954
50176/60000 [========================>.....] - ETA: 0s - loss: 0.0181 - acc: 0.9954
50816/60000 [========================>.....] - ETA: 0s - loss: 0.0180 - acc: 0.9954
51456/60000 [========================>.....] - ETA: 0s - loss: 0.0180 - acc: 0.9954
52096/60000 [=========================>....] - ETA: 0s - loss: 0.0180 - acc: 0.9953
52736/60000 [=========================>....] - ETA: 0s - loss: 0.0180 - acc: 0.9954
53376/60000 [=========================>....] - ETA: 0s - loss: 0.0178 - acc: 0.9954
54016/60000 [==========================>...] - ETA: 0s - loss: 0.0182 - acc: 0.9953
54656/60000 [==========================>...] - ETA: 0s - loss: 0.0182 - acc: 0.9953
55296/60000 [==========================>...] - ETA: 0s - loss: 0.0181 - acc: 0.9953
55936/60000 [==========================>...] - ETA: 0s - loss: 0.0184 - acc: 0.9953
56576/60000 [===========================>..] - ETA: 0s - loss: 0.0188 - acc: 0.9953
57216/60000 [===========================>..] - ETA: 0s - loss: 0.0191 - acc: 0.9952
57856/60000 [===========================>..] - ETA: 0s - loss: 0.0189 - acc: 0.9953
58496/60000 [============================>.] - ETA: 0s - loss: 0.0187 - acc: 0.9954
59136/60000 [============================>.] - ETA: 0s - loss: 0.0187 - acc: 0.9953
59776/60000 [============================>.] - ETA: 0s - loss: 0.0187 - acc: 0.9953
60000/60000 [==============================] - 6s 96us/step - loss: 0.0188 - acc: 0.9953 - val_loss: 0.1222 - val_acc: 0.9819
Epoch 20/20

  128/60000 [..............................] - ETA: 6s - loss: 2.4242e-04 - acc: 1.0000
  768/60000 [..............................] - ETA: 5s - loss: 0.0230 - acc: 0.9948    
 1408/60000 [..............................] - ETA: 5s - loss: 0.0143 - acc: 0.9964
 2048/60000 [>.............................] - ETA: 5s - loss: 0.0181 - acc: 0.9956
 2688/60000 [>.............................] - ETA: 5s - loss: 0.0204 - acc: 0.9944
 3328/60000 [>.............................] - ETA: 5s - loss: 0.0180 - acc: 0.9946
 3968/60000 [>.............................] - ETA: 5s - loss: 0.0154 - acc: 0.9955
 4608/60000 [=>............................] - ETA: 5s - loss: 0.0188 - acc: 0.9954
 5248/60000 [=>............................] - ETA: 4s - loss: 0.0184 - acc: 0.9950
 5888/60000 [=>............................] - ETA: 4s - loss: 0.0191 - acc: 0.9946
 6400/60000 [==>...........................] - ETA: 4s - loss: 0.0188 - acc: 0.9948
 7040/60000 [==>...........................] - ETA: 4s - loss: 0.0203 - acc: 0.9950
 7680/60000 [==>...........................] - ETA: 4s - loss: 0.0201 - acc: 0.9949
 8320/60000 [===>..........................] - ETA: 4s - loss: 0.0202 - acc: 0.9950
 8960/60000 [===>..........................] - ETA: 4s - loss: 0.0201 - acc: 0.9948
 9600/60000 [===>..........................] - ETA: 4s - loss: 0.0204 - acc: 0.9949
10240/60000 [====>.........................] - ETA: 4s - loss: 0.0200 - acc: 0.9948
10880/60000 [====>.........................] - ETA: 4s - loss: 0.0195 - acc: 0.9949
11392/60000 [====>.........................] - ETA: 4s - loss: 0.0203 - acc: 0.9948
12032/60000 [=====>........................] - ETA: 4s - loss: 0.0197 - acc: 0.9950
12672/60000 [=====>........................] - ETA: 4s - loss: 0.0191 - acc: 0.9952
13312/60000 [=====>........................] - ETA: 4s - loss: 0.0186 - acc: 0.9953
13952/60000 [=====>........................] - ETA: 4s - loss: 0.0184 - acc: 0.9953
14592/60000 [======>.......................] - ETA: 4s - loss: 0.0186 - acc: 0.9953
15232/60000 [======>.......................] - ETA: 4s - loss: 0.0184 - acc: 0.9953
15872/60000 [======>.......................] - ETA: 4s - loss: 0.0181 - acc: 0.9954
16512/60000 [=======>......................] - ETA: 4s - loss: 0.0179 - acc: 0.9955
17152/60000 [=======>......................] - ETA: 3s - loss: 0.0179 - acc: 0.9955
17792/60000 [=======>......................] - ETA: 3s - loss: 0.0178 - acc: 0.9956
18432/60000 [========>.....................] - ETA: 3s - loss: 0.0180 - acc: 0.9956
19072/60000 [========>.....................] - ETA: 3s - loss: 0.0177 - acc: 0.9956
19712/60000 [========>.....................] - ETA: 3s - loss: 0.0185 - acc: 0.9955
20352/60000 [=========>....................] - ETA: 3s - loss: 0.0183 - acc: 0.9955
20992/60000 [=========>....................] - ETA: 3s - loss: 0.0181 - acc: 0.9955
21632/60000 [=========>....................] - ETA: 3s - loss: 0.0182 - acc: 0.9956
22272/60000 [==========>...................] - ETA: 3s - loss: 0.0183 - acc: 0.9956
22912/60000 [==========>...................] - ETA: 3s - loss: 0.0186 - acc: 0.9955
23552/60000 [==========>...................] - ETA: 3s - loss: 0.0184 - acc: 0.9955
24064/60000 [===========>..................] - ETA: 3s - loss: 0.0187 - acc: 0.9954
24704/60000 [===========>..................] - ETA: 3s - loss: 0.0182 - acc: 0.9955
25216/60000 [===========>..................] - ETA: 3s - loss: 0.0180 - acc: 0.9956
25856/60000 [===========>..................] - ETA: 3s - loss: 0.0182 - acc: 0.9956
26496/60000 [============>.................] - ETA: 3s - loss: 0.0181 - acc: 0.9955
27136/60000 [============>.................] - ETA: 3s - loss: 0.0178 - acc: 0.9955
27776/60000 [============>.................] - ETA: 2s - loss: 0.0180 - acc: 0.9955
28416/60000 [=============>................] - ETA: 2s - loss: 0.0183 - acc: 0.9955
29056/60000 [=============>................] - ETA: 2s - loss: 0.0181 - acc: 0.9955
29696/60000 [=============>................] - ETA: 2s - loss: 0.0181 - acc: 0.9955
30336/60000 [==============>...............] - ETA: 2s - loss: 0.0183 - acc: 0.9954
30976/60000 [==============>...............] - ETA: 2s - loss: 0.0182 - acc: 0.9954
31616/60000 [==============>...............] - ETA: 2s - loss: 0.0185 - acc: 0.9954
32256/60000 [===============>..............] - ETA: 2s - loss: 0.0187 - acc: 0.9955
32896/60000 [===============>..............] - ETA: 2s - loss: 0.0186 - acc: 0.9954
33536/60000 [===============>..............] - ETA: 2s - loss: 0.0195 - acc: 0.9951
34176/60000 [================>.............] - ETA: 2s - loss: 0.0194 - acc: 0.9951
34816/60000 [================>.............] - ETA: 2s - loss: 0.0195 - acc: 0.9951
35456/60000 [================>.............] - ETA: 2s - loss: 0.0198 - acc: 0.9950
36096/60000 [=================>............] - ETA: 2s - loss: 0.0201 - acc: 0.9950
36608/60000 [=================>............] - ETA: 2s - loss: 0.0200 - acc: 0.9950
37248/60000 [=================>............] - ETA: 2s - loss: 0.0201 - acc: 0.9950
37888/60000 [=================>............] - ETA: 2s - loss: 0.0199 - acc: 0.9950
38528/60000 [==================>...........] - ETA: 1s - loss: 0.0199 - acc: 0.9950
39168/60000 [==================>...........] - ETA: 1s - loss: 0.0197 - acc: 0.9950
39808/60000 [==================>...........] - ETA: 1s - loss: 0.0196 - acc: 0.9950
40448/60000 [===================>..........] - ETA: 1s - loss: 0.0196 - acc: 0.9950
41088/60000 [===================>..........] - ETA: 1s - loss: 0.0202 - acc: 0.9950
41728/60000 [===================>..........] - ETA: 1s - loss: 0.0203 - acc: 0.9950
42368/60000 [====================>.........] - ETA: 1s - loss: 0.0201 - acc: 0.9950
43008/60000 [====================>.........] - ETA: 1s - loss: 0.0198 - acc: 0.9951
43648/60000 [====================>.........] - ETA: 1s - loss: 0.0200 - acc: 0.9950
44288/60000 [=====================>........] - ETA: 1s - loss: 0.0200 - acc: 0.9950
44928/60000 [=====================>........] - ETA: 1s - loss: 0.0200 - acc: 0.9950
45568/60000 [=====================>........] - ETA: 1s - loss: 0.0200 - acc: 0.9950
46208/60000 [======================>.......] - ETA: 1s - loss: 0.0201 - acc: 0.9950
46848/60000 [======================>.......] - ETA: 1s - loss: 0.0201 - acc: 0.9949
47488/60000 [======================>.......] - ETA: 1s - loss: 0.0199 - acc: 0.9950
48128/60000 [=======================>......] - ETA: 1s - loss: 0.0200 - acc: 0.9950
48768/60000 [=======================>......] - ETA: 1s - loss: 0.0198 - acc: 0.9950
49408/60000 [=======================>......] - ETA: 0s - loss: 0.0196 - acc: 0.9951
49920/60000 [=======================>......] - ETA: 0s - loss: 0.0198 - acc: 0.9951
50432/60000 [========================>.....] - ETA: 0s - loss: 0.0198 - acc: 0.9951
50944/60000 [========================>.....] - ETA: 0s - loss: 0.0196 - acc: 0.9951
51584/60000 [========================>.....] - ETA: 0s - loss: 0.0194 - acc: 0.9952
52224/60000 [=========================>....] - ETA: 0s - loss: 0.0193 - acc: 0.9952
52864/60000 [=========================>....] - ETA: 0s - loss: 0.0191 - acc: 0.9953
53504/60000 [=========================>....] - ETA: 0s - loss: 0.0192 - acc: 0.9953
54144/60000 [==========================>...] - ETA: 0s - loss: 0.0191 - acc: 0.9953
54784/60000 [==========================>...] - ETA: 0s - loss: 0.0193 - acc: 0.9953
55424/60000 [==========================>...] - ETA: 0s - loss: 0.0196 - acc: 0.9952
56064/60000 [===========================>..] - ETA: 0s - loss: 0.0194 - acc: 0.9953
56704/60000 [===========================>..] - ETA: 0s - loss: 0.0194 - acc: 0.9952
57344/60000 [===========================>..] - ETA: 0s - loss: 0.0192 - acc: 0.9953
57984/60000 [===========================>..] - ETA: 0s - loss: 0.0195 - acc: 0.9952
58624/60000 [============================>.] - ETA: 0s - loss: 0.0194 - acc: 0.9952
59264/60000 [============================>.] - ETA: 0s - loss: 0.0192 - acc: 0.9952
59904/60000 [============================>.] - ETA: 0s - loss: 0.0192 - acc: 0.9952
60000/60000 [==============================] - 6s 97us/step - loss: 0.0193 - acc: 0.9952 - val_loss: 0.1123 - val_acc: 0.9835
Test loss: 0.11232871169722279
Test accuracy: 0.9835
```

### Pytorch解决手写数字识别

```assembly
import os
import torch
import torchvision
from torch.autograd import Variable
import torch.utils.data.dataloader as Data
import torch.nn.functional as F
from torchvision import datasets, transforms

train_data = torchvision.datasets.MNIST(
    'dataset/mnist-pytorch', train=True,
    # 归一化
    transform=transforms.Compose([transforms.ToTensor(), transforms.Normalize([0.5], [0.5])]),
    download=True
)
test_data = torchvision.datasets.MNIST(
    'dataset/mnist-pytorch', train=False,
    # 归一化
    transform=transforms.Compose([transforms.ToTensor(), transforms.Normalize([0.5], [0.5])])
)
print("train_data:", train_data.train_data.size())
print("train_labels:", train_data.train_labels.size())
print("test_data:", test_data.test_data.size())

# 批大小
batch_size = 128
# 训练的批次数
epochs = 20


# 定义网络继承torch.nn.Module类
class Net(torch.nn.Module):
    def __init__(self):
        super(Net, self).__init__()

        self.dense = torch.nn.Sequential(
            # 全连接层
            torch.nn.Linear(784, 512),
            # 替换了Dropout层，在抵御过拟合的同时加快了收敛速度
            torch.nn.BatchNorm1d(512),
            torch.nn.ReLU(),
            torch.nn.Linear(512, 10),
            torch.nn.ReLU()
        )

    # 完成前向传播的定义
    def forward(self, x):
        # 把输出转换成大小为784的一维向量
        x = x.view(-1, 784)
        x = self.dense(x)
        return torch.nn.functional.log_softmax(x, dim=1)


def main():
    # 自适应使用GPU还是CPU
    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

    model = Net().to(device)
    print(model)
    '''
    Net(
      (dense): Sequential(
        (0): Linear(in_features=784, out_features=512, bias=True)
        (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU()
        (3): Linear(in_features=512, out_features=10, bias=True)
        (4): ReLU()
      )
    )
    '''

    # 定义损失函数和优化器
    # 优化的对象是全部网络参数
    optimizer = torch.optim.Adam(model.parameters())
    loss_func = torch.nn.CrossEntropyLoss()

    # 训练与验证
    train_loader = Data.DataLoader(dataset=train_data, batch_size=batch_size, shuffle=True)
    test_loader = Data.DataLoader(dataset=test_data, batch_size=batch_size)

    for epoch in range(epochs):
        sum_loss = 0.0
        for i, data in enumerate(train_loader):
            inputs, labels = data
            inputs, labels = inputs.to(device), labels.to(device)

            # 梯度清零
            optimizer.zero_grad()

            # forward + backward
            # 前向传播
            outputs = model(inputs)

            loss = loss_func(outputs, labels)
            # 显式调用反向传递
            loss.backward()
            # 使用优化器来调整参数
            optimizer.step()

            # 每训练100个batch打印一次平均loss
            sum_loss += loss.item()
            if (i + 1) % 100 == 0:
                print('epoch=%d, batch=%d loss: %.04f'
                      % (epoch + 1, i + 1, sum_loss / 100))
                sum_loss = 0.0

        # 每跑完一次epoch测试一下准确率 进入测试模式 禁止梯度传递
        with torch.no_grad():
            correct = 0
            total = 0
            for data in test_loader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = model(images)
                # 取得分最高的那个类
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum()
            print('epoch=%d accuracy=%.02f%%' % (epoch + 1, (100 * correct / total)))

    torch.save(model.state_dict(), "models/pytorch-mnist.pth")

main()
```

训练过程

```assembly
epoch=1, batch=100 loss: 0.6115
epoch=1, batch=200 loss: 0.4263
epoch=1, batch=300 loss: 0.3763
epoch=1, batch=400 loss: 0.3488
epoch=1 accuracy=88.21%
epoch=2, batch=100 loss: 0.3045
epoch=2, batch=200 loss: 0.3060
epoch=2, batch=300 loss: 0.3056
epoch=2, batch=400 loss: 0.3037
epoch=2 accuracy=88.91%
epoch=3, batch=100 loss: 0.2759
epoch=3, batch=200 loss: 0.2577
epoch=3, batch=300 loss: 0.2757
epoch=3, batch=400 loss: 0.2637
epoch=3 accuracy=89.13%
epoch=4, batch=100 loss: 0.2451
epoch=4, batch=200 loss: 0.2535
epoch=4, batch=300 loss: 0.2412
epoch=4, batch=400 loss: 0.2564
epoch=4 accuracy=89.19%
epoch=5, batch=100 loss: 0.2317
epoch=5, batch=200 loss: 0.2390
epoch=5, batch=300 loss: 0.2459
epoch=5, batch=400 loss: 0.2497
epoch=5 accuracy=89.17%
epoch=6, batch=100 loss: 0.2363
epoch=6, batch=200 loss: 0.2326
epoch=6, batch=300 loss: 0.2332
epoch=6, batch=400 loss: 0.2312
epoch=6 accuracy=89.20%
epoch=7, batch=100 loss: 0.2316
epoch=7, batch=200 loss: 0.2324
epoch=7, batch=300 loss: 0.2302
epoch=7, batch=400 loss: 0.2219
epoch=7 accuracy=89.02%
epoch=8, batch=100 loss: 0.2339
epoch=8, batch=200 loss: 0.2271
epoch=8, batch=300 loss: 0.2264
epoch=8, batch=400 loss: 0.2226
epoch=8 accuracy=89.27%
epoch=9, batch=100 loss: 0.2112
epoch=9, batch=200 loss: 0.2264
epoch=9, batch=300 loss: 0.2219
epoch=9, batch=400 loss: 0.2252
epoch=9 accuracy=89.15%
epoch=10, batch=100 loss: 0.2215
epoch=10, batch=200 loss: 0.2218
epoch=10, batch=300 loss: 0.2147
epoch=10, batch=400 loss: 0.2228
epoch=10 accuracy=89.16%
epoch=11, batch=100 loss: 0.2333
epoch=11, batch=200 loss: 0.2165
epoch=11, batch=300 loss: 0.2109
epoch=11, batch=400 loss: 0.2155
epoch=11 accuracy=89.29%
epoch=12, batch=100 loss: 0.2095
epoch=12, batch=200 loss: 0.2170
epoch=12, batch=300 loss: 0.2170
epoch=12, batch=400 loss: 0.2323
epoch=12 accuracy=89.38%
epoch=13, batch=100 loss: 0.2164
epoch=13, batch=200 loss: 0.2194
epoch=13, batch=300 loss: 0.2176
epoch=13, batch=400 loss: 0.2209
epoch=13 accuracy=89.30%
epoch=14, batch=100 loss: 0.2102
epoch=14, batch=200 loss: 0.2137
epoch=14, batch=300 loss: 0.2192
epoch=14, batch=400 loss: 0.2261
epoch=14 accuracy=89.16%
epoch=15, batch=100 loss: 0.2206
epoch=15, batch=200 loss: 0.2157
epoch=15, batch=300 loss: 0.2211
epoch=15, batch=400 loss: 0.2139
epoch=15 accuracy=89.45%
epoch=16, batch=100 loss: 0.2114
epoch=16, batch=200 loss: 0.2168
epoch=16, batch=300 loss: 0.2177
epoch=16, batch=400 loss: 0.2141
epoch=16 accuracy=89.42%
epoch=17, batch=100 loss: 0.2078
epoch=17, batch=200 loss: 0.2107
epoch=17, batch=300 loss: 0.2181
epoch=17, batch=400 loss: 0.2138
epoch=17 accuracy=89.21%
epoch=18, batch=100 loss: 0.2174
epoch=18, batch=200 loss: 0.2097
epoch=18, batch=300 loss: 0.2160
epoch=18, batch=400 loss: 0.2234
epoch=18 accuracy=89.28%
epoch=19, batch=100 loss: 0.2199
epoch=19, batch=200 loss: 0.2125
epoch=19, batch=300 loss: 0.2127
epoch=19, batch=400 loss: 0.2254
epoch=19 accuracy=89.31%
epoch=20, batch=100 loss: 0.2163
epoch=20, batch=200 loss: 0.2118
epoch=20, batch=300 loss: 0.2126
epoch=20, batch=400 loss: 0.2137
epoch=20 accuracy=89.08%
```

### MXNet解决手写数字识别

```assembly
import mxnet as mx
import logging
logging.getLogger().setLevel(logging.DEBUG)

mnist = mx.test_utils.get_mnist()
ctx = mx.gpu() if mx.test_utils.list_gpus() else mx.cpu()

batch_size = 128
train_iter = mx.io.NDArrayIter(mnist['train_data'], mnist['train_label'], batch_size, shuffle=True)
val_iter = mx.io.NDArrayIter(mnist['test_data'], mnist['test_label'], batch_size)

data = mx.sym.var('data')
data = mx.sym.flatten(data=data)

# 省略了Dropout层
fc1 = mx.sym.FullyConnected(data=data, num_hidden=512)
act1 = mx.sym.Activation(data=fc1, act_type="relu")
fc2 = mx.sym.FullyConnected(data=act1, num_hidden=512)
act2 = mx.sym.Activation(data=fc2, act_type="relu")
fc3 = mx.sym.FullyConnected(data=act2, num_hidden=10)
mlp = mx.sym.SoftmaxOutput(data=fc3, name='softmax')

mlp_model = mx.mod.Module(symbol=mlp, context=ctx)

# 可视化网络结构
import matplotlib.pyplot as plt
mx.viz.plot_network(mlp).view()

mlp_model.fit(train_iter,
              eval_data=val_iter,
              optimizer='sgd',  # 优化器
              optimizer_params={'learning_rate': 0.1},
              eval_metric='acc',
              batch_end_callback=mx.callback.Speedometer(batch_size, 100),
              num_epoch=20)

# 测试集上验证准确度
test_iter = mx.io.NDArrayIter(mnist['test_data'], mnist['test_label'], batch_size)
acc = mx.metric.Accuracy()
mlp_model.score(test_iter, acc)
print(acc)

# MXNet保存的模型文件后缀为parms
mlp_model.save_checkpoint('models/mxnet.parms', 20)
```

### 使用预训练模型

```assembly
from IPython.display import Image,display
path = "./picture/pig.jpg"
display(Image(filename=path))


# 使用keras进行图片分类
# 使用基于Imagenet数据集训练的ResNet50模型
from keras.applications.resnet50 import ResNet50
from keras.preprocessing import image
from keras.applications.resnet50 import preprocess_input, decode_predictions
import numpy as np

model = ResNet50(weights='imagenet')

img_path = path
img = image.load_img(img_path, target_size=(224, 224))
x = image.img_to_array(img)
x = np.expand_dims(x, axis=0)
# Keras处理图片时，标准化处理被preprocess_input封装
x = preprocess_input(x)

preds = model.predict(x)

print('Predicted:', decode_predictions(preds, top=3)[0])


# 使用PyTorch进行图片分类
import numpy as np
import torchvision.models as models
from torch.autograd import Variable
import torch.cuda
from PIL import Image

# PyTorch加载预训练模型后默认是训练模式，
# 所以在进行图片预测时需要手工调用eval方法进入预测模式，关闭反向传递
resnet50 = models.resnet50(pretrained=True).eval()

img = Image.open(path)
img = img.resize((224,224))
img = np.array(img).copy().astype(np.float32)

# 手工进行标准化
mean = [0.485, 0.456, 0.406]
std = [0.229, 0.224, 0.225]
img /= 255.0
img = (img - mean) / std
img = img.transpose(2, 0, 1)

img = np.expand_dims(img, axis=0)
img = Variable(torch.from_numpy(img).float())

label = np.argmax(resnet50(img).data.cpu().numpy())
print("label={}".format(label))
print('Predicted:', decode_predictions(resnet50(img).data.cpu().numpy(), top=3)[0])


# 使用MXNet进行图片分类
import mxnet as mx
import numpy as np

resnet = mx.gluon.model_zoo.vision.resnet50_v2(pretrained=True)

img = Image.open(path)
img = img.resize((224,224))
img = np.array(img).copy().astype(np.float32)

mean = [0.485, 0.456, 0.406]
std = [0.229, 0.224, 0.225]
img /= 255.0
img = (img - mean) / std
img = img.transpose(2, 0, 1)

img = np.expand_dims(img, axis=0)
array = mx.nd.array(img)

outputs = resnet(array).asnumpy()
label = np.argmax(outputs)
print(label)


# 使用TensorFlow进行图片分类
import tensorflow as tf
import numpy as np
import re


class NodeLookup(object):
  """Converts integer node ID's to human readable labels."""

  def __init__(self,
               label_lookup_path=None,
               uid_lookup_path=None):
    self.node_lookup = self.load(label_lookup_path, uid_lookup_path)

  def load(self, label_lookup_path, uid_lookup_path):
    """Loads a human readable English name for each softmax node.
    Args:
      label_lookup_path: string UID to integer node ID.
      uid_lookup_path: string UID to human-readable string.
    Returns:
      dict from integer node ID to human-readable string.
    """
    if not tf.gfile.Exists(uid_lookup_path):
      tf.logging.fatal('File does not exist %s', uid_lookup_path)
    if not tf.gfile.Exists(label_lookup_path):
      tf.logging.fatal('File does not exist %s', label_lookup_path)

    # Loads mapping from string UID to human-readable string
    proto_as_ascii_lines = tf.gfile.GFile(uid_lookup_path).readlines()
    uid_to_human = {}
    p = re.compile(r'[n\d]*[ \S,]*')
    for line in proto_as_ascii_lines:
      parsed_items = p.findall(line)
      uid = parsed_items[0]
      human_string = parsed_items[2]
      uid_to_human[uid] = human_string

    # Loads mapping from string UID to integer node ID.
    node_id_to_uid = {}
    proto_as_ascii = tf.gfile.GFile(label_lookup_path).readlines()
    for line in proto_as_ascii:
      if line.startswith('  target_class:'):
        target_class = int(line.split(': ')[1])
      if line.startswith('  target_class_string:'):
        target_class_string = line.split(': ')[1]
        node_id_to_uid[target_class] = target_class_string[1:-2]

    # Loads the final mapping of integer node ID to human-readable string
    node_id_to_name = {}
    for key, val in node_id_to_uid.items():
      if val not in uid_to_human:
        tf.logging.fatal('Failed to locate: %s', val)
      name = uid_to_human[val]
      node_id_to_name[key] = name

    return node_id_to_name

  def id_to_string(self, node_id):
    if node_id not in self.node_lookup:
      return ''
    return self.node_lookup[node_id]


path = "./picture/pig.jpg"
image_data = tf.gfile.FastGFile(path, "rb").read()

# 加载pb文件，在会话中还原完整的计算图以及网络中的各层参数
session = tf.Session()

def create_graph(dirname):
    with tf.gfile.FastGFile(dirname, 'rb') as f:
        graph_def = session.graph_def
        graph_def.ParseFromString(f.read())
        _ = tf.import_graph_def(graph_def, name='')

create_graph("models/inception-2015-12-05/classify_image_graph_def.pb")
session.run(tf.global_variables_initializer())

# 把pb文件的结构打印出来，有利于识别整个计算图的输入/输出
tensorlist=[n.name for n in session.graph_def.node]
print(tensorlist)

# 获取输入节点和输出节点，运行计算图获得结果
logits = session.graph.get_tensor_by_name('softmax/logits:0')
x = session.graph.get_tensor_by_name('DecodeJpeg/contents:0')

predictions = session.run(logits, feed_dict={x:image_data})
predictions = np.squeeze(predictions)

node_lookup = NodeLookup(label_lookup_path="models/inception-2015-12-05/imagenet_2012_challenge_label_map_proto.pbtxt",
                        uid_lookup_path="models/inception-2015-12-05/imagenet_synset_to_human_label_map.txt")

top_k = predictions.argsort()[-3:][::-1]
for node_id in top_k:
      human_string = node_lookup.id_to_string(node_id)
      score = predictions[node_id]
      print('%s (score = %.5f)' % (human_string, score))


# import tensorflow as tf
# import numpy as np
# import sys
# from PIL import Image
#
# sys.path.append("models/models/research/")
# sys.path.append("models/models/research/slim/")
# from nets import resnet_v2
# import slim.preprocessing.inception_preprocessing
# from datasets import imagenet
# from tensorflow.contrib import slim
#
# with tf.Graph().as_default():
#     path = "./picture/pig.jpg"
#     image = tf.image.decode_jpeg(tf.gfile.FastGFile(path, 'rb').read(), channels=3)
#     image_size = resnet_v2_50.default_image_size
#     processed_image = inception_preprocessing.preprocess_image(image, image_size, image_size, is_training=False)
#     processed_images = tf.expand_dims(processed_image, 0)
#
#     with slim.arg_scope(resnet_v2.resnet_arg_scope()):
#         logits, _ = resnet_v2.resnet_v2_50(processed_images, num_classes=1001, is_training=False)
#     probabilities = tf.nn.softmax(logits)
#
#     saver = tf.train.Saver()
#
#     with tf.Session() as sess:
#         saver.restore(sess, 'models/resnet_v2_50_2017_04_14/resnet_v2_50.ckpt')
#         np_image, probabilities = sess.run([image, probabilities])
#         probabilities = probabilities[0, 0:]
#         sorted_inds = [i[0] for i in sorted(enumerate(-probabilities), key=lambda x: x[1])]
#
#     names = imagenet.create_readable_names_for_imagenet_labels()
#     for i in range(5):
#         index = sorted_inds[i]
#         print('Probability %0.2f%% => [%s]' % (probabilities[index] * 100, names[index]))
```

